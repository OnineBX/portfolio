define("pan-timeline:widget/api/classify/getlist.js",function(t,e,i){"use strict";function a(t,e){return r.get(t,void 0!==e&&{params:e})}var n=t("base:thirdParty/vue/vue.js"),r=t("base:thirdParty/vue/axios.js"),s={getByCluster:["/api/image/getbycluster","/aipic/image/search"]},u={getPicForJudge:function(){return a("/api/categorylist",{category:3,order:"time",desc:1,page:1,num:1})},getClassifyResult:function(t){return a("/aipic/image/gettags",t)},getCluster:function(t){t=n.util.extend({dlink:1,thumb:1,type:1,condition:{},limit:10},t);var e=t.isNewApi?1:0,i=s.getByCluster&&s.getByCluster[e];return a(i,t)},getLocation:function(t){return t=n.util.extend({limit:10},t),a("/aipic/image/search",t)},applyClassify:function(t){return a("/aipic/task/uidpush",t)},getLabelUsers:function(t){return t=n.util.extend({key:"tag",limit:100,mark:1},t),a("/aipic/image/getLabelUsers",t)},getNewFaceSwitch:function(t){return a("/api/account/getswitch",t)},setNewFaceSwitch:function(t){return a("/api/account/setswitch",t)}};i.exports=u});
;define("pan-timeline:widget/api/classifyModify/getlist.js",function(e,a,t){"use strict";var i=(e("base:thirdParty/vue/vue.js"),e("base:thirdParty/vue/axios.js")),s=(e("base:thirdParty/vue/qs.js"),{getLabelTag:function(e){return i.get("/aipic/image/labeltag",{params:e})},getModifyResult:function(e){return i.get("/aipic/image/optag",{params:e})},getImgClassifyTags:function(e){return i.get("/aipic/image/filemetas",{params:e})}});t.exports=s});
;define("pan-timeline:widget/api/guide/getlist.js",function(e,r,t){"use strict";var s=(e("base:thirdParty/vue/vue.js"),e("base:thirdParty/vue/axios.js")),a=e("base:thirdParty/vue/qs.js"),i={transformRequest:function(e){return a.stringify(e,{arrayFormat:"brackets"})}},n={getTaskQuery:function(e){return s.get("/aipic/face/merge_person_taskquery",{params:e})},postMergePerson:function(e){return s.post("/aipic/face/merge_person_async",e,i)}};t.exports=n});
;define("pan-timeline:widget/api/humanRemark/getlist.js",function(e,t,r){"use strict";function n(e,t){return i.get(e,void 0!==t&&{params:t})}function a(e,t){return i.post(e,t,o)}var i=e("base:thirdParty/vue/axios.js"),u=e("base:thirdParty/vue/qs.js"),o={transformRequest:function(e){return u.stringify(e,{arrayFormat:"brackets"})}},c={getHumanName:function(e){return n("/aipic/image/gettags",e)},getFriendName:function(e){return n("/mbox/relation/getfollowlist",e)},getRemarkSculpture:function(e){return n("/aipic/face/get_person_face",e)},postRemarkInfo:function(e){return a("/aipic/face/person_update",e)},postRemarkCover:function(e){return a("/aipic/face/cover_update",e)},postRemoveTag:function(e){return a("/aipic/image/removetag",e)},postMergeCluster:function(e){return a("/aipic/face/merge_cluster",e)}};r.exports=c});
;define("pan-timeline:widget/api/timeline/getlist.js",function(e,t,i){"use strict";function n(e,t){return a.get(e,void 0!==t&&{params:t})}var r=e("base:thirdParty/vue/vue.js"),a=e("base:thirdParty/vue/axios.js"),u={getClusters:["/api/image/getclusters","/aipic/image/gettimeline"],getTimeline:["/api/image/gettimeline","/aipic/image/gettimeline"],getByCluster:["/api/image/getbycluster","/aipic/image/gettimeline"],getByClusterType:["/api/image/getbycluster","/aipic/image/search"]},g={getApiVersion:function(){return n("/aipic/image/config")},getClusters:function(e){e=r.util.extend({key:"year",start:0,limit:100,type:1},e);var t=e.isNewApi?1:0,i=u.getClusters&&u.getClusters[t];return n(i,e)},getTimeline:function(e){e=r.util.extend({key:"year_day",limit:366,type:1},e);var t=e.isNewApi?1:0,i=u.getTimeline&&u.getTimeline[t];return n(i,e)},getByCluster:function(e){e=r.util.extend({limit:100},e);var t=e.isNewApi?1:0,i=u.getByCluster&&u.getByCluster[t];return n(i,e)},getRecentUpload:function(e){return e=r.util.extend({category:3,order:"time"},e),n("/api/categorylist",e)},getByClusterType:function(e){e=r.util.extend({limit:100,key:"tag",dlink:1,thumb:1,type:1,condition:{}},e);var t=e.isNewApi?1:0,i=u.getByClusterType&&u.getByClusterType[t];return n(i,e)},getAllTag:function(e){return e=r.util.extend({key:"tag",limit:100},e),n("/aipic/image/gettags",e)},doSearch:function(e){return e=r.util.extend({limit:100},e),n("/aipic/image/search",e)},faceSearch:function(e){return e=r.util.extend({limit:100,search_type:1},e),n("/aipic/image/search",e)},setSwitchConfig:function(e){return n("/aipic/image/setadvancedfunc",e)}};i.exports=g});
;define("pan-timeline:widget/components/system/Button/Button.js",function(t,e,n){var s=t("base:thirdParty/vue/vue.js"),i=s.component("pan-button",{name:"button",template:'<span v-if="show"\n    :class="[buttonMenu ? \'g-v-dropdown-button\' : \'\',\n        \'!buttonMenu\' ? \'button\' : \'\',\n        menuShow ? \'button-open\' : \'\',\n        className ? \'button-\' + className : \'\']"\n      @mouseenter="mouseEnter"\n      @mouseleave="mouseLeave">\n        <a class="g-v-button"\n           :class="[buttonSize,buttonColor,buttonType,buttonDisabled, className ? \'g-v-button-\' + className : \'\']"\n           @click.stop="onClick"\n           :href="href?href:\'javascript:void(0);\'"\n           :target="target"\n           :style="styleObj">\n            <span class="g-v-button-right">\n                <em :class="[\'icon\', iconleft]" v-if="iconleft" :title="title"></em>\n                <span :class="[\'text\', className ? \'text-\' + className : \'\']">{{text}}</span>\n                <em class="icon" v-show="iconright" :class="iconright" :title="title"></em>\n            </span>\n        </a>\n        <span :class="[\'menu\',size,color, className ? \'menu-\' + className : \'\']">\n            <a v-for="(menu,index) in buttonMenu"\n               @click.stop="menuClick(index)"\n               class="g-v-button-menu"\n               :href="menu.href?menu.href:\'javascript:void(0);\'">{{menu.text}}</a>\n        </span>\n</span>\n',props:{text:{type:String,"default":""},href:{type:String,"default":""},iconleft:{type:String,"default":""},iconright:{type:String,"default":""},size:{type:String,"default":""},color:{type:String,"default":""},title:{"default":""},show:{"default":!0},target:{type:String,"default":"_self"},menus:{type:Array,"default":function(){return[]}},disabled:{"default":!1},pluginname:{type:String},styleObj:{type:Object,"default":function(){return{}}},className:String},data:function(){return{menuShow:!1}},computed:{buttonSize:function(){return this.size?"g-v-button-"+this.size:""},buttonColor:function(){return this.color?"g-v-button-"+this.color:""},buttonType:function(){return this.styleType?"g-v-button-"+this.styleType:""},buttonMenu:function(){return 0===this.menus.length?!1:this.menus},buttonDisabled:function(){return this.disabled?"g-disabled":""}},methods:{mouseEnter:function(){this.menus&&(this.menuShow=!0),"qcode"===this.pluginname&&this.$emit("mobile-mouse-enter",this.$el)},mouseLeave:function(){this.menus&&(this.menuShow=!1),"qcode"===this.pluginname&&this.$emit("mobile-mouse-leave",this.$el)},onClick:function(){this.$emit("on-click")},menuClick:function(t){this.$emit("on-menu-click",t)}}});n.exports=i});
;define("pan-timeline:widget/components/system/GroupButton/GroupButton.js",function(t,n,o){var e=t("base:thirdParty/vue/vue.js"),u=e.component("pan-group-button",{name:"groupButton",template:'<div class="group-button">\n  <slot></slot>\n</div>\n'});o.exports=u});
;define("pan-timeline:widget/store/index.js",function(t,e,n){"use strict";var i=t("base:thirdParty/vue/vue.js"),o=t("base:thirdParty/vue/vuex.js"),u=null;i.use(o);var r={tip:{show:!1,identify:"",status:"none",msg:"",processNum:0,enterance:{},linkMsg:"",closeBtn:!1,tipName:"",tipLinkEvent:!1,icon:""},dialog:{type:"",title:"",width:0,open:!1,content:"",closeMethod:null,buttonConfirm:{},buttonCancel:{}},guide:{open:!1,width:440,guideImgStyle:{},buttonText:"",closeMethod:function(){},enterMethod:function(){}},routeType:null,isNewVersion:!1,goBackName:"返回",containerHeight:null,tipLineObj:{btnDesc:"",tipContent:"",btnClick:function(){},href:"javascript:;",tipLineClass:""},faceStatus:!1,privateSwitch:1},c={getTip:function(t){return t.tip},getDialog:function(t){return t.dialog},getGuide:function(t){return t.guide},getRouteType:function(t){return t.routeType},getIsNewVersion:function(t){return t.isNewVersion},getGoBackName:function(t){return t.goBackName},getContainerHeight:function(t){return t.containerHeight},getTipLineObj:function(t){return t.tipLineObj},getFaceSearch:function(t){return!t.isNewVersion&&t.faceStatus},getPrivateSwitch:function(t){return t.privateSwitch}},a={setTip:function(t,e){var n=e.autoClose||!1;if(u&&clearTimeout(u),null!=e)if(e.partical){delete e.partical;for(var o in e)t.tip.hasOwnProperty(o)&&(t.tip[o]=e[o])}else t.tip=i.util.extend({show:!1,identify:"",status:"none",msg:"",processNum:0,processTip:"percent",enterance:{},linkMsg:"",closeBtn:!1,tipName:"",tipLinkEvent:!1,icon:""},e);n&&(u=setTimeout(function(){t.tip.show=!1},3e3))},setDialog:function(t,e){if(null!=e)if(e.partical){delete e.partical;for(var n in e)t.dialog.hasOwnProperty(n)&&(t.dialog[n]=e[n])}else t.dialog=i.util.extend({type:"",title:"",width:440,open:!0,content:"",closeMethod:null,buttonConfirm:null,buttonCancel:null},e)},setGuide:function(t,e){t.guide=i.util.extend({isAuto:!1,open:!0,width:440,guideImgStyle:{},buttonText:"",closeMethod:function(){},enterMethod:function(){}},e)},setRouteType:function(t,e){t.routeType=e.routeType},setApiVersion:function(t,e){e&&null!=e.isNewVersion&&(t.isNewVersion=e.isNewVersion)},setGoBackName:function(t,e){null!=e.goBackName&&(t.goBackName=e.goBackName)},setContainerHeight:function(t,e){e&&null!=e.containerHeight&&(t.containerHeight=isNaN(+e.containerHeight)||"number"!=typeof+e.containerHeight?e.containerHeight:+e.containerHeight+"px")},setTipLineObj:function(t,e){if(e)if(e.partical){delete e.partical;for(var n in e)t.tipLineObj.hasOwnProperty(n)&&(t.tipLineObj[n]=e[n])}else t.tipLineObj=i.util.extend({btnDesc:"",tipContent:"",btnClick:function(){},closeClick:function(){t.tipLineObj.tipContent=null},tipLineClass:"",href:null},e)},setPrivateSwitch:function(t,e){e&&null!==e.privateSwitch&&(t.privateSwitch=e.privateSwitch)}},s={panTipClick:function(t){t.commit("setTip",{show:!1})}},l=new o.Store({state:r,getters:c,mutations:a,actions:s,modules:{}});n.exports=l});
;define("pan-timeline:widget/system/fileService/asynFileManager/asynFileManagerView.js",function(e,i,n){var a=e("system-core:context/context.js").instanceForSystem,s=e("base:widget/tools/tools.js"),t=function(){var e={},i={},n=function(){i.init()};return e.showException=function(e){var n=e.title||"确定",s=e.errorList?(e.flagRepeat?i.buildRepeatErrorList:i.buildErrorList).call(null,e.errorList,e.repeatToMsg,e.repeatFrmMsg):"",t=e.checkboxMsg?i.buildRepeatCheckboxContent(e.checkboxMsg,e.checkboxChecked):"",l=['<div class="dialog-asyn-view">',"<h4>"+e.contentTitle+"</h4>",s,t,"</div>"],o=function(){i.resetDialog(),i.hiddenDialog(),e.okCall(i.getCheckStatus())},r=function(){e.cancelCall(),i.resetDialog(),i.hiddenDialog()},c=[];e.plusText&&c.push({type:"big",color:"blue",name:"confirm",title:e.plusText,click:function(){i.resetDialog(),i.hiddenDialog(),e.plusCall(i.getCheckStatus())}}),e.okText&&c.push({type:"big",color:"blue",name:"confirm",title:e.okText,padding:["36px","36px"],click:function(){o()}}),c.push({type:"big",name:"cancel",title:e.cancelText,padding:["36px","36px"],click:function(){r()}});var p={title:n,body:l.join(""),buttons:c,onClose:function(){r()}};i.dialog=a.ui.window(p),i.hackDialog(),i.dialog.show(),i.bindEvent()},i.dialog=null,i.bindEvent=function(){var e=i.dialog.$dialog.find(".asyn-view-checkbox");e.click(function(){e.toggleClass("on")})},i.getCheckStatus=function(){var e=i.dialog.$dialog.find(".asyn-view-checkbox");return e.hasClass("on")},i.buildErrorList=function(e){var n,a=[],t=e.length>10?!0:!1,l=t?10:e.length;if(e.length&&e.server_filename&&e.isdir){a.push('<ul class="asyn-view-content asyn-view-repeat-content">');for(var o=0;l>o;o++)n=e[o],n.server_filename=n.from,n.isdir=0,a.push('<li><span class="global-icon-16 global-icon-16-'+s.encodeHTML(i.getSuffixByFile(n))+'"></span>'+s.encodeHTML(i.getFileNameByPath(n.from))+" </li>");t&&a.push('<li class="asyn-view-more global-clearfix"><span class="asyn-view-point"></span><span class="asyn-view-point"></span><span class="asyn-view-point"></span></li>'),a.push("</ul>")}return a.join("")},i.buildRepeatErrorList=function(e,n,a){var s=[],t=e.to_meta,l=e.from_meta;return t.path=e.to,l.path=e.from,t.server_filename=i.getFileNameByPath(t.path),l.server_filename=i.getFileNameByPath(l.path),s.push('<div class="asyn-view-content">'),s.push(i.buildRepeatItemErrorList(t,n)),s.push(i.buildRepeatItemErrorList(l,a)),s.push("</div>"),s.join("")},i.buildRepeatItemErrorList=function(e,n){var a=[];return a.push('<div class="asyn-view-content-item">'),a.push('<span class="asyn-view-tip-msg">'+n+"</span>"),a.push('<div class="asyn-view-tip-info">'),a.push('<span class="asyn-view-tip-icon global-icon-16 global-icon-16-'+s.encodeHTML(i.getSuffixByFile(e))+'"></span>'),a.push('<span class="asyn-view-tip-name">'+s.encodeHTML(e.server_filename)+"</span>"),a.push("</div>"),a.push('<span class="asyn-view-tip-date">'),1!==parseInt(e.isdir,10)&&a.push("大小："+s.toFriendlyFileSize(e.size)+"&nbsp;&nbsp;"),a.push("修改日期："+s.parseDate(e.mtime)+"</span>"),a.push("</div>"),a.join("")},i.buildRepeatCheckboxContent=function(e,i){var n=[];return n.push('<div class="asyn-view-checkbox '+(i?"on":"")+'">'),n.push('<span class="global-icon-checkbox"></span>'),n.push(e),n.push("</div>"),n.join("")},i.getSuffixByFile=function(e){var i,n="";return 1===parseInt(e.isdir,10)?n="dir":(i=e.server_filename+"",n=s.getFileCategory(i)),n},i.getFileNameByPath=function(e){e=e||"","/"===e[e.length-1]&&(e=e.substring(0,e.length-1));var i=e.lastIndexOf("/");return e.substring(i+1)},i.q={asynViewClass:"alert-dialog-asyn-view"},i.init=function(){},i.hackDialog=function(){i.dialog&&i.dialog.$dialog.addClass(i.q.asynViewClass)},i.resetDialog=function(){i.dialog&&i.dialog.$dialog.removeClass(i.q.asynViewClass)},i.hiddenDialog=function(){i.dialog&&i.dialog.hide()},n.apply(e,arguments),e};n.exports=new t});
;define("pan-timeline:widget/system/fileService/asynFileManager/asynFileManager.js",function(e,a,t){var r=e("base:widget/libs/jquerypacket.js"),s=e("base:widget/storage/storage.js"),o=e("system-core:context/context.js").instanceForSystem,l=e("pan-timeline:widget/system/fileService/asynFileManager/asynFileManagerView.js"),i=function(e){this.config=e,this.tiping=!1};i.moveFiles=function(e,a,t){n.doCommonTest(e,"move")&&n.doMoveCopyThing("move",e,a,t)},i.copyFiles=function(e,a,t){n.doCommonTest(e,"copy")&&n.doMoveCopyThing("copy",e,a,t)},i.deleteFiles=function(e,a){n.doCommonTest(e,"delete")&&(n.doDeleteThing("delete",e,a),this.operating=!0)},i.deleteFileSync=function(e,a){n.doCommonTest(e,"delete")&&r.post("/api/filemanager?opera=delete&async=0",{filelist:r.stringify(e)},function(e){e=r.parseJSON(e),e&&0===e.errno?a(1,e):e&&132===e.errno?a(132,e):a(0,e)}).error(function(e){var t=r.parseJSON(e.responseText);a(0,t)})},i.rename=function(e,a,t){n.doCommonTest(e,"rename")&&n.doRename("rename",e,a,t)},i.transferFiles=function(){},i.resolveHasTask=function(e,a,t){var r={},s={},o={};o.taskid=parseInt(e,10),r.operate=a,s.operate=a,s.callback=t,s.async=1,n.doMoveCopySuccCall(o,r,s)},i.transferFile=function(){},i.restore=function(e){var a="restore";n.doCommonTest(e.fidlist,a)&&(n.data.selectedFiles=e.selectedFiles,n.getData(a,e,n.doSuccessCall,n.doFailCall))};var n={};n.data={},n.QUERY_TIMEER=1e3,n.getFileNameByPath=function(e){e=e||"";var a=e.lastIndexOf("/");return e.substring(a+1)},n.getDirFromPath=function(e){return e=e||"",e.substring(0,e.lastIndexOf("/"))},n.doCommonTest=function(e,a){var t=e&&e.length>0;return o.ui.tip(t?{mode:"loading",msg:"正在"+n.getOperateName(a)+"文件，请稍候&hellip;",autoClose:!1}:{mode:"caution",msg:"请选择要"+n.getOperateName(a)+"的文件"}),t},n.doMoveCopyThing=function(e,a,t,s){var o,l,i={},c=[];t="/"===t?"":t;for(var p=0,d=a.length;d>p;p++)o=a[p],l={path:o.path,dest:t,newname:n.getFileNameByPath(o.path)},c.push(l);i.filelist=r.stringify(c),i.list=c,i.callback=s,n.getData(e,i,n.doSuccessCall,n.doFailCall)},n.doDeleteThing=function(e,a,t){var s={};s.filelist=r.stringify(a),s.list=a,s.callback=t,n.getData(e,s,n.doSuccessCall,n.doFailCall)},n.doRename=function(e,a,t,s){var o={};o.filelist=r.stringify([{path:a,newname:t}]),o.callback=s,n.getData(e,o,n.doSuccessCall,n.doRenameFailCall)},n.doSuccessCall=function(e,a,t){n.doMoveCopySuccCall(e,a,t)},n.doFailCall=function(e,a,t){if(2===t.async||12!==e.errno&&-8!==e.errno&&-9!==e.errno||e.info&&e.info[0]&&111===e.info[0].errno)if(132===e.errno)c=132,n.callTaskOverCallBack(c,t.callback,e,a,t);else{var s,l=e.errno,i="文件"+n.getOperateName(t.operate)+"失败，请稍候再试",c=3;if(12===l&&"delete"===t.operate?s=i:(12===l&&e.info&&e.info[0]&&e.info[0].errno&&(l=e.info[0].errno),102===l&&e.info&&e.info[0]&&e.info[0].errno&&(l=102===e.info[0].errno?"-102":e.info[0].errno),s=3===l?"一次操作数量不可以超过"+(e.limit||500)+"个":o.errorMsg(l,i,function(){a.removeNest=!0,a.callback=t.callback,a.list=t.list,n.getData(t.operate,a,n.doSuccessCall,n.doFailCall)})),e.flagNetError){if(c=0,!e.flagNetErrorProcess){var p=t.list,d=[];if("delete"===t.operate)for(var u=0,f=p.length;f>u;u++)d.push({from:p[u]});else if("restore"===t.operate){if(n.data.selectedFiles)for(var u=0;u<n.data.selectedFiles.length;u++){var g=n.data.selectedFiles[u];d.push({from:g.path})}}else for(var u=0,f=p.length;f>u;u++)d.push({from:p[u].path});return n.hideTips(),void n.showOtherErrorAsynView("failnet",d,t.operate,a,t)}s="任务进度查询失败，请稍候重试"}n.showErrorCloseTips(s),n.callTaskOverCallBack(c,t.callback,e,a,t)}else{if(a.async=2,a.callback=t.callback,"restore"===t.operate)a.url=t.url,a.fidlist=r.stringify(e.faillist);else{var h=e.info,m=[];if(h&&h.length>0)for(var u=0,f=h.length;f>u;u++)0===h[u].errno&&m.push(h[u].path);if(m.length>0&&t.list&&t.list.length>0)if("delete"===t.operate)for(var k=t.list.length-1;k>=0;k--)r.inArray(t.list[k],m)>=0&&t.list.splice(k,1);else for(var k=t.list.length-1;k>=0;k--)r.inArray(t.list[k].path,m)>=0&&t.list.splice(k,1);a.filelist=r.stringify(t.list)}n.getData(t.operate,a,n.doSuccessCall,n.doFailCall)}},n.doRenameFailCall=function(e,a,t){if(e.flagNetError){var r="网络异常，重名失败，稍后重试下吧";n.showErrorCloseTips(r)}else 12===e.errno?n.showRenameAsynView(e,a,t):n.callTaskOverCallBack(0,t.callback,e,a,t)},n.doMoveCopySuccCall=function(e,a,t){e.taskid>0?(n.setTaskProcess(e.taskid,0),n.taskMap.result=e,n.taskMap.params=a,n.taskMap.otherParams=t,s&&s.setItem&&e.taskid&&t.operate&&s.setItem(n.getTaskKey(),e.taskid+"_"+t.operate),n.startGetQueryData(t.operate,e.taskid,n.processSuccCall,n.processFailCall,a)):(n.showSuccTips("文件"+n.getOperateName(t.operate)+"成功"),n.callTaskOverCallBack(1,t.callback,e,a,t))},n.processSuccCall=function(e,a,t){if(0!==e.task_errno)if(n.hideTips(),-32===e.task_errno)e.errno=e.task_errno,n.doFailCall(e,a,t);else switch(t.operate){case"delete":n.showDeleteAsynView(e,a,t);break;case"rename":n.showRenameAsynView(e,a,t);break;default:n.showAsynView(e,a,t)}else if("pending"===e.status)i.tiping||n.showProcessTips("正在"+n.getOperateName(t.operate)+"文件，请稍候&hellip;",0),n.startGetQueryData(t.operate,t.taskid,n.processSuccCall,n.processFailCall,a);else if("running"===e.status){var r=0;r=e.progress?Math.min(Math.max(parseInt(e.progress,10),0),100):n.getTaskProcess(e.taskid),n.setTaskProcess(e.taskid,r),i.tiping||n.showProcessTips("正在"+n.getOperateName(t.operate)+"文件，请稍候&hellip;",r),n.startGetQueryData(t.operate,t.taskid,n.processSuccCall,n.processFailCall,a)}else"success"===e.status&&(s&&s.removeItem&&s.removeItem(n.getTaskKey()),n.showSuccTips("文件"+n.getOperateName(t.operate)+"成功"),"restore"===t.operate&&(e=n.taskMap.ignoreList),n.callTaskOverCallBack(1,n.getLastCallback(),e,a,t))},n.processFailCall=function(e,a,t){e.flagNetErrorProcess=1,n.doFailCall(e,a,t)},n.getData=function(e,a,t,r){if("restore"===e)n.getRestoreAndDeleteData(e,a,t,r);else{var s={},o=1;s.operate=e,s.callback=a.callback,s.list=a.list,delete a.callback,delete a.list,a.async&&(o=a.async,s.async=o,delete a.async),o=2,n.fetchData("/api/filemanager?opera="+e+"&async="+o,a,t,r,s)}},n.getRestoreAndDeleteData=function(e,a,t,r){var s=a.fidlist?{fidlist:a.fidlist}:{filelist:a.filelist},o=a;o.operate=e;var l=a.url+"&async="+a.async;n.fetchData(l,s,t,r,o)},n.startGetQueryData=function(e,a,t,r,s){setTimeout(function(){n.getQueryData(e,a,t,r,s)},n.QUERY_TIMEER)},n.getQueryData=function(e,a,t,r,s){var o={};o.operate=e,o.taskid=a,o.callback=n.getLastCallback(),n.fetchData("/share/taskquery?taskid="+a,s,t,r,o)},n.fetchData=function(e,a,t,s,l){r.post(e,a,function(i,n,c){if(i&&0===i.errno){t(i,a,l);var p=/taskid=(\d+)&*/i;o.log.send({type:"async",op:"async",action:l.operate,url:"//update.pan.baidu.com/statistics",product:"pan",success:1,taskid:i.taskid||(p.test(e)?e.match(p)[1]:0),ajaxerrno:i.errno,ajaxerrmsg:o.errorMsg(i.errno),ajaxstatus:c.status||0,ajaxurl:encodeURIComponent(e),ajaxparam:r.stringify(a),ajaxdata:r.stringify(i),file:r.stringify(a.filelist)})}else if(132===i.errno)s(i,a,l);else{s(i,a,l);var p=/taskid=(\d+)&*/i;o.log.send({type:"async",op:"async",action:l.operate,url:"//update.pan.baidu.com/statistics",product:"pan",success:0,taskid:i.taskid||(p.test(e)?e.match(p)[1]:0),ajaxerrno:i.errno,ajaxerrmsg:o.errorMsg(i.errno)||"未知错误",ajaxstatus:c.status||0,ajaxurl:encodeURIComponent(e),ajaxparam:r.stringify(a),ajaxdata:r.stringify(i),file:r.stringify(a.filelist)})}},"json").error(function(t,i,n){var c;try{c=r.parseJSON(t.responseText)}catch(p){}c||(c={}),c.flagNetError=1,s(c,a,l);var d=/taskid=(\d+)&*/i;o.log.send({type:"async",op:"async",action:l.operate,url:"//update.pan.baidu.com/statistics",product:"pan",success:0,taskid:c.taskid||(d.test(e)?e.match(d)[1]:0),ajaxerrno:c.errno||31021,ajaxerrmsg:o.errorMsg(c.errno||31021),ajaxstatus:n.status||0,ajaxurl:encodeURIComponent(e),ajaxparam:r.stringify(a),ajaxdata:r.stringify(c),file:r.stringify(a.filelist)})})},n.hideTips=function(){o.ui.hideTip()},n.showSuccTips=function(e){o.ui.tip({mode:"success",msg:e})},n.showErrorTips=function(e){o.ui.tip({mode:"caution",msg:e})},n.showLoadingTips=function(e){o.ui.tip({mode:"loading",msg:e,autoClose:!1})},n.showProcessTips=function(e,a){var t='<span class="asyn-tip-process" style="display: inline-block;width: 73px;height: 8px;line-height: 8px;background: #ebdfbd;margin: 0 5px;border-radius: 4px;overflow:hidden;"><span class="asyn-tip-process-inner" style="display: inline-block;background: #6cd879;height: 8px;line-height: 8px;font-size: 0;text-align: left;float: left;width:'+a+'%"></span></span>';o.ui.tip({mode:"none",msg:'<span style="padding-left: 15px;"></span>'+e+t+a+"%",autoClose:!1,hasClose:!1})},n.showErrorCloseTips=function(e){o.ui.tip({mode:"caution",msg:e,autoClose:!1,hasClose:!0})},n.taskMap={},n.setTaskProcess=function(e,a){var t=n.taskMap[e];t||(t={},n.taskMap[e]=t),t.process=a},n.getTaskProcess=function(e){var a=n.taskMap[e],t=0;return a&&(t=a.process||0),t},n.getLastCallback=function(){var e=n.taskMap;return e.otherParams&&e.otherParams.callback?e.otherParams.callback:null},n.getOperateName=function(e){var a=n.taskMap,t="操作";switch(e||a.otherParams&&a.otherParams.operate&&(e=a.otherParams.operate),e){case"copy":t="复制";break;case"move":t="移动";break;case"delete":t="删除";break;case"transfer":t="转存";break;case"rename":t="重命名";break;case"restore":t="还原"}return t},n.addTaskObj=function(e,a,t,r,s,o,l){var i=n.taskMap;i.currentTypeIndex=e||0,i.currentIndex=a||0,i.defaultList=t,i.repeatFileList=r,i.repeatFolderList=s;var c=i.notFoundList;c instanceof Array||(c=[],i.notFoundList=c),Array.prototype.push.apply(c,o);var p=i.otherList;p instanceof Array||(p=[],i.otherList=p),Array.prototype.push.apply(p,l)},n.hasNext=function(){var e,a=n.taskMap,t=a.currentTypeIndex,r=a.currentIndex;if(0===t)e=a.repeatFileList;else{if(1!==t)return!1;e=a.repeatFolderList}return r>=e.length?(a.currentTypeIndex++,a.currentIndex=0,0===t&&a.repeatFolderList.length>0?!0:!1):!0},n.doNext=function(){if(n.hasNext()){var e,a,t,r,s=n.taskMap,o=s.currentTypeIndex,l=s.currentIndex;0===o?(e=s.repeatFileList,r=0):(e=s.repeatFolderList,r=1),a=e.length-l-1,t=e[s.currentIndex],s.currentIndex++,n.showAsynViewItem(t,a,r)}else n.doAllDone()},n.doNextAll=function(e){for(var a,t=n.taskMap,r=t.currentTypeIndex,s=t.currentIndex,o=0===r?t.repeatFileList:t.repeatFolderList,l=s,i=o.length;i>l;l++)a=o[l],a.from_meta.isdir&&"overwrite"===e?a.ignore=1:a.ondup=e;t.currentIndex=o.length,0===r?n.doNext():n.doAllDone()},n.doRetryTask=function(){o.ui.tip({mode:"loading",msg:"正在"+n.getOperateName()+"文件，请稍候&hellip;",autoClose:!1});var e=n.taskMap;n.doCommonDone(e,e.otherList,n.getLastCallback()),e.otherList=[]},n.doRetryDeleteTask=function(){o.ui.tip({mode:"loading",msg:"正在"+n.getOperateName()+"文件，请稍候&hellip;",autoClose:!1});for(var e=n.taskMap,a=e.otherParams,t=e.otherList,s=[],l={},i=0,c=t.length;c>i;i++)s.push(t[i].path);e.otherList=[],l.list=s,l.filelist=r.stringify(s),l.async=2,l.callback=a.callback,n.getData(a.operate,l,n.doSuccessCall,n.doFailCall)},n.doNetErrorRetryTask=function(e,a,t,r){o.ui.tip({mode:"loading",msg:"正在"+n.getOperateName()+"文件，请稍候&hellip;",autoClose:!1}),t.async=r.async,"restore"===a?t.url=r.url:(t.list=r.list,delete t.fidlist),t.callback=r.callback,n.getData(a,t,n.doSuccessCall,n.doFailCall)},n.doAllDone=function(){var e=n.taskMap,a=e.defaultList,t=e.repeatFileList,r=e.repeatFolderList,s=[],o=(e.otherParams,n.getLastCallback());Array.prototype.push.apply(s,a),Array.prototype.push.apply(s,t),Array.prototype.push.apply(s,r),n.doCommonDone(e,s,o)},n.doCommonDone=function(e,a,t){o.ui.tip({mode:"loading",msg:"正在"+n.getOperateName()+"文件，请稍候&hellip;",autoClose:!1});for(var l,i,c=e.otherParams,p=[],d={},u=[],f=[],g=0,h=a.length;h>g;g++)l=a[g],l.ignore?u.push(l.from):(i=n.getDirFromPath(l.to),i="/"===i?"":i,p.push({path:l.from,dest:i,newname:n.getFileNameByPath(l.from),ondup:l.ondup||"fail"}),"restore"===c.operate&&l.fs_id&&f.push({fid:l.fs_id,ondup:l.ondup||"fail"}));if(n.taskMap.ignoreList=u,p.length>0)d.async=2,d.callback=c.callback,"restore"===c.operate?(d.url=c.url,d.filelist=r.stringify(f)):(d.filelist=r.stringify(p),d.list=p),n.getData(c.operate,d,n.doSuccessCall,n.doFailCall);else{s&&s.removeItem&&s.removeItem(n.getTaskKey());var m=e.repeatFileList.length+e.repeatFolderList.length;e.ignoreList.length<m?n.showSuccTips("文件"+n.getOperateName()+"成功"):n.hideTips(),n.callTaskOverCallBack(1,t,e.result,e.params,e.otherParams)}},n.doAllNotFound=function(){var e=n.taskMap,a=e.notFoundList;return a instanceof Array&&a.length>0?(n.showOtherErrorAsynView("notfound",a,e.otherParams.operate,e.params,e.otherParams),e.notFoundList=[],!0):!1},n.doAllFail=function(){var e=n.taskMap,a=e.otherList;return a instanceof Array&&a.length>0?(n.showOtherErrorAsynView("fail",a,e.otherParams.operate,e.params,n.getLastCallback()),!0):!1},n.showDeleteAsynView=function(e,a,t){if(!e.list||e.list.length<=0)return delete e.errno,void n.doFailCall(e,a,t);for(var r,s=e.list,o=[],l=[],i=0,c=s.length;c>i;i++)r=s[i],r.from=r.path,-9===r.error_code?o.push(r):l.push(r);n.addTaskObj(0,0,[],[],[],o,l),n.doNext()},n.showRenameAsynView=function(e,a,t){if(12===e.errno||-8===e.errno||-30===e.task_errno){var r={title:"提示",contentTitle:"此目录下已存在同名文件，是否要保存两个文件",okText:"保留两个文件",cancelText:"取消",okCall:function(){a.ondup="newcopy",a.callback=t.callback,a.async=2,n.getData("rename",a,n.doSuccessCall,n.doRenameFailCall)},cancelCall:function(){var r=n.taskMap;r.otherParams=t,r.result=e,r.params=a,n.callTaskOverCallBack(2,n.getLastCallback(),e,a,t)}};n.hideTips(),l.showException(r)}else delete e.errno,n.doFailCall(e,a,t)},n.showAsynView=function(e,a,t){if(!e.list||e.list.length<=0)return delete e.errno,void n.doFailCall(e,a,t);var r,s=e.list,o=[],l=[],i=[],c=[],p=[];if(s instanceof Object){for(var d=0,u=s.length;u>d;d++)r=s[d],-8===r.error_code?r.from_meta&&r.to_meta&&(r.from_meta.isdir&&r.to_meta.isdir?i.push(r):r.from_meta.isdir||r.to_meta.isdir?(r.ondup="newcopy",o.push(r)):l.push(r)):-9===r.error_code?c.push(r):p.push(r);n.addTaskObj(0,0,o,l,i,c,p),n.doNext()}},n.showOtherErrorAsynView=function(e,a,t,r,s){var o={};if(o.title="提示","restore"===s.operate)for(var i=this.data.selectedFiles,c=0;c<i.length;c++)for(var p=i[c],d=0;d<a.length;d++){var u=a[d];p.fs_id===u.fs_id&&(u.from=p.server_filename,u.to=p.server_filename,u.isdir=p.isdir)}("fail"===e||"failnet"===e)&&(o.contentTitle='网络异常，<span class="asyn-red">'+a.length+"</span>个文件"+n.getOperateName(t)+"失败，是否重试？",o.okText="重试",o.cancelText="取消"),"fail"===e?(o.okCall="delete"===t?function(){n.doRetryDeleteTask()}:function(){n.doRetryTask()},o.cancelCall=function(){n.taskMap.otherList=[],n.callTaskOverCallBack(1,n.getLastCallback())}):"failnet"===e?(o.okCall=function(){n.doNetErrorRetryTask(a,t,r,s)},o.cancelCall=function(){}):(o.cancelText="我知道了",o.contentTitle='有<span class="asyn-red">'+a.length+"</span>个文件的源文件找不到了，操作未完成",o.cancelCall=function(){n.callTaskOverCallBack(1,n.getLastCallback())}),o.flagRepeat=!1,o.errorList=a,l.showException(o)},n.showAsynViewItem=function(e,a,t){var r=e.from_meta,s=(e.to_meta,{}),o=t?"夹":"",i=n.getOperateName();if(s.title=i+"文件",s.contentTitle=i+"的位置已经包含了同名的文件"+o+"，请选择你的操作：",s.plusText=r.isdir?"跳过":"替换文件",s.plusCall=function(a){r.isdir&&(e.ignore=1),e.ondup="overwrite",a?n.doNextAll(e.ondup):n.doNext()},s.okCall=function(a){e.ondup="newcopy",a?n.doNextAll(e.ondup):n.doNext()},s.cancelCall=function(){var e=n.taskMap,a=e.otherParams,t=e.result,r=e.params;n.callTaskOverCallBack(2,n.getLastCallback(),t,r,a)},s.okText="保留两个文件"+o,s.cancelText="取消",a>0&&(s.checkboxMsg='为其余的<span class="asyn-red">'+a+"</span>个重名文件"+o+"都执行此操作"),s.flagRepeat=!0,s.repeatToMsg="已有文件"+o+"：",s.repeatFrmMsg="正在"+i+"的文件"+o+"：","还原"===i&&this.data.selectedFiles)for(var c=this.data.selectedFiles,p=0;p<c.length;p++){var d=c[p];d.fs_id===e.fs_id&&(e.from=d.path,e.to=d.path)}s.errorList=e,l.showException(s)},n.callTaskOverCallBack=function(e,a,t,r,o){return n.doAllFail()?void n.hideTips():(n.doAllNotFound()&&n.hideTips(),"function"==typeof a&&a.call(null,e,t,r,o,n.taskMap.ignoreList),void((1===e||2===e||3===e)&&s&&s.removeItem&&s.removeItem(n.getTaskKey())))},n.getTaskKey=function(){return"asynfilemanager_"+(yunData.MYNAME||"").replace(/@/g,"")},t.exports=i});
;define("pan-timeline:widget/system/fileService/fileManagerApi/fileManagerApi.js",function(e,r,a){var t=e("base:widget/libs/jquerypacket.js"),i=e("system-core:context/context.js").instanceForSystem,s=i.message,n=e("pan-timeline:widget/system/fileService/asynFileManager/asynFileManager.js"),l={FILE_NAME_REG:/[\\\/\:\*\?"<>\|]/i,resolveFileName:function(e){var r="";if(0===e.indexOf("/")&&(e=e.slice(1)),l.FILE_NAME_REG.test(e)&&(r="文件名不能包含以下字符：<,>,|,*,?,,/"),!r)if(e.length>0){for(var a=0,t=0;a<e.length;a++)e.charCodeAt(a)<128?t++:t+=2;t>255&&(r="文件(夹)名称长度不能超过255字节")}else r="文件(夹)名称不能为空，请输入文件名称";return r},resolveNewName:function(e,r,a){var t=e.substring(0,e.lastIndexOf("/"))+"/",i=r;return a&&(i=t+i),i}},o={COPY:"copy",MOVE:"move",DELETE:"delete",UPLOAD:"upload",createDirFlag:!1,sendFileMoveCopyApi:function(e,r,a,s,n){for(var l,o,c=[],g=null,f=0,p=r.length;p>f;f++)g=r[f].path,l=i.tools.baseService.parseDirPath(g),o=i.tools.baseService.parseDirFromPath(g),c.push({path:l,dest:a,newname:o});t.post("/api/filemanager?channel=chunlei&clienttype=0&web=1&opera="+e,{filelist:t.stringify(c)},s).error(n)},sendCreateNewFileApi:function(e,r,a,s,n,o){var c,g,f=i.tools.baseService.parseDirFromPath(e),p="";if(l.FILE_NAME_REG.test(f))return p="文件名不能包含以下字符：<,>,|,*,?,,/",o(p),!1;if(f.length>0){for(g=0,c=0;g<f.length;g++)f.charCodeAt(g)<128?c++:c+=2;c>255&&(p="文件(夹)名称长度不能超过255字节",o(p))}else p="文件(夹)名称不能为空，请输入文件名称",o(p);p||t.post("/api/create?a=commit",{path:e,isdir:a,size:r,block_list:s?'["'+s+'"]':"[]",method:"post"},n)},createNewDir:function(e,r,a){var s=this;if(s.createDirFlag!==!0){s.createDirFlag=!0;var n=(i.tools.baseService.parseDirFromPath(e,!0),"");n=l.resolveFileName(a),n?(r(1,n),s.createDirFlag=!1):t.post("/api/create?a=commit",{path:e,isdir:1,block_list:"[]"},function(e){var a;try{a=t.parseJSON(e)}catch(l){}a=a||{},a&&0==a.errno?r(0,"创建文件夹成功",a):(n=i.errorMsg(a.errno)||"发生未知错误，请稍后重试",r(1,n,a)),s.createDirFlag=!1}).error(function(e){var a;try{a=t.parseJSON(e.responseText)}catch(l){}a=a||{},n=i.errorMsg(a.errno)||"发生未知错误，请稍后重试",r(1,n,a),s.createDirFlag=!1})}},deleteFiles:function(e,r,a){var t=a?n.deleteFileSync:n.deleteFiles;t.call(null,e,function(e,a){if(1===e)s.trigger("quota-change"),r(0,"删除成功",a);else if(132===e){var t=i.errorMsg(a.errno)||"发生未知错误，请稍后重试";r(132,t,a)}else{a=a||{};var t=i.errorMsg(a.errno)||"发生未知错误，请稍后重试";r(1,t,a)}})},reName:function(e,r,a){var t="",s=this;s.createDirFlag!==!0&&(s.createDirFlag=!0,t=l.resolveFileName(a),t?(r(1,t),s.createDirFlag=!1):n.rename.call(null,e,l.resolveNewName(e,a),function(e,a){1===e||2===e?(a.status=e,r(0,"重命名成功",a),s.createDirFlag=!1):(t=-8===a.errno||-9===a.errno?"名称已在使用，请使用其他名称":i.errorMsg(a.errno)||"重命名失败，请稍候重试",r(1,t,a),s.createDirFlag=!1)}))}};a.exports=o});
;define("pan-timeline:widget/system/fileService/fileDelete/fileDelete.js",function(e,t,i){var n=e("base:widget/libs/jquerypacket.js"),r=e("pan-timeline:widget/system/fileService/fileManagerApi/fileManagerApi.js"),a=e("system-core:context/context.js").instanceForSystem,s={},o=function(e,t,i){s.conf.paths=e,s.conf.callback=t,s.conf.sync=i;var n="",r=s.isNotDeleteByPaths(e);if(r)return n="预置文件不可以删除",a.ui.tip({mode:"caution",msg:n}),void t.call(null,1,n);var o=a.ui.confirm({title:"确认删除",width:"460px",body:s.getTip(e),extra:u.getExtra(),onSure:function(){o.hide(),s.doDelete(s.conf.paths,s.conf.callback,s.conf.sync)},onCancel:function(){o.hide()}});o.topShow()},c=function(e){return!e instanceof Array&&(e=[e]),s.isNotDeleteByPaths(e)},l={"/apps":!0},s={conf:{},defaultFunc:function(){},getPartFileTipByPath:function(e){var t="",i="你选择的文件包含第三方应用文件，";return e+="/",-1!==e.indexOf("/apps/联通冲印/")?t=i+"删除后将导致联通冲印服务读取数据异常":-1!==e.indexOf("/apps/album/")?t="你选择的文件包含百度相册中的文件，删除后百度相册中的文件也将同步删除":-1!==e.indexOf("/我的分享/")?t="该文件已经分享给你的朋友们了，删除后将无法再被查看":-1!==e.indexOf("/apps/")&&(t=i+"删除后该应用中的文件也将同步被删除"),t},getPartFileTipByPaths:function(e){for(var t="",i=0,n=e.length;n>i&&!(t=s.getPartFileTipByPath(e[i]));i++);return t},getTip:function(e){var t=s.getPartFileTipByPaths(e),i="";return i=t?t+"<br/>是否继续？":"确认要把所选文件放入回收站吗？<br/>",i+u.middleText},isNotDeleteByPaths:function(e){for(var t=!1,i=0,n=e.length;n>i;i++)if(l[e[i]]){t=!0;break}return t},reportUser:function(e){n.getJSON("/api/report/user?action=sapi_auth",function(t){n.isFunction(e)&&e(t)})},doDelete:function(t,i,n){var o=this;r.deleteFiles(t,function(t,n,r){0===t?(a.ui.tip({mode:"success",msg:n}),i.call(null,0,n,r)):132===t?(a.ui.tip({mode:"caution",msg:n}),e.async("base:widget/passAPI/passAPI.js",function(e){e.promiseForceverify.done(function(){e.passAPI.PassportForceInit.netdiskForceVerify(),e.passAPI.PassForceverify.onSubmitFailure=function(){},e.passAPI.PassForceverify.onSubmitSuccess=function(){o.reportUser(function(e){e&&0===e.errno?setTimeout(function(){s.doDelete(s.conf.paths,s.conf.callback,s.conf.sync)},300):a.ui.tip({mode:"caution",msg:"验证失败，请稍后重试！"})})}})})):i.call(null,1,n,r)},n)}},u={middleText:"",extra:"<div class='dialog-extra-body'><button onclick='javascript:window.open(\"/buy/center?tag=8&form=deletefile\",\"_blank\");' class='extra-button' title='立即开通'>立即开通</button><em class='extra-picture'></em>开通超级会员，立享回收站文件30天保存期限</div>",memberStatus:[10,15,30],MemberType:{NOT_MEMBER:0,ORDINARY_MEMBER:1,SUPER_MEMBER:2},isSuperMember:!1,getMemberLevel:function(){return"1"===String(window.yunData.ISSVIP)?this.MemberType.SUPER_MEMBER:window.yunData.ISVIP||0},getReceycleStay:function(e){var t=a.vipConf.getVipConf().receycle,i={0:"10天",1:t.vip_value,2:t.svip_value};return i[e]||i[0]},init:function(){var e=this.getMemberLevel(),t=this.getReceycleStay(e);this.middleText="删除的文件可在"+t+"内通过回收站还原",this.isSuperMember=this.getMemberLevel()===this.MemberType.SUPER_MEMBER},getExtra:function(){return this.isSuperMember?"":this.extra}};a.locals.get("vip_level",function(){u.init()}),i.exports={deleteFiles:o,canDelete:c}});
;define("pan-timeline:widget/system/fileService/fileMoveCopy/fileMoveCopy.js",function(e,t,a){var i=e("base:widget/storage/storage.js"),n=e("system-core:context/context.js").instanceForSystem,o=e("pan-timeline:widget/system/fileService/asynFileManager/asynFileManager.js"),r=n.message,s="",l=function(e){o.tiping=e},c={"/apps":!0},u=function(e,t){var a,i,o,r,s=0,l=[];for(s;s<e.length;s++)if(a=e[s],i=a.path,o=n.tools.baseService.parseFullDirFromPath(i)||"/",r=1===parseInt(a.isdir,10),r&&t!==i&&0!==(t+"/").indexOf(i+"/")&&o!==t||!r&&o!==t)l[l.length]={path:e[s].path,dest:t,newname:n.tools.baseService.parseDirFromPath(e[s].path)};else if(r){l=[];break}return l},g=function(e,t,a,i,s){var l,c;return"copy"===e?(l="复制",c=o.copyFiles):"move"===e&&(l="移动",c=o.moveFiles),t.length<=0?(n.ui.tip({mode:"caution",msg:"不能将文件"+l+"到自身或其子目录下"}),!1):void c.call(null,t,a,function(t,n,o,l,c){1===t?(r.trigger("quota-change"),i&&i.call(null,e,a,c)):s&&s.call(null,e,a)})},m={copy:"复制到",move:"移动到"};a.exports={showDialog:function(e,t,a,i){var o={title:m[t],confirm:function(o){n.ui.treeDialog(!1);var r=u(e,o);g(t,r,o,a,i)}};n.ui.treeDialog(o)},moveTo:function(e,t,a,i){var n=u(e,t);g("move",n,t,a,i)},isNotMoveByPaths:function(e){for(var t=!1,a=0,i=e.length;i>a;a++)if(c[e[a].path]){t=!0;break}return t},manageStatus:function(){var e=!1,t=!!i.getItem("asynfilemanager_"+(yunData.MYNAME||"").replace(/@/g,""));return t?(s&&clearTimeout(s),l(!0),s=setTimeout(function(){l(!1)},2e3),n.ui.tip({mode:"caution",msg:"当前还有未完成的任务，需完成后才能操作"}),e=!0):e=!1,e},resolveHasTask:o.resolveHasTask}});
;define("pan-timeline:widget/store/componentsStore/operateBtn/index.js",function(e,t,i){"use strict";function s(e,t,i,s){for(var a=[],o=0,n=e.length;n>o;o++)a.push(e[o].path);c.deleteFiles(a,function(e,i){0===e&&"function"==typeof s&&s(),"function"==typeof t&&t(e,i)},i)}function a(){}function o(){}var n=e("base:widget/storage/storage.js"),r=e("system-core:context/context.js").instanceForSystem,l=r.message,c=e("pan-timeline:widget/system/fileService/fileDelete/fileDelete.js"),f=e("pan-timeline:widget/system/fileService/fileMoveCopy/fileMoveCopy.js"),d=e("pan-timeline:widget/api/classifyModify/getlist.js"),u=e("pan-timeline:widget/api/humanRemark/getlist.js"),m=e("base:widget/libs/underscore.js"),p=window.yunData||{},g=function(e,t){var i=[],s=null;for(var a in e)if(null===s&&(s="object"!=typeof e[a]),s===!1)for(var o=e[a],n=o.length,r=0;n>r;r++)i.push(t[o[r]]);else s===!0&&i.push(t[e[a]]);return i},h={targetImgClassify:[],classifyModify:{isShow:!1,width:600,footFixed:!0}},y={getTargetImgClassify:function(e){return e.targetImgClassify},getClassifyModify:function(e){return e.classifyModify}},v={setTargetImgClassify:function(e,t){t&&m.isArray(t.tagList)&&(e.targetImgClassify=t.tagList)},setClassifyModify:function(e,t){t&&"boolean"==typeof t.isShow&&(e.classifyModify.isShow=t.isShow)}};l.listen("system-delete",function(e){var t=f.manageStatus();if(!t){var i=e.list;i&&i.length>0&&s(i,e.callback,e.sync,e.dispose)}}),l.listen("image-classify",function(){a()}),l.listen("system-copy",function(e){var t=f.manageStatus();if(!t){var i=e.list;i&&i.length>0&&f.showDialog(i,"copy",o)}}),l.listen("system-move",function(e){var t=f.manageStatus();if(!t){var i=e.list;i&&i.length>0&&f.showDialog(i,"move",o)}});var b={shareFiles:function(e,t){var i=e.rootState,s=i.list.chooesedItemMap,a=i.list.choosedItemArr,o=[];if(t&&t.shareList&&t.shareList.length)o=t.shareList;else if("recentUpload"===i.routeType)for(var n in s)o.push(a[s[n]]);else for(var n in s)for(var r=s[n],c=r.length,f=0;c>f;f++)o.push(a[r[f]]);l.callPlugin("网盘分享@com.baidu.pan",{filesList:o})},openFiles:function(e,t){var i=e.rootState,s=[],a=-1,o=e.dispatch,n=t.fileinfo;if(i.list&&"timeline"!==i.list.vmode){var r=i.list.lists,c=r.length;a=r.indexOf(n);for(var f=0;c>f;f++)r[f].imageIndex=f;s=JSON.parse(JSON.stringify(r))}else for(var d=i.timeline&&i.timeline.curType,u=i.timeline[d].timeLineDataList,m=Object.keys(u).countingSort()||[],p=0;p<m.length;p++){var g=u[m[p]],h=g.indexOf(n);h>-1&&(a=s.length+h);for(var y=g.length,v=0;y>v;v++)g[v].imageIndex=g[v].year+"-"+g[v].month+"-"+g[v].day+"-"+v;s=s.concat(JSON.parse(JSON.stringify(g)))}var b=n.moreInfo.plugin,C=function(e){var t=i.routeType;if(e&&e[0]){var s=e[0],a=s.date,n=s.imageIndex,r=[];if("recentUpload"===i.routeType){for(var r=i.list.lists,l=r.length,c=[],f=0;l>f;f++)if(r[f].imageIndex===n){c.push(r[f]);break}}else{r=i.timeline[t].timeLineDataList[a];for(var l=r.length,c={},d=[],u=0;l>u;u++)if(r[u].imageIndex===n){d.push(r[u]),c[a]=d;break}}var m=i.routeType;o(m+"/updateBackedDatadata",{dayData:c,op:"delete"})}};return b&&b.length?void l.trigger("plugin:"+b,{filesList:[s[a]],from:"timeline",listsData:s,refresh:C}):!0},downloadFiles:function(e){var t=e.rootState,i=t.list.chooesedItemMap,s=t.list.choosedItemArr,a=[];a=g(i,s),l.callPlugin("网盘下载@com.baidu.pan",{filesList:a})},directorFiles:function(e){var t=e.rootState,i=t.list.chooesedItemMap,s=t.list.choosedItemArr,a=[];a=g(i,s),l.callPlugin("大导演入口@com.baidu.pan",{filesList:a})},deleteFiles:function(e,t){var i=e.rootState,s=(e.commit,e.dispatch),a=i.list.chooesedItemMap,o=i.list.choosedItemArr,n=[];n=g(a,o),i.lock||l.callPlugin("网盘文件删除@com.baidu.pan",{filesList:n,dispose:function(){var e=i.routeType;s(e+"/updateBackedDatadata",{additionalList:a,op:"delete",emptyCb:t.emptyCb})}})},removeFromTag:function(e,t){var i=e.rootState,s=e.commit,a=e.dispatch,o=i.list.choosedItemArr,n=i.routeType,l=[],c=[],f=[],d=function(e){var t=[],i=[];return e.forEach(function(e){-1===t.indexOf(e.date)?(t.push(e.date),i[e.date]=[e.info]):i[e.date].push(e.info)}),i},m=function(e){e?0===e.errno?(a(n+"/updateBackedDatadata",{additionalList:d(l),op:"delete",emptyCb:t.emptyCb}),t.succCb&&t.succCb()):10004===e.errno?(c=l.filter(function(t){return-1!==e.success.indexOf(t.fs_id)}),a(n+"/updateBackedDatadata",{additionalList:d(c),op:"delete"}),t.errCb&&t.errCb(e.errno)):10006===e.errno?("faceList"===i.routeType&&r.log.send({type:"web_album_human-remove-overrun"}),t.errCb&&t.errCb(e.errno)):t.errCb&&t.errCb(e.errno):t&&t.errCb&&t.errCb(),"faceList"===i.routeType&&r.log.send({type:"web_album_human-remove"})},p=function(){u.postRemoveTag(t.params).then(m).catch(function(){t.errCb()})};t.params.fs_id=[],o.forEach(function(e){f.push(e.fs_id),l.push({fs_id:e.fs_id,date:e.date,info:e})}),t.params.fs_id=JSON.stringify(f),s("setDialog",{type:"confirm",title:"移出",width:412,content:"移出后，图片不再在此展示，但仍存在于网盘，是否确认移出？",closeMethod:null,buttonConfirm:{text:"确定",color:"blue",size:"large",method:p},buttonCancel:{text:"取消",color:"",size:"large",method:""}})},facesearch:function(e){var t=e.rootState,i=t.list.chooesedItemMap,s=t.list.choosedItemArr,a=[];a=g(i,s),l.callPlugin("网盘人脸搜索@com.baidu.pan",{filesList:a})},cloudprint:function(e){var t=e.rootState,i=t.list.chooesedItemMap,s=t.list.choosedItemArr,a=[];a=g(i,s),l.callPlugin("网盘云冲印@com.baidu.pan",{filesList:a})},puzzleFiles:function(e){var t=e.rootState,i=t.list.chooesedItemMap,s=t.list.choosedItemArr,a=[];a=g(i,s),l.callPlugin("美图秀秀@com.meitu",{filesList:a})},iamgeFiles:function(e){var t=e.rootState,i=t.list.chooesedItemMap,s=t.list.choosedItemArr,a=[];a=g(i,s),l.callPlugin("网盘图片预览@com.baidu.pan",{filesList:a})},imageClassify:function(e,t){var i=e.rootState,s=e.commit,o=e.dispatch,n=i.list.chooesedItemMap,r=i.list.choosedItemArr,c=g(n,r),f={fids:JSON.stringify([r[0].fs_id])},u=function(e){if(e&&0===e.errno&&e.list&&m.isArray(e.list)&&e.list.length>0){var t=e.list[0].tags,i=[];t.forEach(function(e){1===e.tag_type&&i.push(e.tag_id)}),s("setTargetImgClassify",{tagList:i})}};t.isNewApi?(s("setClassifyModify",{isShow:!0}),d.getImgClassifyTags(f).then(u).catch(function(){t.errCb()})):(a=function(){var e=i.routeType;o(e+"/updateBackedDatadata",{additionalList:n,op:"delete",emptyCb:t.emptyCb})},l.callPlugin("网盘图片预览@com.baidu.pan",{filesList:c,from:"classify"}))},classifyModifyOperate:function(e,t){var i=e.rootState,s=e.commit,a=e.dispatch,o=i.list.chooesedItemMap,l=i.list.choosedItemArr,c=(g(o,l),t.currentTag),f={fids:JSON.stringify([l[0].fs_id])},u={fsId:l[0].fs_id,uk:p.MYUK},h=function(e){e&&0===e.errno?(d.getImgClassifyTags(f).then(y).catch(function(){t.errCb()}),s("setTip",{show:!0,msg:"修改成功",status:"success",autoClose:!0})):s("setTip",{show:!0,msg:"修改失败，请稍后再试吧",status:"caution",autoClose:!0,closeBtn:!0})},y=function(e){if(e&&0===e.errno&&e.list&&m.isArray(e.list)&&e.list.length>0){var s=e.list[0].tags,l=[];if(s.forEach(function(e){1===e.tag_type&&l.push(e.tag_id)}),1e4>c&&-1===l.indexOf(c)){var f=i.routeType;a(f+"/updateBackedDatadata",{additionalList:o,op:"delete",emptyCb:t.emptyCb}),n.removeItem("affairTags_"+p.MYUK)}r.log.send({type:"web_album_classify_modify_information",info:JSON.stringify(u),url:"//update.pan.baidu.com/statistics",clienttype:0,op:"webtimeline",op_from:"webtimelinehandle"})}};t.params.fid=l[0].fs_id,d.getModifyResult(t.params).then(h).catch(function(){t.errCb()})},copyFiles:function(e){var t=e.rootState;if(!t.lock){var i=(e.commit,e.dispatch),s=t.list.chooesedItemMap,a=t.list.choosedItemArr,n=g(s,a);o=function(){i(t.routeType+"/cancelAllChoose")},l.callPlugin("网盘文件复制@com.baidu.pan",{filesList:n,type:"copy"})}},moveFiles:function(e){var t=e.rootState;if(!t.lock){var i=e.dispatch,s=t.list.chooesedItemMap,a=t.list.choosedItemArr,n=g(s,a);o=function(){i(t.routeType+"/cancelAllChoose")},l.callPlugin("网盘文件复制@com.baidu.pan",{filesList:n,type:"move"})}},showQcode:function(){}};i.exports={state:h,getters:y,mutations:v,actions:b}});
;define("pan-timeline:widget/system/uiRender/panButton/panButton.js",function(e,n,t){var i={handleSpecifiedPageModuleButton:function(e,n){var t=e.pageModule;return t&&t.length?t.indexOf(n)>-1:!0},handleSpecifiedNumSpecialButton:function(e,n){if(e.numSpecial){var t=e.numSpecial,i=t.limit,u=t.text;e.text=i>=n?u[0]:u[1]}return!0},handlefilesLimitButton:function(e,n){return e.filesLimit&&e.filesLimit!==n.length?!1:!0},handlefilesshareButton:function(e){return e[0]&&e[0].share?!e[0].share:!0}};t.exports=i});
;define("pan-timeline:widget/components/emptyList/EmptyList.js",function(t,e,s){var n=t("base:thirdParty/vue/vue.js"),p=n.component("emptyList",{name:"emptyList",template:'<div class="module-empty-list">\n    <div class="empty-box">\n        <div class="empty-bg"></div>\n        <p class="empty-text">\n            {{emptyDesc}}\n        </p>\n    </div>\n</div>',props:{emptyDesc:{type:String}},data:function(){return{}},mounted:function(){{var t=this.$route,e=t.name;t.params.clusterType}this.$store.commit("setRouteType",{routeType:e})}});s.exports=p});
;define("pan-timeline:widget/components/operateBtn/operateBtn.js",function(e,t,o){"use strict";var s=e("base:thirdParty/vue/vue.js"),i=e("base:thirdParty/vue/vuex.js"),n=e("system-core:context/context.js").instanceForSystem,a=e("pan-timeline:widget/components/system/Button/Button.js"),l=e("pan-timeline:widget/components/system/GroupButton/GroupButton.js"),r=e("pan-timeline:widget/store/index.js"),c=e("pan-timeline:widget/store/componentsStore/operateBtn/index.js"),u=e("pan-timeline:widget/system/uiRender/panButton/panButton.js"),m=e("pan-timeline:widget/components/emptyList/EmptyList.js"),p=i.mapGetters,d={logFlag:{cancelChoose:!0},init:function(){return r.registerModule("operateBtn",c),s.component("operateBtn",{name:"operateBtn",template:'<div class="module-operateBtn">\n    <pan-group-button>\n        <pan-button\n            v-for="(item, index) in buttons"\n            v-if="item.show == null || item.show === true"\n            :text="item.text"\n            :iconleft="item.iconleft"\n            :size="item.size"\n            :menus="item.menus"\n            :pluginname="item.pluginName"\n            @on-click="callsPlugin(item.pluginName)"\n            @on-menu-click="callsPlugin"\n            @mobile-mouse-enter="mobileMouseEnter"\n            @mobile-mouse-leave="mobileMouseLeave">\n        </pan-button>\n    </pan-group-button>\n    <div class="selectInfo">\n        <span class="chooseNum">已选择 {{chooseLen}} 张</span>\n        <pan-button\n        :text="cancelAllChoose.text"\n        :color="cancelAllChoose.color"\n        :size="cancelAllChoose.size"\n        @on-click="cancelAllChooseClick"></pan-button>\n    </div>\n</div>',props:{type:String},data:function(){var e=this;return{buttons:[{text:"分享",size:"middle",iconleft:"icon-share",pluginName:"share",menus:[]},{text:"手机看",size:"middle",iconleft:"icon-sjck",pluginName:"qcode",menus:[],filesLimit:1,share:!0},{text:"下载",size:"middle",iconleft:"icon-download",pluginName:"download",menus:[]},{text:"删除",size:"middle",iconleft:"icon-delete",pluginName:"delete",menus:[]},{text:"移出",size:"middle",iconleft:"icon-remark-remove",pluginName:"remove",menus:[],pageModule:["faceList","classifyList"],showFun:function(){return e.isNewApi&&e.isAffair}},{text:"人脸搜索",size:"middle",iconleft:"icon-search",pluginName:"facesearch",menus:[],showFun:function(){return e.faceStaus}},{text:"云冲印",size:"middle",iconleft:"icon-print",pluginName:"cloudprint",menus:[],showFun:function(){return!1}},{text:"美化",size:"middle",iconleft:"icon-beauty",pluginName:"puzzle",numSpecial:{text:["美化","拼图"],limit:1},menus:[]},{text:"电影制作",size:"middle",iconleft:"icon-director",pluginName:"video",menus:[],showFun:function(){return!1}},{text:"更多",size:"middle",iconleft:"icon-more",menus:[{text:"复制到",pluginName:"copy"},{text:"移动到",pluginName:"move"}]}],cancelAllChoose:{text:"取消选择",size:"small",color:"blue"},isNewApi:this.$store.getters.getIsNewVersion,isAffair:!1}},components:{"pan-button":a,"pan-group-button":l},methods:{errCb:function(e){this.$store.commit("setTip",{show:!0,msg:n.errorMsg(e),status:"caution",autoClose:!0,closeBtn:!0})},handleButtons:function(){for(var e=this,t=function(t){var o=u.handleSpecifiedPageModuleButton(t,e.routeType),i=u.handleSpecifiedNumSpecialButton(t,e.chooseLen),n=u.handlefilesLimitButton(t,e.choosedItemArr),a=u.handlefilesshareButton(e.choosedItemArr),l=t.showFun?t.showFun():!0;o&&i&&l&&n&&a?s.set(t,"show",!0):s.set(t,"show",!1)},o=e.buttons,i=o.length,n=0;i>n;n++){var a=o[n];(a.pageModule||a.showFun||a.numSpecial||a.filesLimit||a.share)&&t(a)}},emptyCb:function(){var e=this;e.$store.commit("setListEmpty",{show:!0,listEmptyComponent:m,emptyDesc:e.emptyDesc||"暂无内容，去浏览其他照片吧~"}),this.$route.commit("setListStatus",{listStatus:-1})},callsPlugin:function(e){var t="",o=this,s={};switch("number"==typeof e&&(e=this.buttons[9].menus[e].pluginName),e){case"share":t="shareFiles",this.routeType&&n.log.send({type:"web_album_timeline_share",value:"",sendServerLog:!0});break;case"qcode":t="showQcode",this.routeType&&n.log.send({type:"",value:"",sendServerLog:!0});break;case"download":t="downloadFiles",this.routeType&&n.log.send({type:"web_album_timeline_download",value:"",sendServerLog:!0});break;case"delete":t="deleteFiles",s.emptyCb=this.emptyCb,this.routeType&&n.log.send({type:"web_album_timeline_delete",value:"",sendServerLog:!0});break;case"remove":t="removeFromTag",s.emptyCb=this.emptyCb,s.params={tag_id:o.$route.params.tagId||o.$route.params.clusterType},s.succCb=function(){o.$store.commit("setTip",{show:!0,msg:"全部移出成功",status:"success",autoClose:!0,closeBtn:!1})},s.errCb=this.errCb,this.routeType&&n.log.send({type:"web_album_timeline_remove",value:"",sendServerLog:!0});break;case"facesearch":t="facesearch",this.routeType&&n.log.send({type:"web_album_timeline_facesearch",value:"",sendServerLog:!0});break;case"cloudprint":t="cloudprint",this.routeType&&n.log.send({type:"web_album_timeline_cloudprint",value:"",sendServerLog:!0});break;case"puzzle":t="puzzleFiles",this.routeType&&n.log.send({type:"web_album_timeline_puzzle",value:"",sendServerLog:!0});break;case"image":t="iamgeFiles";break;case"imageClassify":t="imageClassify",s.isNewApi=this.isNewApi,s.isNewApi||(s.emptyCb=this.emptyCb);break;case"video":t="directorFiles";break;case"copy":t="copyFiles",this.routeType&&n.log.send({type:"web_album_timeline_copy",value:"",sendServerLog:!0});break;case"move":t="moveFiles",this.routeType&&n.log.send({type:"web_album_timeline_move",value:"",sendServerLog:!0})}t&&this.$store.dispatch(t,s)},cancelAllChooseClick:function(){var e=this.routeType;this.$store.dispatch(e+"/cancelAllChoose"),d.logFlag.cancelChoose&&(n.log.send({type:"web_album_newlist_cancel_choose",logFrom:this.type}),d.logFlag.cancelChoose=!1)},addImageClassifyToMoreBtn:function(e){var t={text:"修改分类",pluginName:"imageClassify"},o=this.buttons[9].menus,s=["复制到","移动到"],i=["classifyList","faceList"],n=this.chooseLen;-1!==i.indexOf(this.routeType)&&(e&&1===n&&o.length===s.length?o.unshift(t):!e&&o[0]&&"修改分类"===o[0].text&&o.shift())},mobileMouseEnter:function(e){var t=this;t.choosedItemArr[0].server_filename||(t.choosedItemArr[0].server_filename=t.choosedItemArr[0].moreInfo.fileName),d.QcodeDialog=n.ui.qcodeDialog({width:"490px",show:!0,currentTarget:e,fileParams:t.choosedItemArr[0],imageUrl:"https://pan.baidu.com/api/qrcode/openfile?fsid="+t.choosedItemArr[0].fs_id,position:{dgtop:"34px",dgleft:"15px",trleft:"100px"},dialogType:"aside",logName:"listToolsQcodeShow",logValue:"扫码消费文件列表页单选后顶部toolbar入口二维码生成次数"}),d.QcodeDialog.show()},mobileMouseLeave:function(){d.QcodeDialog.hide(),d.QcodeDialog.destroy()}},created:function(){var e=1===+this.$route.params.classifyType?!0:!1;if(this.isAffair=e,d.logFlag)for(var t in d.logFlag)d.logFlag.hasOwnProperty(t)&&(d.logFlag[t]=!0)},computed:s.util.extend(p({lock:"getLock",routeType:"getRouteType",choosedItemArr:"getChoosedItemArr",chooseLen:"getChooseLength",faceStaus:"getFaceSearch",listInfo:"getListInfo"})),watch:{chooseLen:function(e){var t=1===e;this.handleButtons(),this.addImageClassifyToMoreBtn(t)},$route:{handler:function(e){this.isAffair=e.params&&1===+e.params.classifyType?!0:!0},deep:!0},listInfo:{handler:function(e){this.isAffair=e&&1===e.type?!0:!1},deep:!0},choosedItemArr:{handler:function(){},deep:!0}},mounted:function(){this.handleButtons(),this.addImageClassifyToMoreBtn(!0)}})}};o.exports=d.init()});
;define("pan-timeline:widget/system/util/util.js",function(e,t,i){"use strict";var r=e("base:thirdParty/vue/vue.js"),a={timeLogList:{},getFromLocal:function(e){e=r.util.extend({storeKey:null,expireTime:864e5,getDataFromServer:function(){},getDataFromLocal:function(){}},e);var t=+new Date,i=null!=e.expireTime?e.expireTime:864e5,a=e.storeKey,o=e.getDataFromLocal,n=e.getDataFromServer;if(null!=localStorage&&localStorage.getItem(a)){var l=localStorage.getItem(a);if(i){var m=l.indexOf("@@"),s=l.slice(0,m),u=l.slice(m+2);t-s>i?n():o(u)}else o(u)}else n()},time:function(e){a.timeLogList[e]=+new Date},timeEnd:function(e){if(a.timeLogList[e]){var t=a.timeLogList[e];return a.timeLogList[e]=null,+new Date-t}return 0}};i.exports=a});
;define("pan-timeline:widget/system/util/imageSystem/imageSystem.js",function(e,n,t){var i=(e("base:widget/tools/tools.js"),{name:"FaceImageSystem",version:1,db:null,isAvailable:!1,isOpen:!1}),r={imageList:"faceImageList",owner:"owner"},o={imageWithSize:["imageWithSize",["cover_fs_id","tag_id","w","h"],{unique:!0}]},a=function(e,n,t){return new Promise(function(i,r){n?e[n]=function(e){i(e)}:e.onsuccess=function(e){i(e)},t?e[t]=function(e){r(e)}:e.onerror=function(e){r(e)}})},u=function(e,n){var t=indexedDB.open(e,n);return t.onupgradeneeded=function(e){var n,t=e.target.result,i=e.target.transaction;n=t.objectStoreNames.contains(r.imageList)?i.objectStore(r.imageList):t.createObjectStore(r.imageList,{autoIncrement:!0});for(var a in o)o.hasOwnProperty(a)&&!n.indexNames.contains(a)&&n.createIndex.apply(n,o[a]);t.objectStoreNames.contains(r.owner)||t.createObjectStore(r.owner,{keyPath:"uk"})},a(t)},c=function(){var e=!!window.ProgressEvent,n=!!window.FormData,t=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;return e&&n&&t},s=function(){return"function"==typeof window.URL&&"function"==typeof window.URL.createObjectURL&&"function"==typeof window.URL.revokeObjectURL},f=function(e,n){for(var t=i.db.transaction(e,"readwrite"),r=t.objectStore(e),o=0;o<n.length;o++)r.put(n[o]);return a(t,"oncomplete")},d=function(e){var n=i.db.transaction(e,"readonly"),t=n.objectStore(e),r=t.openCursor();return a(r)},g=function(e){var n=i.db.transaction(e,"readwrite"),t=n.objectStore(e),r=t.clear();return a(r)},l=function(e,n){return g(e).then(function(){return f(e,n)})},m=function(){return d(r.owner).then(function(e){var n=e.target.result;return n&&+n.value.uk===+window.yunData.MYUK?void 0:g(r.imageList)}).then(function(){return l(r.owner,[{uk:window.yunData.MYUK}])})},w=function(){return"object"!=typeof indexedDB?!1:"function"!=typeof Promise?!1:"yun.baidu.com"===location.hostname?!1:c()&&s()?navigator.userAgent.indexOf("Edge")>-1?!1:navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")?!1:!0:!1},b=function(){w()&&u(i.name,i.version).then(function(e){i.db=e.target.result,i.isOpen=!0},function(){i.isOpen=!1,i.isAvailable=!1}).then(function(){return m()}).then(function(){i.isAvailable=!0},function(){})},v=function(e,n){var t=i.db.transaction(r.imageList,"readonly"),o=t.objectStore(r.imageList),u=o.index(e),c=u.get(n);return a(c)},p=function(e){return new Promise(function(n,t){var i=new XMLHttpRequest;i.open("GET",e),i.withCredentials=!0,i.responseType="blob",i.onload=function(e){200===e.target.status?n(e.target.response):t(e)},i.onerror=function(e){t(e)},i.send()})},h=function(e,n,t){var i={w:200,h:200};return v(o.imageWithSize[0],IDBKeyRange.only([e,n,i.w,i.h])).then(function(o){var a=o.target.result;return a?Promise.resolve(URL.createObjectURL(a.blob)):p(t).then(function(t){return f(r.imageList,[{cover_fs_id:e,tag_id:n,w:i.w,h:i.h,blob:t}]).then(function(){},function(){}),Promise.resolve(URL.createObjectURL(t))})})},L={isAvailable:function(){return i.isAvailable&&i.isOpen},getImageURL:function(e,n,t){return L.isAvailable()?h(e,n,t):void Promise.reject({})}};b(),t.exports=L});
;define("pan-timeline:widget/filters/index.js",function(e,t,i){var r=e("base:thirdParty/vue/vue.js"),n=e("base:widget/libs/underscore.js"),a=e("pan-timeline:widget/system/util/imageSystem/imageSystem.js"),o={HTTPVersion:"1.1",normalDomains:[],thumbsDomains:[]},s={pictureSizeFor312:156,pictureSizeFor344:172,checkHttpVersion:function(){function e(){t.isReady=!0,n.isFunction(t.callback)&&t.callback()}for(var t={isReady:!1},i=0;10>i;i++)o.normalDomains.push("d"+i+".pcs.baidu.com"),o.thumbsDomains.push("thumbnail"+i+".baidupcs.com");e()},getIdleDomain:function(e){var t=0,i="normalDomains",r="thumbsDomains";if(e&&"2"===String(o.HTTPVersion))return"https://thumbnail10.baidupcs.com";var n=e?r:i;return o[n][t++%10]},getProcessedSrc:function(e,t){if(null===e)return"";if(e.indexOf("http")<0)return e;var i="pcs.baidu.com",r="d.pcs.baidu.com",n="thumbnail0.baidupcs.com",a="http:"===document.location.protocol,o=e.indexOf(r)>-1,c=e.indexOf(n)>-1;if(!o&&!c)return e;var u=o?r:n,p=r;return o&&a&&(p=s.getIdleDomain()),c&&(p=s.getIdleDomain(!0)),t&&(p=location.protocol+"//"+i),u!==p&&((p.indexOf("https://")>-1||t)&&(u=new RegExp("(http|https)://"+u)),e=e.replace(u,p)),e},orientationFix:function(e){return"LeftTopOrientation"===e||"LeftBottomOrientation"===e||"RightBottomOrientation"===e||"RightTopOrientation"===e?!0:!1}};s.checkHttpVersion();var c={imageFormat344:function(e){var t=s.getProcessedSrc(e.value);if((void 0===e.size||void 0===e.orientation)&&t)return e.value=s.getProcessedSrc(e.value),t.replace("size=c200_u200","size=c344_u344").replace("size=c140_u90","size=c344_u344");var i=0,r=s.pictureSizeFor344;if(t&&e.size.indexOf(",")>-1){var n=e.size.split(","),a=e.orientation,o=parseInt(n[0].match(/\d+/g),10),c=parseInt(n[1].match(/\d+/g),10);if(s.orientationFix(a)&&o>c){var u=o;o=c,c=u}return o>=r&&c>=r?o>c?(i=c/r,c=r,o/=i):(i=o/r,o=r,c/=i):0===o&&0===c?(c=r,o=r):(o>=r&&r>c||r>=o&&c>r||o>r&&r>=c||r>o&&c>=r)&&(o>c?(i=c/r,c=r,o/=i):(i=o/r,o=r,c/=i)),t.replace("size=c200_u200","size=c"+parseInt(o,10)+"_u"+parseInt(c,10)).replace("size=c140_u90","size=c"+parseInt(o,10)+"_u"+parseInt(c,10))}return t},imageFormat312:function(e){var t=s.getProcessedSrc(e.value);if((void 0===e.size||void 0===e.orientation)&&t)return t.replace("size=c200_u200","size=c300_u300").replace("size=c140_u90","size=c300_u300");var i=0,r=s.pictureSizeFor312;if(t&&e.size.indexOf(",")>-1){var n=e.size.split(","),a=e.orientation,o=parseInt(n[0].match(/\d+/g),10),c=parseInt(n[1].match(/\d+/g),10);if(s.orientationFix(a)&&o>c){var u=o;o=c,c=u}return o>=r&&c>=r?o>c?(i=c/r,c=r,o/=i):(i=o/r,o=r,c/=i):0===o&&0===c?(c=r,o=r):(o>=r&&r>c||r>=o&&c>r||o>r&&r>=c||r>o&&c>=r)&&(o>c?(i=c/r,c=r,o/=i):(i=o/r,o=r,c/=i)),t.replace("size=c200_u200","size=c"+parseInt(o,10)+"_u"+parseInt(c,10)).replace("size=c140_u90","size=c"+parseInt(o,10)+"_u"+parseInt(c,10))}return t},positionFix344:function(e){var t=e.value,i=e.orientation,r=s.pictureSizeFor344;if(t&&t.indexOf(",")>-1){var n=t.split(","),a=0,o=0,c=0,u=parseInt(n[0].match(/\d+/g),10),p=parseInt(n[1].match(/\d+/g),10);if(u>=r&&p>=r?u>p?(c=p/r,p=r,u/=c):(c=u/r,u=r,p/=c):0===u&&0===p?(p=r,u=r):(u>=r&&r>p||r>=u&&p>r||u>r&&r>=p||r>u&&p>=r)&&(u>p?(c=p/r,p=r,u/=c):(c=u/r,u=r,p/=c)),a=(r-p)/2,o=(r-u)/2,s.orientationFix(i)&&u>p){var m=a;a=o,o=m}return"top:"+a+"px;left:"+o+"px"}return t},positionFix312:function(e){var t=e.value,i=e.orientation,r=s.pictureSizeFor312;if(t&&t.indexOf(",")>-1){var n=t.split(","),a=0,o=0,c=0,u=parseInt(n[0].match(/\d+/g),10),p=parseInt(n[1].match(/\d+/g),10);if(u>=r&&p>=r?u>p?(c=p/r,p=r,u/=c):(c=u/r,u=r,p/=c):0===u&&0===p?(p=r,u=r):(u>=r&&r>p||r>=u&&p>r||u>r&&r>=p||r>u&&p>=r)&&(u>p?(c=p/r,p=r,u/=c):(c=u/r,u=r,p/=c)),a=(r-p)/2,o=(r-u)/2,s.orientationFix(i)&&u>p){var m=a;a=o,o=m}return"top:"+a+"px;left:"+o+"px"}return t},formatTime:function(e){if(isNaN(parseInt(e,10)))return"神秘时间";var t=e.slice(0,4),i=e.slice(4,6),r=e.slice(6);return t+" 年 "+i+" 月 "+r+" 日"},imageSrcFormat:function(e){return null!=e&&(e=s.getProcessedSrc(e)),e},getImageFromDB:function(e){if(null!=e){var t=e.cover_fs_id,i=e.tag_id,n=e.cover_photo,o=s.getProcessedSrc(n);t&&i&&o&&a.isAvailable()?a.getImageURL(t,i,o).then(function(t){r.set(e,"formatSrc",t)},function(){o=s.getProcessedSrc(n),r.set(e,"formatSrc",o)}):(o=s.getProcessedSrc(n),r.set(e,"formatSrc",o))}}};i.exports=c});
;define("pan-timeline:widget/components/searchTip/searchTip.js",function(t,i,e){"use strict";var n=t("base:thirdParty/vue/vue.js"),s=t("base:thirdParty/vue/vuex.js"),a=(t("pan-timeline:widget/store/index.js"),t("pan-timeline:widget/system/util/util.js"),t("pan-timeline:widget/filters/index.js")),r=s.mapGetters,o=(window.yunData,{conf:{limit:100,defaultTag:{1:"事物",2:"地点",3:"人物"},tipOrderList:[3,1,2]},init:function(){var t=n.component("searchTip",{name:"searchTip",template:'<transition name="slide-fade">\n    <div class="search-tip-container"\n        v-if="tipList && tipList.length">\n        <div class="search-tip"\n            v-for="(curType, groupIndex) in tipList">\n            <span class="tip-desc">\n                {{curType.name}}\n            </span>\n            <div class="tip-item"\n                :class="{\'tip-item-face\': item.type === \'3\', \'tip-item-hover\': item.hoverSelect}"\n                @mouseenter="hoverSelect(\'hover\', groupIndex, index)"\n                @click="tipClick(item);"\n                v-for="(item, index) in curType">\n                <em v-if="item.type === \'3\'"\n                    class="cover-photo"\n                    :style="{\'backgroundImage\': item && item.formatSrc != null ? \'url(\' + item.formatSrc + \')\' : \'none\'}"></em>\n                <span class="tip-item-text">{{item.name}}</span>\n            </div>\n        </div>\n    </div>\n</transition>',props:{searchStr:String},data:function(){return{start:0,hasMore:!0,isLoading:!1,tipList:[],selectIndex:null,tagList:{}}},created:function(){this.initClassifyData||this.$store.dispatch("classify/getClassifyData"),this.getClassifyTag()},mounted:function(){this.$nextTick(function(){this.$on("onUpOrDown",function(t){this.hoverSelect(t)}),this.$on("onEnterKeyDown",function(){this.tipList=[]})})},watch:{searchStr:function(t){null!=t&&t.length?(this.tipList=this.getTipList(t),this.selectIndex=null):(this.tipList=[],this.selectIndex=null)},affairLists:function(t,i){t&&i&&t.length===i.length||this.formatTags(this.affairLists,1)},positionLists:function(t,i){t&&i&&t.length===i.length||this.formatTags(this.positionLists,2)},markedHumanData:function(t,i){t&&i&&t.length===i.length||this.formatTags(this.markedHumanData,3)},privateSwitch:function(t){0===t&&this.getFaceTag()}},computed:n.util.extend(r({initClassifyData:"getDataFlag",affairLists:"getAffairlists",positionLists:"getPositionlists",markedHumanFlag:"getMarkedHumanFlag",markedHumanData:"getMarkedHumanData",privateSwitch:"getPrivateSwitch"}),{}),methods:{getClassifyTag:function(){null!=this.affairLists&&this.formatTags(this.affairLists,1),null!=this.positionLists&&this.formatTags(this.positionLists,2)},getFaceTag:function(){this.markedHumanFlag?this.formatTags(this.markedHumanData,3):this.$store.dispatch("classify/getMarkedHumanData")},formatTags:function(t,i,e){var n=this.tagList||{};if(null!=t&&t.length){t=JSON.parse(JSON.stringify(t));var s=Object.keys(o.conf.defaultTag),a=function(t){for(var i=0;i<t.length;i++){var e=t[i];if(s.indexOf(e.type+"")>-1){if(1===+e.type&&0===+e.is_search)continue;n[e.type]=n[e.type]||[],n[e.type].push(e)}}};if(null!=i&&s.indexOf(i+"")>-1&&t.length?(n[i]=n[i]||[],e?1===i?a(t):n[i]=n[i].concat(t):(n[i]=[],1===i?a(t):n[i]=t)):a(t),null!=i)n[i]&&n[i].sort(function(t,i){return+i.count-+t.count});else for(var r in n)n.hasOwnProperty(r)&&n[r].sort(function(t,i){return+i.count-+t.count});this.tagList=n}},getTipList:function(t){var i=JSON.parse(JSON.stringify(this.tagList)),e={};t=decodeURIComponent(t);var n=/(\*|\.|\?|\+|\$|\^|\[|\]|\(|\)|\{|\}|\||\/|\\)/gi;t=t.replace(n,"\\$1");var s=new RegExp(t+".*"),r=o.conf.tipOrderList,l=[];if("{}"!==JSON.stringify(i))for(var h in i)if(i.hasOwnProperty(h)){for(var c=i[h],f=[],p=0;p<c.length;p++){var u=c[p],g=u.tag_name;if(3===+u.type){if(null==u.name)continue;g=u.name}if(s.test(g)){if(!(f.length<2))break;3===+u.type&&a.getImageFromDB(u),u.name=g,f.push(u)}}f.length&&(e[h]=f,e[h].name=o.conf.defaultTag[h])}for(var p=0;p<r.length;p++)null!=e[r[p]]&&l.push(e[r[p]]);return l},hoverSelect:function(t,i,e){if(this.tipList&&this.tipList.length){for(var s=this.tipList,a=[],r=0;r<s.length;r++)for(var o=0;o<s[r].length;o++)n.set(s[r][o],"hoverSelect",!1),a.push(r+""+o);"hover"===t&&null!=i&&null!=e?this.selectIndex=i+""+e:null==this.selectIndex&&(this.selectIndex="-1");var l=a.indexOf(this.selectIndex);if("down"===t)var e=Math.min(l+1,a.length-1);else if("up"===t)var e=Math.max(l-1,0);else if("hover"===t)var e=l;this.selectIndex=a[e];var h=this.selectIndex.split("")[0],e=this.selectIndex.split("")[1];if(s[h]&&s[h][e]){var c=s[h][e];n.set(c,"hoverSelect",!0),("down"===t||"up"===t)&&this.$emit("on-tip-hover",c)}}},tipClick:function(t){this.$emit("on-tip-select",t),this.tipList=[]}}});return t}});e.exports=o.init()});
;define("pan-timeline:widget/components/searchBox/searchBox.js",function(e,t,s){"use strict";var r=e("base:thirdParty/vue/vue.js"),n=e("base:thirdParty/vue/vuex.js"),c=e("base:widget/libs/jquerypacket.js"),i=e("pan-timeline:widget/components/searchTip/searchTip.js"),o=e("system-core:context/context.js").instanceForSystem,a=n.mapGetters,h={disalbePlaceHolder:function(){var e=document.createElement("input");return!("placeholder"in e)}(),init:function(){var e=r.component("searchBox",{name:"searchBox",template:'<div class="module-search-timeline"  v-if="showSearchBox"\n    :style="{right: paddingLarge ? \'184px\' : \'68px\'}">\n    <div class="form-box" node-type="form-box">\n        <div class="search-form clearfix">\n            <!-- IE9 不支持placeHolder -->\n            <template v-if="disablePlaceHolder"> \n                <input class="search-query" type="text" spellchecking="off" autocomplete="off"\n                    v-model.trim="searchStr"\n                    @keyup.stop.prevent="onKeyDown($event);"\n                    @focus="processPlaceHolder(false);"\n                    @blur="processPlaceHolder(true);">\n                <span class="search-query input-placeholder" v-show="placeholder"\n                    @click.stop.prevent="triggerInputFocus();">{{placeholder}}</span>\n            </template>\n            <template v-else>\n                <input class="search-query" type="text"\n                    v-model.trim="searchStr"\n                    :placeholder="placeholder"\n                    @keyup.stop.prevent="onKeyDown($event);"\n                    @focus="processPlaceHolder(false);"\n                    @blur="processPlaceHolder(true);">\n            </template>\n            <span class="input-clear icon icon-search-del"\n                v-if="searchStr && searchStr.length > 0"\n                @click.stop="clearInput();"></span>\n            <span class="search-button"\n                @click.stop="doSearch();">\n                <span class="icon icon-search"></span>\n            </span>\n        </div>\n    </div>\n    <search-tip ref="searchTip"\n        v-show="showTip"\n        @on-tip-select="doSearch"\n        @on-tip-hover="setHoverSelect"\n        :searchStr="searchStr"></search-tip>\n</div>',props:{paddingLarge:Boolean},data:function(){return{searchStr:null,showSearchBox:!0,hasKeyWord:!1,showTip:!0,disablePlaceHolder:h.disalbePlaceHolder}},components:{"search-tip":i},watch:{searchStr:function(e){null!=e&&e.length&&(this.showTip=!0)}},mounted:function(){var e=this.$route,t=e.name,s=e.query.key;"searchList"===t&&null!=s?(this.searchStr=decodeURIComponent(s),this.placeholder=null,this.$nextTick(function(){this.showTip=!1})):this.searchStr=null},computed:r.util.extend(a({routeType:"getRouteType",privateSwitch:"getPrivateSwitch"}),{placeholder:function(){return this.privateSwitch?"通过事物，地点搜索你的图片":"通过人物，事物，地点搜索你的图片"}}),methods:{doSearch:function(e){var t=2,s=this.searchStr,r=this.searchStr;if(null!=e&&(t=1,r=this.searchStr=e.name,s=e.tag_id+"",this.showTip=!1,this.$nextTick(function(){this.showTip=!1})),null!=s&&s.length){var n={path:"/search/grid/"+t+"/"+encodeURIComponent(s)};null!=r&&(n.query={key:encodeURIComponent(r)}),this.searchStr=null,this.placeholder=null,this.$router.push(n),1===t&&o.log.send({type:"web_album_advanced_pic_search"}),o.log.send({type:"web_album_pic_search"})}},clearInput:function(){this.searchStr=null,this.$nextTick(function(){this.searchStr=null,"searchList"===this.routeType&&this.$router.push({path:"/classify"})})},setHoverSelect:function(e){null!=e&&(this.hoverSelect=e)},onKeyDown:function(e){var t=e.keyCode||e.which||e.charCode;13===t?(this.doSearch(this.hoverSelect),this.$refs&&this.$refs.searchTip&&this.$refs.searchTip.$emit("onEnterKeyDown"),this.hoverSelect=null):38===t?this.$refs&&this.$refs.searchTip&&this.$refs.searchTip.$emit("onUpOrDown","up"):40===t&&this.$refs&&this.$refs.searchTip&&this.$refs.searchTip.$emit("onUpOrDown","down")},processPlaceHolder:function(e){var t=this;if(e)setTimeout(function(){t.placeholder=t.privateSwitch?"通过事物，地点搜索你的图片":"通过人物，事物，地点搜索你的图片",t.showTip=!1},100);else{this.placeholder=null;var s=this.searchStr;this.searchStr="",null!=s&&s.length&&this.$nextTick(function(){this.searchStr=s,this.showTip=!0})}},triggerInputFocus:function(){c(".input-placeholder").hide(),c(".search-query").focus()}}});return e}};s.exports=h.init()});
;define("pan-timeline:widget/components/goBack/goBack.js",function(t,e,a){"use strict";var o=t("base:thirdParty/vue/vue.js"),s=t("base:thirdParty/vue/vuex.js"),i=t("base:widget/tools/service/tools.browser.js"),n=s.mapGetters,c={init:function(){var t=o.component("goBack",{name:"goBack",template:'<div node-type="module-go-back" class="module-go-back">\n    <a class="goback-btn" @click.stop="goBack();">\n        <em class="icon icon-arrow-left"></em>\n        <span class="text">{{goBackName}}</span>\n    </a>\n</div>',data:function(){return{name:"返回",defaultRoute:"/classify"}},methods:{goBack:function(){var t=i.client().browserString,e=-1!==t.indexOf("safari");null!=window.history&&window.history.length>1?e&&2===window.history.length?this.$router.push({path:this.defaultRoute}):this.$router.back():this.$router.push({path:this.defaultRoute})}},destroyed:function(){this.$store.commit("setGoBackName",{goBackName:this.name})},computed:o.util.extend(n({listStatus:"getListStatus",listEmpty:"getListEmpty",goBackName:"getGoBackName"}),{})});return t}};a.exports=c.init()});
;define("pan-timeline:widget/components/system/BaseDialog/BaseDialog.js",function(e,i,o){var t=e("base:thirdParty/vue/vue.js"),a={initDialog:function(){a.dialogInstance=t.component("base-dialog",{template:'<div class="base-dialog-wrapper" v-transclude v-if="open">\n    <div class="base-dialog-container"\n        :style="widthStyle">\n        <!-- 引导弹框首部特殊处理 -->\n        <div class="base-guide-header" v-if="isguide">\n            <div class="base-guide-headerbtn" @click.stop="closeDialog">\n                <i class="dialog-lose icon icon-close"></i>\n            </div>\n        </div>\n        <div class="base-dialog-header" v-else>\n            <h3 class="base-dialog-title">{{title}}</h3>\n            <div class="base-dialog-headerbtn" @click.stop="closeDialog">\n                <i class="dialog-lose icon icon-close"></i>\n            </div>\n        </div>\n        <div :class="[isguide ? \'base-guide-body\' : \' base-dialog-body\']">\n            <slot name="body"></slot>\n        </div>\n        <div :class="[{\'base-dialog-footer-fixed\': footFixed}, \'base-dialog-footer\']" :style="footerStyle" v-if="footshow">\n            <slot name="footer"></slot>\n        </div>\n    </div>\n</div>',props:{title:{type:String,"default":""},position:{type:String,"default":"center"},open:{type:Boolean,"default":!1},width:{type:Number,"default":440},footeralign:{type:String,"default":"center"},footshow:{type:Boolean,"default":!0},footFixed:{type:Boolean,"default":!1},isguide:{type:Boolean,"default":!1}},data:function(){return{dialogWidth:0,dialogHeight:0,dialogStyle:{top:0,left:0,marginLeft:0,marginTop:0,width:0},footerStyle:{textAlign:this.footeralign}}},computed:{widthStyle:function(){return{width:this.width+"px"}}},methods:{closeDialog:function(){this.$emit("on-close-dialog")}}})}};a.initDialog(),o.exports=a.initDialog});
;define("pan-timeline:widget/components/system/Dialog/Dialog.js",function(t,n,e){var o=t("base:thirdParty/vue/vue.js"),i=t("base:thirdParty/vue/vuex.js"),a=i.mapGetters,l=(t("pan-timeline:widget/components/system/BaseDialog/BaseDialog.js"),o.component("pan-dialog",{name:"pan-dialog",template:'<base-dialog\n    :title="title"\n    :width="width"\n    :open="open"\n    :footFixed="footFixed"\n    :isguide="isguide"\n    @on-close-dialog="dialogClose(closeMethod)">\n    <!-- 自定义弹框 -->\n    <template v-if="type === \'window\'">\n        <div slot="body">\n            <slot name="body"></slot>\n        </div>\n        <div slot="footer">\n            <slot name="footer"></slot>\n        </div>\n    </template>\n    <!-- 确认弹框 -->\n    <template v-else>\n        <div slot="body">\n            <p v-html="content" class="alert-dialog-content-single"></p>\n        </div>\n        <div slot="footer">\n            <pan-button v-if="buttonConfirm"\n                :text="buttonConfirm[\'text\']" :color="\'blue\'" :size="buttonConfirm[\'size\']" @on-click="dialogConfirm(buttonConfirm[\'method\'])"></pan-button>\n            <pan-button v-if="buttonCancel"\n                :text="buttonCancel[\'text\']" :size="buttonCancel[\'size\']" @on-click="dialogCancel(buttonCancel[\'method\'])"></pan-button>\n        </div>\n    </template>\n</base-dialog>',props:{type:{type:String},title:{type:String},open:{type:Boolean,"default":!1},width:{type:Number,"default":440},footFixed:{type:Boolean,"default":!1},content:{type:String},closeMethod:{type:Function},buttonConfirm:{type:Object},buttonCancel:{type:Object}},data:function(){return{isguide:!1}},computed:o.util.extend({},a({dialog:"getDialog"})),methods:{dialogClose:function(t){return this.dialog.open=!1,"function"==typeof t?t():void 0},dialogConfirm:function(t){if(this.dialog.open=!1,"function"==typeof t){var n=this.buttonConfirm.params;return n&&n.length>0?t.apply(void 0,n):t()}},dialogCancel:function(t){return this.dialog.open=!1,"function"==typeof t?t():void 0}},updated:function(){}}));e.exports=l});
;define("pan-timeline:widget/components/setting/setting.js",function(t,n,i){"use strict";var e=t("base:thirdParty/vue/vue.js"),o=t("base:thirdParty/vue/vuex.js"),s=t("pan-timeline:widget/components/system/Dialog/Dialog.js"),a=t("pan-timeline:widget/components/system/Button/Button.js"),c=t("pan-timeline:widget/api/timeline/getlist.js"),l=t("system-core:context/context.js").instanceForSystem,g=o.mapGetters,p={init:function(){var t=e.component("setting",{name:"setting",template:'<div class="setting-box" :style="{right: paddingLarge ? \'146px\' : \'24px\'}">\n    <span class="icon icon-setting" @click.stop="toggleShow"></span>\n    <div class="setting-tip" v-if="isShow">\n        <div class="setting-item" @click="openSetDlg">{{switchStatus}}</div>\n        <div class="setting-item" @click="toHelp">分类说明</div>\n    </div>\n    <pan-dialog></pan-dialog>\n    <pan-dialog title="提示" :type="\'window\'" :open="setDlg" :closeMethod="closesetDlg">\n        <div slot="body" class="setdlg-body">\n            关闭后，图片的人物分类服务将无法使用，<br>已标记的人物名称和关系也将删除。\n        </div>\n        <div slot="footer">\n            <pan-button text="已了解并确认关闭" size="large" @on-click="changePrivateSwitch"></pan-button>\n            <pan-button text="再考虑一下" color="blue" size="large" @on-click="closesetDlg"></pan-button>\n        </div>\n    </pan-dialog>\n</div>',props:{paddingLarge:Boolean},data:function(){return{isShow:!1,setDlg:!1}},mounted:function(){var t=this;window.addEventListener("click",function(){t.isShow=!1})},components:{"pan-dialog":s,"pan-button":a},computed:e.util.extend(g({privateSwitch:"getPrivateSwitch"}),{switchStatus:function(){return this.privateSwitch?"开启智能分类人脸分组":"关闭智能分类人脸分组"}}),methods:{toggleShow:function(){this.isShow=!this.isShow},toHelp:function(){l.log.send({type:"web_album_human_to_help"});var t=window.location.protocol+"//"+window.location.host;window.open(t+"/disk/help#FAQ11")},closesetDlg:function(){this.setDlg=!1,l.log.send({type:"web_album_human_setting_know"})},changePrivateSwitch:function(){var t=this;this.setDlg=!1;var n=0===this.privateSwitch?1:0,i={type:n},e="服务器开小差了，稍后再试吧";0===n&&(e="正在开启，请稍后"),1===n&&(e="正在关闭，请稍后",l.log.send({type:"web_album_human_setting_confirm_off"})),this.tipShow("loading",e),c.setSwitchConfig(i).then(function(i){0===+i.errno?(e=0===n?"已开启人物分类":"已关闭人物分类",t.tipShow("success",e),setTimeout(function(){window.location.reload()},2e3)):t.tipShow("caution",e)}).catch(function(){t.tipShow("caution",e)})},openSetDlg:function(){var t="";0===this.privateSwitch?(this.setDlg=!0,t="web_album_human_setting_off"):(this.setDlg=this.changePrivateSwitch(),t="web_album_human_setting_on"),l.log.send({type:t})},tipShow:function(t,n){l.ui.tip({mode:t,msg:n})}}});return t}};i.exports=p.init()});
;define('pan-timeline:widget/components/picCategoryTab/picCategoryTab.js', function(require, exports, module){ /**
 * @file picCategoryTab.js
 * @author: yangyang55@baidu.com
 * @date:   2017-05-04
 * @Last Modified by:   lyuyexin@baidu.com
 * @Last Modified time: 2017-11-21
 */

'use strict';
var Vue = require('base:thirdParty/vue/vue.js');
var Vuex = require('base:thirdParty/vue/vuex.js');
var Button = require('pan-timeline:widget/components/system/Button/Button.js');
var context = require('system-core:context/context.js').instanceForSystem;
var store = require('pan-timeline:widget/store/index.js');
var axios = require('base:thirdParty/vue/axios.js');
var mapGetters = Vuex.mapGetters;
var yunData = window.yunData;

var pri = {
    init: function () {
        // store.registerModule('timeline', timeLineListStore);
        var picCategoryTab = Vue.component('picCategoryTab', {
            name: 'picCategoryTab',
            template: "<div class=\"module-timeline-tabs\">\n    <span class=\"buttons\" :class=\"{activeStyle: buttons[0].activeStyle}\">\n        <router-link :to=\"buttons[0].href\"\n            @click=\"forlog('timeline')\">{{buttons[0].text}}</router-link>\n    </span>\n    <span class=\"buttons classify-button\" :class=\"{activeStyle: buttons[1].activeStyle}\">\n        <router-link :to=\"buttons[1].href\"\n            @click=\"forlog('classify')\">{{buttons[1].text}}</router-link>\n    </span>\n    <span class=\"buttons\" :class=\"{activeStyle: buttons[2].activeStyle}\">\n        <router-link :to=\"buttons[2].href\"\n            @click=\"forlog('recentupload')\">{{buttons[2].text}}</router-link>\n    </span>\n    <span v-if=\"buttons[3].show() !== false\"\n        class=\"buttons\" :class=\"{activeStyle: buttons[3].activeStyle}\">\n        <a :href=\"buttons[3].href\"\n        target=\"_blank\"\n        @click=\"forlog('facesearch')\">\n        {{buttons[3].text}}\n        </a>\n    </span>\n    <div class=\"yike-entrance\">\n        <a :href=\"wpWebConf.url\" target=\"_blank\">{{wpWebConf.text}}</a>\n    </div>\n    <div class=\"mergeSimilar\" v-if=\"showMergeMode\">\n        <span node-type=\"timeline-checkbox\" class=\"timeline-checkbox\"\n        @click.stop=\"toggleMergeBtn()\">\n            <span class=\"icon icon-checksmall check-status\" v-if=\"mergeSimilar\"></span>\n        </span>\n        <span class=\"text\">合并相似图片</span>\n    </div>\n</div>\n",
            data: function () {
                var that = this;
                return {
                    buttons: [{
                        text: '时光轴',
                        href: '/timeline',
                        color: '#8e99b3',
                        background: 'none',
                        styleType: 'link',
                        activeStyle: false,
                        size: 'large',
                        active: false
                    },
                        {
                            text: '智能分类',
                            href: '/classify',
                            color: '#8e99b3',
                            background: 'none',
                            styleType: 'link',
                            active: false,
                            activeStyle: false,
                            size: 'large'
                        },
                        {
                            text: '最近上传',
                            href: '/recentupload',
                            color: '#8e99b3',
                            background: 'none',
                            styleType: 'link',
                            active: false,
                            activeStyle: false,
                            size: 'large'
                        },
                        {
                            text: '人脸搜索',
                            href: '/disk/facesearch',
                            color: '#8e99b3',
                            background: 'none',
                            styleType: 'link',
                            activeStyle: false,
                            active: false,
                            size: 'large',
                            show: function () {
                                return that.faceStatus;
                            }
                        }],
                    // 记录会员状态导致是否显示合并相似图片
                    showMergeStatus: false,
                    showMergeMode: false,
                    mergeSimilar: false,
                    wpWebConf: {}
                };
            },
            component: {
                'pan-button': Button
            },
            created: function () {
                // 是否显示“合并相似图片”，条件是有人脸搜索功能，并且符合会员条件
                var hasFaceStatus = this.faceStatus;
                this.showMergeStatus = hasFaceStatus && (yunData['ISVIP'] && +yunData['ISVIP'] === 1
                    && (!yunData['is_evip'] || +yunData['is_evip'] !== 1));
                this.showMergeMode = this.showMergeStatus && this.$route.name === 'timeline';
                var self = this;
                this.getWpWebText('wp_web_photo_header_text').then(function (res) {
                    try {
                        self.wpWebConf = res.data[0] && res.data[0].conf_value || {
                            text: '领永久无限空间',
                            url: 'https://photo.baidu.com/photo/web/home'
                        };
                    } catch (err) {
                        console.log(err);
                    }
                });
            },
            methods: {
                // 获取中台配置文字链
                getWpWebText(params) {
                    return axios.get('/act/api/conf', {
                        params: {
                            // eslint-disable-next-line
                            conf_key: 'wp_web_photo_header_text'
                        }
                    });
                },
                toggleMergeBtn: function () {
                    // 做频率控制
                    if (false) {
                        return;
                    }
                    this.mergeSimilar = !this.mergeSimilar;
                    store.dispatch('timeline/setGrouped', {
                        grouped: this.mergeSimilar
                    });
                },
                forlog: function (type) {
                    context.log.send({
                        type: 'web_album_' + type + '_tab_click',
                        value: '',
                        sendServerLog: true
                    });

                }
            },
            // getRouteType
            computed: Vue.util.extend({},
                mapGetters({
                    routeType: 'getRouteType',
                    listEmpty: 'getListEmpty',
                    isNewApi: 'getIsNewVersion',
                    faceStatus: 'getFaceSearch'
                })
            ),
            watch: {
                routeType: function (newval, oldval) {
                    if (newval !== oldval) {
                        var i = 0;
                        switch (this.routeType) {
                            case 'timeline':
                                i = 0;
                                break;
                            case 'classify':
                                i = 1;
                                break;
                            case 'connectionList':
                                i = 1;
                                break;
                            case 'positionList':
                                i = 1;
                                break;
                            case 'classifyList':
                                i = 1;
                                break;
                            case 'recentUpload':
                                i = 2;
                                break;
                            default:
                                i = 0;
                                break;
                        }
                        this.buttons[0].activeStyle = false;
                        this.buttons[1].activeStyle = false;
                        this.buttons[2].activeStyle = false;
                        this.buttons[3].activeStyle = false;
                        this.buttons[i].activeStyle = true;
                    }
                },
                listEmpty: function (newval, oldval) {
                    var listEmpty = newval;
                    if (listEmpty && listEmpty.show != null && listEmpty.show) {
                        if (this.showMergeStatus && this.$route.name === 'timeline' && this.listEmpty.show === false) {
                            this.showMergeMode = true;
                        } else {
                            this.showMergeMode = false;
                        }
                        this.$emit('on-merge-hide', this.showMergeMode);
                    }
                }
            },
            mounted: function () {
                console.log(1);
                var i = 0;
                switch (this.routeType) {
                    case 'timeline':
                        i = 0;
                        break;
                    case 'classify':
                        i = 1;
                        break;
                    case 'classifyList':
                        i = 1;
                        break;
                    case 'recentUpload':
                        i = 2;
                        break;
                    default:
                        i = 0;
                        break;
                }
                this.buttons[0].activeStyle = false;
                this.buttons[1].activeStyle = false;
                this.buttons[2].activeStyle = false;
                this.buttons[3].activeStyle = false;
                this.buttons[i].activeStyle = true;
            }
        });
        return picCategoryTab;
    }
};
module.exports = pri.init();
 
});
;define("pan-timeline:widget/components/topToolBar/topToolBar.js",function(e,t,n){"use strict";var o=e("base:thirdParty/vue/vue.js"),i=e("base:thirdParty/vue/vuex.js"),a=e("system-core:context/context.js").instanceForSystem,s=(e("pan-timeline:widget/components/operateBtn/operateBtn.js"),e("pan-timeline:widget/components/searchBox/searchBox.js")),r=e("pan-timeline:widget/components/goBack/goBack.js"),p=e("pan-timeline:widget/components/setting/setting.js");e("pan-timeline:widget/components/picCategoryTab/picCategoryTab.js");var c=a.message,g=window.yunData,l=i.mapGetters,u={uiil:{},init:function(){var e=o.component("topToolBar",{name:"topToolBar",template:'<div class="module-topToolBar">\n    <keep-alive>\n        <picCategoryTab v-if="categpryTabShow === \'categpryTab\'"\n            @on-merge-hide="setMergeBtnStatus"></picCategoryTab>\n        <operateBtn  v-if="listStatus === 2"\n            :type="type"></operateBtn>\n        <goBack v-if="categpryTabShow === \'goback\' && listStatus !== 2"></goBack>\n    </keep-alive>\n    <keep-alive>\n        <search-box\n            v-if="isNewApi && listStatus !== 2"\n            :paddingLarge="routeType === \'timeline\' && showMergeBtn"></search-box>\n    </keep-alive>\n    <keep-alive>\n        <setting\n            v-if="isNewApi && listStatus !== 2"\n            :paddingLarge="routeType === \'timeline\' && showMergeBtn"></setting>\n    </keep-alive>\n</div>\n',props:{type:String},data:function(){return{showMergeBtn:!1}},components:{goBack:r,"search-box":s,setting:p},computed:o.util.extend({categpryTabShow:function(){return"classifyList"===this.routeType||"faceList"===this.routeType||"connectionList"===this.routeType||"positionList"===this.routeType||"searchList"===this.routeType?"goback":"classify"===this.routeType||"emptyList"===this.routeType?"categpryTab":this.getChoosedItemArr.length>0?"operateBtn":"categpryTab"}},l({routeType:"getRouteType",getChoosedItemArr:"getChoosedItemArr",listStatus:"getListStatus",isNewApi:"getIsNewVersion"})),watch:{categpryTabShow:function(e,t){"operateBtn"!==e||"categpryTab"!==t||null==localStorage||localStorage.getItem(g.MYNAME+"_director_guide")||c.callPlugin("网盘按钮引导@com.baidu.pan")}},methods:{setMergeBtnStatus:function(e){null!=e&&(this.showMergeBtn=e)}}});return e}};n.exports=u.init()});
;define("pan-timeline:widget/components/connectionList/connectionList.js",function(t,e,i){"use strict";var n=t("base:widget/libs/jquerypacket.js"),a=t("base:thirdParty/vue/vue.js"),s=t("base:thirdParty/vue/vuex.js"),r=s.mapGetters,o=t("system-core:context/context.js").instanceForSystem,m=t("pan-timeline:widget/api/classify/getlist.js"),c=t("pan-timeline:widget/filters/index.js"),l=t("base:widget/libs/underscore.js");t("pan-timeline:widget/components/topToolBar/topToolBar.js"),t("pan-timeline:widget/components/emptyList/EmptyList.js");var h=window.yunData,d={dataSet:{isLoading:!1,limit:100,singleLineCount:0,integrity:{payload:{},isComplete:!0}},initData:function(){this.dataState=JSON.parse(JSON.stringify(d.dataSet))},init:function(){var t=a.component("connection-list",{name:"connection-list",template:'<div :class="[this.listType === 1 ? \'module-connection\' : \'module-connection-all\']" v-if="connectionListState[\'isShow\']"\n@scroll="scrollHandler($event)">\n    <p class="type-kind">人物</p>\n    <!-- 单行展示 -->\n    <ul class="connection" v-if="listType === 1">\n        <li class="item" v-for="(item, index) in renderconnectionList.formatList"\n        @click="changeDetail(item, index)"\n        :class="{\'image-err\': item && item.imgErr}">\n            <img v-if="item && item.formatSrc && !item.imgErr"\n            @load="imageFormat(item)"\n            @error="imageError(item)"\n            :src="item.formatSrc">\n            <div :class="{\'type-nameBg\': item.loaded && !judgeIE9, \'type-nameBg-ie\': item.loaded && judgeIE9}"></div>\n            <p class="type-name">{{item[\'name\']}}</p>\n        </li>\n        <li class="item" v-if="renderconnectionList.lastList.length === 1"\n        @click="showAllConnection"\n        :class="{\'image-err\': renderconnectionList.lastList[0] && renderconnectionList.lastList[0].imgErr}">\n            <img v-if="renderconnectionList.lastList[0] && renderconnectionList.lastList[0].formatSrc\n                 && !renderconnectionList.lastList[0].imgErr"\n            @error="imageError(renderconnectionList.lastList[0], $event)"\n            :src="renderconnectionList.lastList[0].formatSrc">\n            <div class="type-more"></div>\n            <p class="type-more-name">\n                <span class="type-more-text">查看更多</span>\n                <em class="type-more-icon icon icon-arrow-right"></em>\n            </p>\n        </li>\n    </ul>\n    <!-- 全部展示 -->\n    <ul class="connection" v-else>\n        <li class="item" v-for="(item, index) in connectionList"\n        @click="changeDetail(item, index)"\n        :key="item[\'cover_fs_id\']"\n        :class="{\'image-err\': item && item.imgErr}">\n            <img v-if="item && item.formatSrc && !item.imgErr"\n            :class="{\'image-err\': item && item.imgErr}"\n            @load="imageFormat(item)"\n            @error="imageError(item)"\n            :src="item.formatSrc">\n            <div :class="{\'type-nameBg\': item.loaded && !judgeIE9, \'type-nameBg-ie\': item.loaded && judgeIE9}"></div>\n            <p class="type-name">{{item[\'name\']}}</p>\n        </li>\n    </ul>\n</div>',data:function(){return{renderconnectionList:{formatList:[],lastList:[]},judgeIE9:document.all&&document.addEventListener&&!window.atob}},props:{listType:{type:Number,"default":2}},watch:{listType:function(t,e){var i=this;2!==e&&3!==e||1!==t||a.nextTick(function(){i.calculateList()})},connectionList:function(t,e){var i=this;e.length<=d.dataState.singleLineCount&&t.length>0&&(0===e.length&&this.$emit("on-classify-setLoading",{show:!1}),a.nextTick(function(){i.calculateList()}))},markedHumanData:function(t,e){(!this.connectionListState.firstGetData||this.connectionListState.permitWatchAction)&&this.firstScreenRender({isWatched:!0,list:{old:e,"new":t}})},markedHumanStoreComplete:function(t){t&&(this.connectionListState.firstGetData||this.fillInUnRemarkData(),d.dataState.integrity.isComplete||this.getMoreRemarkedData(d.dataState.integrity.payload))}},computed:a.util.extend({},r({tip:"getTip",listEmpty:"getListEmpty",markedHumanFlag:"getMarkedHumanFlag",markedHumanData:"getMarkedHumanData",markedHumanStoreComplete:"getMarkedHumanComplete",connectionListState:"getConnectionListState",connectionList:"getHumanNameData"})),created:function(){var t=this;d.initData(),this.connectionListState.firstGetData||(this.markedHumanData&&this.markedHumanData.length>0?this.firstScreenRender({isWatched:!1,list:this.markedHumanData}):this.markedHumanData&&0===this.markedHumanData.length&&(this.markedHumanFlag||this.$store.dispatch("classify/getMarkedHumanData"),setTimeout(function(){t.connectionListState.firstGetData||t.fillInUnRemarkData()},2e3))),this.resizeHandle()},methods:a.util.extend({errCb:function(t){this.$store.commit("setTip",{show:!0,msg:o.errorMsg(t),status:"caution",autoClose:!0,closeBtn:!0})},imageError:function(t){t&&a.set(t,"imgErr",!0)},imageFormat:function(t){t&&a.set(t,"loaded",!0)},changeDetail:function(t,e){var i=t.tag_id;this.$router.push({path:"/faceList/"+i}),o.log.send({type:"web_album_human_enterList"}),1===this.listType?o.log.send({type:"web_album_human_single_enterList"}):2===this.listType&&o.log.send({type:"web_album_human_all_enterList"}),o.log.send({type:"web_album_human_click_index",index:e+1,url:"//update.pan.baidu.com/statistics",clienttype:0,op:"webtimeline",op_from:"webtimelinehandle"})},showAllConnection:function(){this.$router.push({path:"/classify/faceAll"}),o.log.send({type:"web_album_human_cover_showAll"})},calculateList:function(){var t=this.connectionList.length,e=parseInt(n(".module-connection").width(),10);if(!isNaN(e)){var i=Math.floor(e/166);d.dataState.singleLineCount=i,i-1>=t?(this.renderconnectionList.formatList=this.connectionList,this.renderconnectionList.lastList=[]):(this.renderconnectionList.formatList=this.connectionList.slice(0,i-1),0===this.renderconnectionList.lastList.length?this.renderconnectionList.lastList.push(this.connectionList[i-1]):this.renderconnectionList.lastList.splice(0,1,this.connectionList[i-1]))}},resizeHandle:function(){var t=this;n(window).resize(function(){t.calculateList()})},firstScreenRender:function(t){var e=t.isWatched,i=e?t.list["new"]:t.list;l.isArray(i)&&i.length>0&&i.length<100?this.getRemarkedDirectRender(i):this.getMoreRemarkedData({params:{start:this.connectionListState.remarkedCount,limit:d.dataState.limit}}),this.$store.commit("setConnectionListState",{params:{firstGetData:!0}}),e&&this.$store.commit("setConnectionListState",{params:{permitWatchAction:!0}})},fillInUnRemarkData:function(){this.markedHumanData&&0===this.markedHumanData.length&&(this.getMoreUnRemarkData({params:{start:this.connectionListState.unRemarkStart,mark:0},errCb:this.errCb}),this.$store.commit("setConnectionListState",{params:{hasRemarkedMore:!1,firstGetData:!0}}))},getMoreRemarkedData:function(t){if(t&&t.params){var e=this.markedHumanData,i=t.params.start,n=t.params.limit,a=[];e&&e.length>0&&this.connectionListState.hasRemarkedMore&&(e.length-i>n?(a=e.slice(i,i+n),this.$store.commit("setConnectionListState",{params:{remarkedStart:i+n,hasRemarkedMore:!0}}),this.setMoreRemarkedData({list:a,show:!0})):this.markedHumanStoreComplete?(a=e.slice(i),0===i&&this.getMoreUnRemarkData({params:{start:this.connectionListState.unRemarkStart,mark:0},errCb:this.errCb}),this.$store.commit("setConnectionListState",{params:{remarkedStart:i+n,hasRemarkedMore:!1}}),this.setMoreRemarkedData({list:a,show:!0})):d.dataState.integrity={payload:t,isComplete:!1})}},getRemarkedDirectRender:function(t){var e=t.slice(this.connectionListState.remarkedCount),i=!0;this.setMoreRemarkedData({list:e,show:!0}),this.markedHumanStoreComplete&&(i=!1,this.getMoreUnRemarkData({params:{start:this.connectionListState.unRemarkStart,mark:0},errCb:this.errCb})),this.$store.commit("setConnectionListState",{params:{remarkedStart:this.connectionListState.remarkStart+e.length,hasRemarkedMore:i}})},setMoreRemarkedData:function(t){var e=!1,i={myself:{},others:{}};if(t&&t.list&&0!==t.list.length)if(t.list.forEach(function(t){c.getImageFromDB(t)}),t.list[0]&&t.list[0].uk===h.MYUK&&(e=!0),e){i.myself[t.list[0].tag_id]=0;for(var n=1;n<t.list.length;n++)i.others[t.list[n].tag_id]=n}else for(var n=0;n<t.list.length;n++)i.others[t.list[n].tag_id]=n+this.connectionListState.remarkedCount;this.$store.commit("setConnectionListState",{params:{remarkedCount:this.connectionListState.remarkedCount+t.list.length,isShow:t.show}}),this.$store.commit("setHumanDataMap",{params:i}),this.$store.commit("setHumanNameData",{params:t.list})},getMoreUnRemarkData:function(t){var e=this,i=t.params.start,n=d.dataState.limit,a=function(a){a&&0===a.errno?(d.dataState.isLoading=!1,e.$store.commit("setConnectionListState",{params:{unRemarkStart:i+n,hasUnRemarkMore:a.has_more}}),a.list&&a.list.length>0?e.setMoreUnRemarkData({list:a.list,show:!0}):0===e.connectionList&&0===i&&0===a.list.length&&e.$emit("on-list-human-show")):t.errCb(a.errno)};d.dataState.isLoading||(d.dataState.isLoading=!0,m.getLabelUsers(t.params).then(a).catch(function(){t.errCb()}))},setMoreUnRemarkData:function(t){var e={myself:{},others:{}};if(t&&t.list&&0!==t.list.length){t.list.forEach(function(t){c.getImageFromDB(t)});for(var i=0;i<t.list.length;i++)e.others[t.list[i].tag_id]=i+this.connectionListState.remarkedCount+this.connectionListState.unRemarkCount}this.$store.commit("setConnectionListState",{params:{unRemarkCount:this.connectionListState.unRemarkCount+t.list.length,isShow:t.show}}),this.$store.commit("setHumanDataMap",{params:e}),this.$store.commit("setHumanNameData",{params:t.list})},getMoreInfo:function(){this.connectionListState.hasRemarkedMore?this.getMoreRemarkedData({params:{start:this.connectionListState.remarkedStart,limit:d.dataState.limit}}):this.connectionListState.hasUnRemarkMore&&this.getMoreUnRemarkData({params:{start:this.connectionListState.unRemarkStart,mark:0},errCb:this.errCb})},getScrollPercent:function(t){var e=t.height(),i=Math.max(t[0].scrollHeight,e),n=t.scrollTop(),a=n/(i-e);return a},scrollHandler:function(t){var e=this;l.throttle(function(){e.getScrollPercent(n(t.target))>.7&&e.getMoreInfo()},200)()}})});return t}};i.exports=d.init()});
;define("pan-timeline:widget/system/errorMsg/errorMsg.js",function(e){var a=e("system-core:context/context.js").instanceForSystem,r={0:"成功","-1":"用户名和密码验证失败","-2":"备用","-3":"用户未激活（调用init接口）","-4":"COOKIE中未找到host_key&user_key（或BDUSS）","-5":"host_key和user_key无效","-6":"登录失败，请重新登录","-7":"文件或目录名错误或无权访问","-8":"该目录下已存在此文件","-9":"文件被所有者删除，操作失败","-10":"你的空间不足了哟","-11":"父目录不存在","-12":"设备尚未注册","-13":"设备已经被绑定","-14":"帐号已经初始化","-21":"预置文件无法进行相关操作","-22":"被分享的文件无法重命名，移动等操作","-23":"数据库操作失败，请联系netdisk管理员","-24":"要取消的文件列表中含有不允许取消public的文件。","-25":"非公测用户","-26":"邀请码失效","-102":"云冲印文件7日内无法删除",1:"哎呀，服务器开小差啦",2:"接口请求错误，请稍候重试",3:"一次操作文件不可超过100个",4:"新文件名错误",5:"目标目录非法",6:"备用",7:"NS非法或无权访问",8:"ID非法或无权访问",9:"申请key失败",10:"创建文件的superfile失败",11:"user_id(或user_name)非法或不存在",12:"部分文件已存在于目标文件夹中",13:"此目录无法共享",14:"系统错误",15:"操作失败",102:"无权限操作该目录",103:"提取码错误",104:"验证cookie无效",121:"网盘文件过多，请删至500万个以内再试",131:"无权使用超级会员特权",132:"删除文件需要验证您的身份",201:"系统错误",202:"系统错误",203:"系统错误",204:"系统错误",205:"系统错误",301:"其他请求出错",501:"获取的LIST格式非法",618:"请求curl返回失败",619:"pcs返回错误码",600:"json解析出错",601:"exception抛出异常",617:"getFilelist其他错误",211:"无权操作或被封禁",404:"秒传md5不匹配 rapidupload 错误码",406:"秒传创建文件失败 rapidupload 错误码",407:"fileModify接口返回错误，未返回requestid rapidupload 错误码",1024:"云冲印购物车文件15日内无法删除",31080:"我们的服务器出错了，稍候试试吧",31021:"网络连接失败，请检查网络或稍候再试",31075:"一次支持操作999个，减点试试吧",31034:"操作过于频繁，请稍后再试",31023:"垃圾文件扫描参数错误",31160:"任务不存在",31161:"垃圾文件扫描任务还未结束",31162:"垃圾文件扫描任务执行失败",31163:"服务器开小差了",7001:"超过最大扫描次数",31116:'你的空间不足了哟，赶紧<a href="//yun.baidu.com/buy/center?tag=2&from=multi-file">购买空间</a>吧',31171:"你有未完成的任务还没有完成，稍后试试吧",112:'页面已过期，请<a href="javascript:window.location.reload();"">刷新</a>后重试',111:"当前还有未完成的任务，需完成后才能操作","-32":"你的空间不足了哟",9000:"请不要申诉正常文件！",9001:"服务器开小差，请稍后重试",9002:"申诉频率太快，请稍后再试",9100:'你的帐号存在违规行为，已被冻结，<a href="/disk/appeal" target="_blank">查看详情</a>',9200:'你的帐号存在违规行为，已被冻结，<a href="/disk/appeal" target="_blank">查看详情</a>',9300:'你的帐号存在违规行为，该功能暂被冻结，<a href="/disk/appeal" target="_blank">查看详情</a>',9400:'你的帐号异常，需验证后才能使用该功能，<a href="/disk/appeal" target="_blank">立即验证</a>',9500:'你的帐号存在安全风险，已进入保护模式，请修改密码后使用，<a href="/disk/appeal" target="_blank">查看详情</a>',10000:"相同人物已存在",10001:"哎呀，服务器开小差啦",10002:"照片合并失败，请稍后再试吧",10004:"服务器开小差，部分操作失败，请稍后再试吧",10005:"服务器开小差，操作失败，请稍后再试吧",10006:"最多可同时移出20张图片，请减少数量后再试哦"};a.extend({errorMsg:function(e,a){return r[e]||a||(null==e?"服务器开小差了，晚点再试下吧":"未知错误["+e+"]")}})});
;define("pan-timeline:widget/store/modules/classify/index.js",function(a,t,i){"use strict";var s=a("base:thirdParty/vue/vue.js"),e=window.yunData||{},n=a("pan-timeline:widget/system/util/util.js"),r=a("pan-timeline:widget/api/classify/getlist.js"),e=(a("base:widget/tools/service/tools.util.js"),window.yunData),o=[{tag_name:"单人",tag_id:257,type:1},{tag_name:"双人",tag_id:258,is_show:1,type:1},{tag_name:"三人",tag_id:259,is_show:1,type:1},{tag_name:"多人",tag_id:260,is_show:1,type:1},{tag_name:"食物",tag_id:1792,is_show:1,type:1},{tag_name:"动物",tag_id:512,type:1},{tag_name:"植物",tag_id:768,is_show:1,type:1},{tag_name:"风景",tag_id:1024,is_show:1,type:1},{tag_name:"建筑",tag_id:1282,is_show:1,type:1},{tag_name:"室内",tag_id:1281,is_show:1,type:1},{tag_name:"交通工具",tag_id:1536,is_show:1,type:1},{tag_name:"截屏",tag_id:2304,is_show:1,type:1},{tag_name:"其他",tag_id:2048,is_show:1,type:1}],m={initDataFlag:!1,initMarkedHumanFlag:!1,clusterType:"单人",loading:!0,affairlists:null,positionlists:null,formatAffairLists:null,formatPositionLists:null,firstGetAffairData:!1,firstGetPositionData:!1,humanDataMap:{myself:{},others:{}},humanNameData:[],markedHumanData:{start:0,list:[],hasMore:!0,isLoading:!1},connectionListState:{remarkedCount:0,remarkedStart:0,hasRemarkedMore:!0,unRemarkCount:0,unRemarkStart:0,hasUnRemarkMore:!0,firstGetData:!1,permitWatchAction:!1,isShow:!1}},f={getHumanDataMap:function(a){return a.humanDataMap},getHumanNameData:function(a){return a.humanNameData},getConnectionListState:function(a){return a.connectionListState},getAffairlists:function(a){return a.affairlists},getPositionlists:function(a){return a.positionlists},getFormatAffairlists:function(a){return a.formatAffairLists},getFormatPositionlists:function(a){return a.formatPositionLists},getFirstGetAffairData:function(a){return a.firstGetAffairData},getFirstGetPositionData:function(a){return a.firstGetPositionData},getDataFlag:function(a){return a.initDataFlag},getLoading:function(a){return a.loading},getMarkedHumanFlag:function(a){return a.initMarkedHumanFlag},getMarkedHumanData:function(a){return a.markedHumanData&&a.markedHumanData.list?a.markedHumanData.list:[]},getMarkedHumanComplete:function(a){if(a.markedHumanData&&"hasMore"in a.markedHumanData){var t=a.markedHumanData.hasMore===!1?!0:!1;return t}return!1}},u={setHumanDataMap:function(a,t){if(t&&t.params)for(var i in t.params)t.params.hasOwnProperty(i)&&s.util.extend(a.humanDataMap[i],t.params[i])},updateHumanDataMap:function(a,t){t&&t.list&&(a.humanDataMap.myself={},a.humanDataMap.others={},t.list.forEach(t.hasMyself?function(t,i){t.uk===e.MYUK?a.humanDataMap.myself[t.tag_id]=i:a.humanDataMap.others[t.tag_id]=i}:function(t,i){a.humanDataMap.others[t.tag_id]=i}))},setHumanNameData:function(a,t){t&&t.params&&(a.humanNameData=a.humanNameData.concat(t.params))},deleteHumanNameData:function(a,t){if(a.humanNameData.length>0&&t&&t.params){var i=a.humanDataMap.others[t.params.merged_person_id];a.humanNameData.splice(i,1)}},modifyHumanNameData:function(a,t){if(a.humanNameData.length>0&&t&&t.params){var i=t.params.person_id,s=t.params.name,e=t.params.relation,n=t.params.person_uk,r=t.params.fs_id,o=t.params.cover_photo,m=void 0===a.humanDataMap.myself[i]?a.humanDataMap.others[i]:a.humanDataMap.myself[i];s&&(a.humanNameData[m].name=s),e&&(a.humanNameData[m].relation=e),(n||""===n)&&(a.humanNameData[m].uk=""!==n?parseInt(n,10):null),r&&(a.humanNameData[m].cover_fs_id=r),o&&(a.humanNameData[m].cover_photo=o,a.humanNameData[m].formatSrc=o)}},setConnectionListState:function(a,t){if(t&&t.params){var i=t.params.remarkedCount,s=t.params.remarkedStart,e=t.params.hasRemarkedMore,n=t.params.unRemarkCount,r=t.params.unRemarkStart,o=t.params.hasUnRemarkMore,m=t.params.permitWatchAction,f=t.params.firstGetData,u=t.params.isShow,l=a.connectionListState;void 0!==i&&(l.remarkedCount=i),void 0!==s&&(l.remarkedStart=s),void 0!==e&&(l.hasRemarkedMore=e),void 0!==n&&(l.unRemarkCount=n),void 0!==r&&(l.unRemarkStart=r),void 0!==o&&(l.hasUnRemarkMore=o),void 0!==m&&(l.permitWatchAction=m),void 0!==f&&(l.firstGetData=f),void 0!==u&&(l.isShow=u)}},"classify/setLoading":function(a,t){a.loading=t.show},"classify/setDataFlag":function(a,t){null!=t.initDataFlag&&(a.initDataFlag=t.initDataFlag)},"classify/setAffairData":function(a,t){t&&(null!=t.index&&t.thumb&&null!=a.affairlists[t.index]?a.affairlists[t.index].thumb=t.thumb:null!=t.data&&(a.affairlists=t.data))},"classify/setPositionData":function(a,t){t&&null!=t.data&&(a.positionlists=t.data)},"classify/setFormatAffairData":function(a,t){t&&null!=t.data&&(a.formatAffairLists=t.data)},"classify/setFormatPositionData":function(a,t){t&&null!=t.data&&(a.formatPositionLists=t.data)},setFirstGetAffairData:function(a,t){t&&t.params&&(a.firstGetAffairData=t.params.firstGetData)},setFirstGetPositionData:function(a,t){t&&t.params&&(a.firstGetPositionData=t.params.firstGetData)},"classify/setMarkedHumanFlag":function(a,t){t&&null!=t.initMarkedHumanFlag&&(a.initMarkedHumanFlag=t.initMarkedHumanFlag)},"classify/setMarkedHumanList":function(a,t){if(t){var i=a.markedHumanData;if(t.list){var s=i.list||[],e=t.start||i.start,n=t.limit||100;t.list.length>0&&(i.list=s.concat(t.list),t.hasMore?(i.start=e+n,i.hasMore=t.hasMore):i.hasMore=!1)}null!=t.isLoading&&(i.isLoading=t.isLoading)}}},l={"classify/searchClassifyThumb":function(a,t){{var i=(a.state,a.rootState),s=a.commit;a.dispatch}if(t){var e=(t.index,function(a){a?0===a.errno?a.list&&a.list.length>0&&s("classify/set"+t.name+"Data",{index:t.index,thumb:a.list[0].thumb}):"function"==typeof t.errCb&&t.errCb(a.errno):"function"==typeof t.errCb&&t.errCb()});r.getCluster({start:0,limit:1,search_type:2,keyword:t.tag_id,isNewApi:i.isNewVersion}).then(e).catch(function(){"function"==typeof t.errCb&&t.errCb()})}},"classify/formatClassifyThumb":function(a,t){var i=(a.state,a.commit,a.dispatch);t&&null!=t.data&&null!=t.name&&t.data.forEach(function(a,s){a.thumb||i("classify/searchClassifyThumb",{index:s,name:t.name,tagId:a.tag_id})})},"classify/getTagList":function(a,t){if(null!=t){var i=(a.state,a.commit),s=a.dispatch,e=function(a){if(a)if(0===a.errno){if(a.list&&a.list.length>0){var e="Affair";2===t.params.type&&(e="Position"),i("classify/set"+e+"Data",{name:e,data:a.list}),s("classify/formatData",{name:e,data:a.list}),a.has_more?s("classify/getTagList",{params:{key:"tag",type:t.params.type,start:t.params.start+t.params.limit},succCb:t.succCb}):"function"==typeof t.succCb&&t.succCb(a.list)}}else"function"==typeof t.errCb&&t.errCb(a.errno);else"function"==typeof t.errCb&&t.errCb()};r.getClassifyResult(t.params).then(e).catch(function(){"function"==typeof t.errCb&&t.errCb(data.errno)})}},"classify/formatData":function(a,t){if(null!=t&&t.name&&t.data){for(var i=(a.state,a.commit),s=(a.dispatch,t.data),e={},n=0;n<s.length;n++)e[s[n].tag_id]=s[n];i("classify/setFormat"+t.name+"Data",{data:e})}},"classify/getClassifyData":function(a){var t=a.state,i=a.rootState,s=a.commit,r=a.dispatch,m=i.isNewVersion;if(!t.initDataFlag){s("classify/setDataFlag",{initDataFlag:!0});var f=[{type:1,name:"Affair",storeKey:"affairTags"}];m&&f.push({type:2,name:"Position",storeKey:"positionTags"});for(var u=0;u<f.length;u++){var l=f[u];!function(a){var t=a.storeKey+"_"+e.MYUK;n.getFromLocal({storeKey:t,getDataFromLocal:function(t){var i=JSON.parse(t);s("classify/set"+a.name+"Data",{data:i}),r("classify/formatData",{name:a.name,data:i})},getDataFromServer:function(){if(m)r("classify/getTagList",{params:{key:"tag",type:a.type,start:0},succCb:function(a){if(null!=localStorage){var i=+new Date,s=JSON.stringify(a);localStorage.setItem(t,i+"@@"+s)}}});else{var i=o;s("classify/set"+a.name+"Data",{data:i}),r("classify/formatData",{name:a.name,data:i})}}})}(l)}}},"classify/getMarkedHumanData":function(a,t){var i=a.state,s=a.commit,e=a.dispatch;if(!i.initMarkedHumanFlag||t&&t.loadMore){s("classify/setMarkedHumanFlag",{initMarkedHumanFlag:!0});var n=i.markedHumanData,o=n.start,m=function(){s("classify/setMarkedHumanList",{isLoading:!1})},f=function(a){s("classify/setMarkedHumanList",{isLoading:!1}),a&&0===a.errno&&(a.list&&a.list.length>0&&s("classify/setMarkedHumanList",{list:a.list,hasMore:a.has_more}),a.has_more&&e("classify/getMarkedHumanData",{loadMore:!0}))};n.hasMore&&!n.isLoading&&(s("classify/setMarkedHumanList",{isLoading:!0}),r.getLabelUsers({start:o,mark:1}).then(function(a){f(a)}).catch(function(a){m(a)}))}}};i.exports={state:m,getters:f,mutations:u,actions:l}});
;define("pan-timeline:widget/components/positionList/positionList.js",function(t,i,s){"use strict";var e=t("base:widget/libs/jquerypacket.js"),n=t("base:thirdParty/vue/vue.js"),o=t("base:thirdParty/vue/vuex.js"),a=o.mapGetters,r=(o.mapActions,t("pan-timeline:widget/system/errorMsg/errorMsg.js"),t("system-core:context/context.js").instanceForSystem),l=(t("pan-timeline:widget/store/index.js"),t("pan-timeline:widget/components/topToolBar/topToolBar.js"),t("pan-timeline:widget/store/modules/classify/index.js"),t("pan-timeline:widget/api/classify/getlist.js")),m=(t("pan-timeline:widget/components/emptyList/EmptyList.js"),t("pan-timeline:widget/filters/index.js")),c={dataSet:{singleLineCount:0},initData:function(){this.dataState=JSON.parse(JSON.stringify(c.dataSet))},init:function(){var t=n.component("position-list",{name:"position-list",template:'<div :class="[this.listType === 1 ? \'module-position\' : \'module-position-all\']" v-if="positionlists[\'show\']">\n    <p class="type-kind">地点</p>\n    <!-- 单行展示 -->\n    <ul class="position" v-if="listType === 1">\n        <!-- 前(N - 1)个 -->\n        <li v-for="(item, index) in renderpositionList.formatList"\n        :class="[{\'image-err\': item && item.imgErr}, \'item\']"\n        @click="changeDetail(item, index)">\n            <div v-if="item && !item.imgErr"\n            class="item-content"               \n            :style="{\n            backgroundImage: item.loaded && item.formatThumb ? \'url(\' + item.formatThumb + \')\' : \'none\', opacity: item.loaded ? 1 : 0}"></div>\n            <img class="cover-img" v-if="!item.loaded && !item.imgErr"\n            :src="imageSrcFormat(item)"\n            @load="imageFormat(item)"\n            @error="imageError(item)">\n            <div :class="{\'type-nameBg\': item.loaded && !judgeIE9, \'type-nameBg-ie\': item.loaded && judgeIE9}"></div>\n            <p class="type-name">{{item[\'tag_name\']}}</p>\n        </li>\n        <!-- 最末一个 -->\n        <li class="item" v-if="renderpositionList.lastList.length === 1"\n        :class="[{\'image-err\': renderpositionList.lastList[0] && renderpositionList.lastList[0].imgErr}, \'item\']"\n        @click="showAllPosition">\n            <div v-if="renderpositionList.lastList[0] && !renderpositionList.lastList[0].imgErr"\n            class="item-content"               \n            :style="{\n            backgroundImage: renderpositionList.lastList[0].loaded && renderpositionList.lastList[0].formatThumb ? \'url(\' + renderpositionList.lastList[0].formatThumb + \')\' : \'none\', opacity: renderpositionList.lastList[0].loaded ? 1 : 0}"></div>\n            <img class="cover-img" v-if="!renderpositionList.lastList[0].loaded && !renderpositionList.lastList[0].imgErr"\n            :src="imageSrcFormat(renderpositionList.lastList[0])"\n            @load="imageFormat(renderpositionList.lastList[0])"\n            @error="imageError(renderpositionList.lastList[0])">\n            <div class="type-more"></div>\n            <p class="type-more-name">\n                <span class="type-more-text">查看更多</span>\n                <em class="type-more-icon icon icon-arrow-right"></em>\n            </p>\n        </li>\n    </ul>\n    <!-- 全部展示 -->\n    <ul class="position" v-else>\n        <li class="item" v-for="(item, index) in positionlists.list"\n        :class="[{\'image-err\': item && item.imgErr}, \'item\']"\n        @click="changeDetail(item, index)">\n            <div v-if="item && !item.imgErr"\n            class="item-content"               \n            :style="{\n            backgroundImage: item.loaded && item.formatThumb ? \'url(\' + item.formatThumb + \')\' : \'none\', opacity: item.loaded ? 1 : 0}"></div>\n            <img class="cover-img" v-if="!item.loaded && !item.imgErr"\n            :src="imageSrcFormat(item)"\n            @load="imageFormat(item)"\n            @error="imageError(item)">\n            <div :class="{\'type-nameBg\': item.loaded && !judgeIE9, \'type-nameBg-ie\': item.loaded && judgeIE9}"></div>\n            <p class="type-name">{{item[\'tag_name\']}}</p>\n        </li>\n    </ul>\n</div>',data:function(){return{positionlists:{show:!1,list:[]},renderpositionList:{formatList:[],lastList:[]},judgeIE9:document.all&&document.addEventListener&&!window.atob}},props:{listType:{type:Number,"default":3}},watch:{listType:function(t,i){var s=this;2!==i&&3!==i||1!==t||n.nextTick(function(){s.calculateList()})},positionlists:{handler:function(t,i){var s=this,e=i.list,o=t.list;e.length<=c.dataState.singleLineCount&&o.length>0&&(0===e.length&&(this.$emit("on-classify-setLoading",{show:!1}),this.handleDataFromStore(),this.updateDataLock()),n.nextTick(function(){s.calculateList()}))},deep:!0}},computed:n.util.extend({},a({tip:"getTip",listEmpty:"getListEmpty",positionData:"getPositionlists",firstGetPositionData:"getFirstGetPositionData"})),created:function(){var t=this;c.initData(),this.firstGetPositionData||(this.positionData&&this.positionData.length>0?(this.handleDataFromStore(),this.updateDataLock()):(this.$store.dispatch("classify/getTagList",{params:{key:"tag",type:2}}),setTimeout(function(){this.positionData&&0===this.positionData.length&&!this.firstGetPositionData&&(t.getClassifyResult({params:{key:"tag",type:2},succCb:t.getAllCluster,errCb:t.errCb}),t.updateDataLock())},2e3)))},methods:n.util.extend({imageError:function(t){t&&n.set(t,"imgErr",!0)},imageFormat:function(t){t&&n.set(t,"loaded",!0)},imageSrcFormat:function(t){if(t&&t.thumb){var i=t.thumb,s=m.imageFormat312({value:i});return n.set(t,"formatThumb",s),s}return""},errCb:function(t){this.$store.commit("setTip",{show:!0,msg:r.errorMsg(t),status:"caution",autoClose:!0,closeBtn:!0})},changeDetail:function(t,i){var s=t.tag_id;this.$router.push({name:"classifyList",params:{classifyType:2,clusterType:s}}),r.log.send({type:"web_album_position_enterList"}),r.log.send({type:"web_album_"+s+"_position_click"}),1===this.listType?r.log.send({type:"web_album_position_single_enterList"}):3===this.listType&&r.log.send({type:"web_album_position_all_enterList"}),r.log.send({type:"web_album_position_click_index",index:i+1,url:"//update.pan.baidu.com/statistics",clienttype:0,op:"webtimeline",op_from:"webtimelinehandle"})},showAllPosition:function(){this.$router.push({path:"/classify/positionAll"}),r.log.send({type:"web_album_position_cover_showAll"})},getClassifyResult:function(t){var i=this,s=function(s){if(s)if(s&&0===s.errno)if(s.list&&s.list.length>0){var e=s.list.filter(function(t){return 1===t.is_show});i.setPositionTag({list:e}),t.succCb(),i.resizeHandle(),n.nextTick(function(){i.calculateList()})}else i.$emit("on-list-position-show");else t&&t.errCb&&t.errCb(s.errno);else t&&t.errCb&&t.errCb()};l.getClassifyResult(t.params).then(s).catch(function(){t&&t.errCb&&t.errCb()})},updateDataLock:function(){this.$store.commit("setFirstGetPositionData",{params:{firstGetData:!0}})},handleDataFromStore:function(){var t=this,i=this.positionData.filter(function(t){return 1===t.is_show});i&&i.length>0&&(this.setPositionTag({list:i}),this.getAllCluster(),this.resizeHandle(),n.nextTick(function(){t.calculateList()}))},setPositionTag:function(t){if(t&&t.list){var i=t.list;i.sort(function(t,i){return i.count-t.count}),i.forEach(function(t){this.positionlists.list.push(t)},this)}},getAllCluster:function(){this.positionlists.list.forEach(function(t,i){t.thumb?this.positionlists.show||(this.positionlists.show=!0):this.getPositionData({params:{start:0,search_type:1,keyword:t.tag_id},index:i,errCb:this.errCb})},this)},getFirst:function(t){var i=[],s={};if(t){for(var e=t.length,n=0;e>n;n++)if(t[n].day&&t[n].month&&t[n].year){var o=t[n].year+t[n].month+t[n].day;i.push(o),s[o]?s[o].push(t[n]):(s[o]=[],s[o].push(t[n]))}var a=i.sort(function(t,i){return isNaN(+t)?!0:i-t});return s[a[0]]&&s[a[0]][0]}return s},getPositionData:function(t){var i=this,s=t.index,e=function(n){if(n)if(0===n.errno){if(n.list&&n.list.length>0)return void i.setPositionData({list:i.getFirst(n.list),index:s});i.positionlists.list.splice(s,1),n.has_more===!0&&(t.params.start+=10,l.getLocation(t.params).then(e).catch(function(){t&&t.errCb&&t.errCb()}))}else t.errCb(n.errno);else t&&t.errCb&&t.errCb()};l.getLocation(t.params).then(e).catch(function(){t&&t.errCb&&t.errCb()})},setPositionData:function(t){var i=t.index,s=t.list;"{}"!==JSON.stringify(s)&&this.positionlists.list[i]&&(n.set(this.positionlists.list[i],"thumb",s.thumb),this.positionlists.list[i].imgErr&&n.set(this.positionlists.list[i],"imgErr",!1)),this.positionlists.show||n.set(this.positionlists,"show",t.show)},calculateList:function(){var t=this.positionlists.list,i=t.length,s=parseInt(e(".module-position").width(),10);if(!isNaN(s)){var n=Math.floor(s/166);c.dataState.singleLineCount=n,n-1>=i?(this.renderpositionList.formatList=t,this.renderpositionList.lastList=[]):(this.renderpositionList.formatList=t.slice(0,n-1),0===this.renderpositionList.lastList.length?this.renderpositionList.lastList.push(t[n-1]):this.renderpositionList.lastList.splice(0,1,t[n-1]))}},resizeHandle:function(){var t=this;e(window).resize(function(){t.calculateList()})}})});return t}};s.exports=c.init()});
;define("pan-timeline:widget/components/system/list/listEmpty/listEmpty.js",function(t,e,n){"use strict";var i=t("base:thirdParty/vue/vue.js"),s={init:function(){var t=i.component("list-empty",{name:"listEmpty",template:'<div v-if="show"\n    class="module-list-empty-container">\n    <div class="module-list-empty">\n        <component :is="listEmptyComponent"\n            :emptyDesc="emptyDesc" keep-alive></component>\n    </div>\n</div>',props:{show:{type:Boolean,"default":!0},listEmptyComponent:Function,emptyDesc:String}});return t}};n.exports=s.init()});
;define("pan-timeline:widget/components/classify/classify.js",function(t,i,e){"use strict";var s=t("base:thirdParty/vue/vue.js"),n=t("base:thirdParty/vue/vuex.js"),a=t("system-core:context/context.js").instanceForSystem,o=t("pan-timeline:widget/components/topToolBar/topToolBar.js"),r=t("pan-timeline:widget/components/connectionList/connectionList.js"),l=(t("pan-timeline:widget/components/positionList/positionList.js"),t("pan-timeline:widget/components/emptyList/EmptyList.js")),c=t("pan-timeline:widget/api/classify/getlist.js"),h=t("pan-timeline:widget/filters/index.js"),m=t("pan-timeline:widget/system/util/util.js");t("pan-timeline:widget/components/system/list/listEmpty/listEmpty.js");var p=n.mapGetters,u=n.mapActions,f=window.yunData,g={checkClassifyEmpty:0,showTipLine:function(){var t=this,i=f.MYUK,e="applyClassify_"+i,s=function(){t.$store.commit("setTipLineObj",{tipContent:null}),null!=localStorage&&localStorage.setItem(e,1)},n=function(){setTimeout(function(){s.call(t)},3e3)},o=function(i){if("showEntrance"===i){i=0;var e=function(t){t&&0===t.errno?l():t&&10013===t.errno&&s()},a=function(){}}else{i=1;var e=function(i){i?0===i.errno?(t.$store.commit("setTip",{show:!0,msg:"申请成功，预计1-3天后可体验",status:"success",autoClose:!0}),n()):10013===+i.errno?(a.call(t,i),n()):a.call(t,i):a.call(t,i)},a=function(i){var e=i&&i.errmsg||"服务器开小差了，晚点再试下吧";t.$store.commit("setTip",{show:!0,msg:e,status:"caution",autoClose:!0})}}c.applyClassify({type:i}).then(e).catch(a)},r=function(){t.$store.commit("setGuide",{width:540,guideImgStyle:{width:"450px",height:"300px",marginTop:"-20px",background:'url("/static/pan-timeline/widget/components/classify/image/classify-demo_nomd5.png") center center no-repeat'},buttonText:"申请体验",closeMethod:function(){a.log.send({type:"web_album_close_apply_experience_dialog"})},enterMethod:function(){o(),a.log.send({type:"web_album_apply_to_experience"})}})},r=function(){t.$store.commit("setGuide",{width:540,guideImgStyle:{width:"450px",height:"300px",marginTop:"-20px",background:'url("/static/pan-timeline/widget/components/classify/image/classify-demo_nomd5.png") center center no-repeat'},buttonText:"申请体验",closeMethod:function(){a.log.send({type:"web_album_close_apply_experience_dialog"})},enterMethod:function(){o(),a.log.send({type:"web_album_apply_to_experience"})}})},l=function(){t.$store.commit("setTipLineObj",{btnDesc:"了解详情",tipContent:"新增人物分类，查找人物更方便，邀你体验！",btnClick:function(){r.call(t),a.log.send({type:"web_album_click_know_details"})},closeClick:function(){s.call(t),a.log.send({type:"web_album_close_apply_experience_tip"})}}),a.log.send({type:"web_album_show_apply_tip"})};m.getFromLocal({storeKey:e,expireTime:!1,getDataFromServer:function(){!t.isNewApi&&o("showEntrance")}})},init:function(){var t=[{chineseName:"单人",show:!1,cluster:257,list:[]},{chineseName:"双人",show:!1,cluster:258,list:[]},{chineseName:"三人",show:!1,cluster:259,list:[]},{chineseName:"多人",show:!1,cluster:260,list:[]},{chineseName:"食物",show:!1,cluster:1792,list:[]},{chineseName:"动物",show:!1,cluster:512,list:[]},{chineseName:"植物",show:!1,cluster:768,list:[]},{chineseName:"风景",show:!1,cluster:1024,list:[]},{chineseName:"建筑",show:!1,cluster:1282,list:[]},{chineseName:"室内",show:!1,cluster:1281,list:[]},{chineseName:"交通工具",show:!1,cluster:1536,list:[]},{chineseName:"截屏",show:!1,cluster:2304,list:[]},{chineseName:"其他",show:!1,cluster:2048,list:[]}],i="该分类下没有图片",e=s.component("classify",{name:"classify",template:'<div class="module-classify">\n    <topToolBar></topToolBar>\n    <!-- loading效果 -->\n    <list-loading :show="loading"></list-loading>\n    <!-- 封面区域 -->\n    <div class="module-box" v-if="hasPics">\n        <div :class="[this.listType === 1? \'module-type\' : \'module-human-type\']">\n            <!-- 人物封面 -->\n            <!-- [单行]listType为1，[全部]listType为2 -->\n                <connection-list v-if="isNewApi && listType !== 3 && humanShow" :listType="listType" \n                @on-classify-setLoading="setLoading"\n                @on-list-human-show="setShow(\'human\')"></connection-list>\n            <!-- 地点封面 -->\n            <!-- [单行]listType为1，[全部]listType为3 -->\n                <position-list v-show="isNewApi && listType !== 2 && positionShow" :listType="listType"\n                @on-classify-setLoading="setLoading"\n                @on-list-position-show="setShow(\'position\')"></position-list>\n            <!-- 事物封面 -->\n            <template v-show="$route.name === \'classify\'">\n                <div v-show="affairlists[\'show\']">\n                    <p class="type-kind">事物</p>\n                    <ul class="pics">\n                        <li v-for="item in affairlists.list" v-if="item.show"\n                        :class="[{\'image-err\': item && item.imgErr}, \'item\']"\n                        @click="changeDetail(item)">\n                            <div v-if="item && !item.imgErr"\n                            class="item-content"                    \n                            :style="{\n                            backgroundImage: item.loaded && item.formatThumb ? \'url(\' + item.formatThumb + \')\' : \'none\',\n                            opacity: item.loaded ? 1 : 0}"></div>\n                            <!-- img用于判断封面图片是否加载成功 -->\n                            <img class="cover-img" v-if="!item.loaded && !item.imgErr"\n                            :src="imageSrcFormat(item)"\n                            @load="imageFormat(item)"\n                            @error="imageError(item)">\n                            <div :class="{\'type-nameBg\': item.loaded && !judgeIE9, \'type-nameBg-ie\': item.loaded && judgeIE9}"></div>\n                            <p class="type-name" :title="item.chineseName">{{item.chineseName}}</p>\n                        </li>\n                    </ul>\n                </div>\n            </template>\n        </div>\n    </div>\n    <!-- 没有人物和事物分类出空列表 -->\n    <list-empty :show="listEmpty.show"\n        :listEmptyComponent="listEmpty.listEmptyComponent"\n        :emptyDesc="listEmpty.emptyDesc"></list-empty>\n</div>',components:{topToolBar:o,"connection-list":r},data:function(){return{hasPics:!1,affairlists:{show:!1,list:[]},hasPicInTimeline:!0,affairShow:!0,positionShow:!0,loading:!0,judgeIE9:document.all&&document.addEventListener&&!window.atob}},computed:s.util.extend({listType:function(){var t=this.$route,i=t.name;return"classify"===i?1:"connectionList"===i?2:"positionList"===i?3:void 0},humanShow:function(){return this.privateSwitch?!1:!0}},p({tip:"getTip",listEmpty:"getListEmpty",routeType:"getRouteType",isNewApi:"getIsNewVersion",affairData:"getAffairlists",firstGetAffairData:"getFirstGetAffairData",privateSwitch:"getPrivateSwitch"})),watch:{affairData:function(t,i){"classify"!==this.routeType||this.firstGetAffairData||!i&&t.length>0&&(this.handlDataFromStore(),this.updateDataLock())},hasPicInTimeline:function(t){var e=!t;this.$store.commit("setListEmpty",{show:e,listEmptyComponent:l,emptyDesc:i}),this.loading=!1},affairShow:function(t){if(1===this.listType){var e=!t&&!this.humanShow&&!this.positionShow;this.$store.commit("setListEmpty",{show:e,listEmptyComponent:l,emptyDesc:i}),this.loading=!1}},humanShow:function(t){if(2===this.listType){var e=!t;this.$store.commit("setListEmpty",{show:e,listEmptyComponent:l,emptyDesc:i}),this.loading=!1}},positionShow:function(t){if(3===this.listType){var e=!t;this.$store.commit("setListEmpty",{show:e,listEmptyComponent:l,emptyDesc:i}),this.loading=!1}}},methods:s.util.extend({setClusterData:function(t){var i=this.affairlists.list,e=t.index;i[e]&&(s.set(i[e],"show",t.show),s.set(i[e],"list",[t.list]),i[e].imgErr&&s.set(i[e],"imgErr",!1)),this.affairlists.show||(s.set(this.affairlists,"show",t.show),this.loading=!1)},setClassifyTag:function(t){if(t&&t.list){var i=[];t.list.sort(function(t,i){return i.count-t.count}),t.list.forEach(function(e,s){"其它"===e.tag_name&&(i=t.list.splice(s,1))}),t.list=t.list.concat(i);for(var e=0;e<t.list.length;e++){var n=t.list[e],a=[];this.affairlists.list.push(n),s.set(this.affairlists.list[e],"chineseName",n.tag_name),s.set(this.affairlists.list[e],"cluster",n.tag_id),n.thumb?(a.push({thumb:n.thumb}),s.set(this.affairlists.list[e],"show",!0),s.set(this.affairlists.list[e],"list",a)):(s.set(this.affairlists.list[e],"show",!1),s.set(this.affairlists.list[e],"list",[]))}}},setLoading:function(t){this.loading=t.show},setShow:function(t){"human"===t?this.humanShow=!1:"position"===t&&(this.positionShow=!1)},getFirst:function(t){var i=[],e={};if(t){for(var s=t.length,n=0;s>n;n++)if(t[n].day&&t[n].month&&t[n].year){var a=t[n].year+t[n].month+t[n].day;i.push(a),e[a]?e[a].push(t[n]):(e[a]=[],e[a].push(t[n]))}var o=i.sort(function(t,i){return isNaN(+t)?!0:i-t});return e[o[0]]&&e[o[0]][0]}return e},getPicForJudge:function(t){var i=function(i){i&&(0===i.errno?t.succCb(i):t.errCb(i.errno))},e=function(i){i&&(0===i.errno?t.succCb(i):t.errCb(i.errno))};this.isNewApi?c.getClassifyResult(t.params).then(e).catch(function(){t&&t.errCb&&t.errCb()}):c.getPicForJudge().then(i).catch(function(){t&&t.errCb&&t.errCb()})},getPicForJudgeSuccCb:function(i){var e=this;this.isNewApi?i&&i.list&&i.list.length>0?(this.hasPics=!0,this.affairData&&this.affairData.length>0&&!this.firstGetAffairData?(this.handlDataFromStore(),this.updateDataLock()):(this.$store.dispatch("classify/getTagList",{params:{key:"tag",type:1}}),setTimeout(function(){this.affairData&&0===this.affairData.length&&!this.firstGetAffairData&&(e.getClassifyResult({params:{key:"tag",type:1},succCb:e.getAllCluster,errCb:e.errCb}),e.updateDataLock())},2e3))):this.hasPicInTimeline=!1:i&&i.info&&i.info.length>0?(this.hasPics=!0,this.affairlists.list=t,this.getAllCluster()):this.hasPicInTimeline=!1,this.hasPics&&g.showTipLine.call(this)},handlDataFromStore:function(){1===this.listType&&(this.loading=!1);var t=this.affairData.filter(function(t){return 1===t.is_show});t&&t.length&&(this.setClassifyTag({list:t}),this.getAllCluster())},updateDataLock:function(){this.$store.commit("setFirstGetAffairData",{params:{firstGetData:!0}})},getClassifyResult:function(t){var i=this,e=function(e){if(e)if(0===e.errno){if(e.list&&e.list.length>0){1===i.listType&&(i.loading=!1);var s=e.list.filter(function(t){return 1===t.is_show});return i.setClassifyTag({list:s}),void t.succCb()}i.affairShow=!1}else t.errCb(e.errno);else t&&t.errCb&&t.errCb()};c.getClassifyResult(t.params).then(e).catch(function(){t&&t.errCb&&t.errCb()})},getAllCluster:function(){var t=this.isNewApi,i=this.affairlists.list;if(t)i.forEach(function(e,s){0===e.list.length?this.getClusterData({params:{start:0,search_type:1,keyword:i[s].tag_id,isNewApi:t},index:s,errCb:this.errCb}):this.affairlists.show||(this.affairlists.show=!0)},this);else for(var e=0;e<i.length;e++)this.getClusterData({params:{start:0,key:"tag",cluster:i[e].cluster,isNewApi:t},index:e,errCb:this.errCb})},getClusterData:function(t){var e=this,s=t.index,n=function(a){if(a)if(0===a.errno){if(a.list&&a.list.length>0)return void e.setClusterData({show:!0,list:e.getFirst(a.list),index:s});a.list&&0===a.list.length&&(e.isNewApi||(g.checkClassifyEmpty++,g.checkClassifyEmpty>=13&&(e.hasPics=!1,e.$store.commit("setListEmpty",{show:!0,listEmptyComponent:l,emptyDesc:i})))),a.has_more===!0&&(t.params.start+=10,c.getCluster(t.params).then(n).catch(function(){t&&t.errCb&&t.errCb()}))}else t.errCb(a.errno);else t&&t.errCb&&t.errCb()};c.getCluster(t.params).then(n).catch(function(){t&&t.errCb&&t.errCb()})},errCb:function(t){this.$store.commit("setTip",{show:!0,msg:a.errorMsg(t),status:"caution",autoClose:!0,closeBtn:!0})},imageError:function(t){t&&s.set(t,"imgErr",!0)},imageFormat:function(t){t&&s.set(t,"loaded",!0)},imageSrcFormat:function(t){if(t&&t.list&&t.list.length&&t.list[0].thumb){var i=t.list[0].thumb,e=h.imageFormat312({value:i});return s.set(t,"formatThumb",e),e}return""},changeDetail:function(t){var i=t.cluster;a.log.send({type:"web_album_"+i+"_classify_click"}),this.$router.push({name:"classifyList",params:{classifyType:1,clusterType:i}})}},u({panTipClick:"panTipClick"})),created:function(){this.$store.commit("setRouteType",{routeType:this.$route.name}),this.getPicForJudge({params:{key:"tag",type:1},succCb:this.getPicForJudgeSuccCb,errCb:this.errCb})},mounted:function(){},activated:function(){(!this.hasPicInTimeline||!this.affairShow&&!this.humanShow&&!this.positionShow||!this.humanShow&&2===this.listType||!this.positionShow&&3===this.listType)&&(this.$store.commit("setListEmpty",{show:!0,listEmptyComponent:l,emptyDesc:i}),this.loading=!1)}});return e}};e.exports=g.init()});
;define("pan-timeline:widget/components/system/listView/normalListView/normalListView.js",function(i,t,e){"use strict";var n=i("base:thirdParty/vue/vue.js"),s={init:function(){var i=n.component("normalListView",{name:"normalListView",template:"<div>normalList View~~~</div>"});return i}},r={init:s.init};e.exports=r});
;define("pan-timeline:widget/components/system/listView/timelineView/timelineRuler/timelineRuler.js",function(e,t,i){"use strict";var n=e("base:thirdParty/vue/vue.js"),s=e("base:thirdParty/vue/vuex.js"),r=e("system-core:context/context.js").instanceForSystem,o=s.mapGetters,l=(e("base:widget/libs/underscore.js"),{logFlag:{rulerClick:!0},init:function(){var e=n.component("timelineRuler",{name:"timelineRuler",template:'<div class="module-timeline-ruler">\n    <div class="timeline-ruler"\n        :style="{height: rulerHeight}"\n        @hover="showRulerFunc();"\n        @mousemove.stop.prevent="rulerHover($event);"\n        @click.stop="rulerClick($event);"\n        @mousedown.stop.prevent="mouseDown($event);"\n        @mouseup.stop.prevent="mouseUp($event);"\n        @mouseleave.stop.prevent="mouseLeave($event);">\n        <transition name="slide-fade">\n            <div class="ruler-content" \n                v-if="formatedRulerList && formatedRulerList.length">\n                <div class="line-container"\n                    v-for="(lineObj, index) in formatedRulerList"\n                    v-if="lineObj.show"\n                    :style="{transform: \'translateY(\' + lineObj.posForShow + \'px)\'}"\n                    >\n                    <div :class="[\'line-\' + lineObj.type]">{{lineObj.type === \'year\' ? lineObj.desc : \'\'}}</div>\n                </div>\n                <div v-if="formatedRulerList && formatedRulerList.length > 0">\n                    <div class="line-hover"\n                        v-if="hoverPos != null"\n                        :style="{transform: \'translateY(\' + hoverPos + \'px)\'}"></div>\n                    <div class="line-current"\n                        v-if="clickPos != null"\n                        :style="{transform: \'translateY(\' + clickPos + \'px)\'}"></div>\n                    <div v-if="hoverPos != null && hoverDayDesc"\n                        class="hover-day-desc"\n                        :style="{transform: \'translateY(\' + hoverPos + \'px)\'}">\n                        <div class="day-desc">\n                            <span class="desc">{{hoverDayDesc}}</span>\n                        </div>\n                    </div>\n                    <div v-else-if="clickPos != null && clickPosDesc"\n                        class="hover-day-desc"\n                        :style="{transform: \'translateY(\' + clickPos + \'px)\', opacity: innerShowRuler ? 1 : 0}">\n                        <div class="day-desc">\n                            <span class="desc">{{clickPosDesc}}</span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </transition>\n    </div>\n</div>',props:{showRuler:Boolean,listContainer:String,listContent:String,listViewContainer:String,type:String},data:function(){return{hoverPos:null,hoverDayDesc:null,clickPosDesc:null,mouseStatus:"up",contaierOffsetTop:null,contaierHeight:null,innerShowRuler:!0,formatedRulerList:null}},methods:{getPosition:function(e){var t=this.contaierOffsetTop=this.contaierOffsetTop||document.querySelector(".timeline-ruler").offsetTop,i=this.getRulerHeight();return Math.min(Math.max(e.pageY-t,0),i)},getRulerHeight:function(){var e=this.contaierHeight=this.contaierHeight||document.querySelector(".timeline-ruler").offsetHeight;return e},getDayByPos:function(e){for(var t=this.rulerList,i={},n=0;n<t.length;n++)if(!("year"===t[n].type&&n<t.length-1)&&t[n].pos<=e&&t[n].pos+t[n].height>=e){i=t[n];break}return i},rulerHover:function(e){this.hoverPos=this.getPosition(e);var t=this.getDayByPos(this.hoverPos);t&&t.desc&&(this.hoverDayDesc=t.desc),"down"===this.mouseStatus&&this.rulerClick(e)},rulerClick:function(e){var t=this.getRulerHeight();this.$store.commit("timeline/changeRulerPos",{clickPos:this.getPosition(e)});var i=document.querySelector(this.listViewContainer),n=i&&i.offsetHeight||0,s=this.clickPos/t,o=document.querySelector(this.listContent).offsetHeight,c=s*(o-n);document.querySelector(this.listContainer).scrollTop=c,l.logFlag.rulerClick&&(r.log.send({type:"web_album_newlist_ruler_click",logFrom:this.type}),l.logFlag.rulerClick=!1)},mouseDown:function(){this.mouseStatus="down"},mouseUp:function(){this.mouseStatus="up"},mouseLeave:function(){this.hoverPos=null},showRulerFunc:function(){this.innerShowRuler=!0},formatRulerList:function(){var e=this.rulerList,t=[];if(e&&e.length>=0){for(var i=0;i<e.length;i++){var n=e[i];n.show&&t.push(n)}this.formatedRulerList=t}}},watch:{clickPos:function(){this.innerShowRuler=!0;var e=this.getDayByPos(this.clickPos);e&&e.desc&&(this.clickPosDesc=e.desc)},hoverPos:function(){this.innerShowRuler=!0},rulerList:function(){this.formatRulerList()},viewContaierHeight:function(e){var t=/calc.*[^\d]+(\d+)(px)/;if(e&&t.test(e)){var i=+e.match(t)[1];return"calc(100% - "+(i+180)+"px)"}return"calc(100% - 180px)"}},created:function(){if(l.logFlag)for(var e in l.logFlag)l.logFlag.hasOwnProperty(e)&&(l.logFlag[e]=!0);var t=this;l.checkRulerShowTimer=setInterval(function(){l.clickPos===t.clickPos&&null==t.hoverPos?t.innerShowRuler=!1:l.clickPos=t.clickPos},1500),this.formatRulerList()},destroyed:function(){clearInterval(l.checkRulerShowTimer),l.checkRulerShowTimer=null,this.hoverPos=null,this.$store.commit("timeline/changeRulerPos",{clickPos:0})},computed:n.util.extend({rulerHeight:function(){var e=this.viewContaierHeight,t=/calc.*[^\d]+(\d+)(px)/;if(e&&t.test(e)){var i=+e.match(t)[1];return"calc(100% - "+(i+180)+"px)"}return"calc(100% - 180px)"}},o({clickPos:"getCurRulerPos",countList:"getCountList",timeLineList:"getTimeLineList",yearCluster:"getYearCluster",rulerList:"getRulerList",viewContaierHeight:"getContainerHeight"}))});return e}}),c={init:l.init};i.exports=c.init()});
;define("pan-timeline:widget/components/system/listView/timelineView/timelineView.js",function(e,t,i){"use strict";var n=e("base:thirdParty/vue/vue.js"),s=e("base:thirdParty/vue/vuex.js"),o=e("base:widget/libs/jquerypacket.js"),l=e("pan-timeline:widget/components/system/listView/timelineView/timelineRuler/timelineRuler.js"),a=e("system-core:context/context.js").instanceForSystem,c=e("pan-timeline:widget/filters/index.js"),r=s.mapGetters,d={logFlag:{togglePackup:!0,shiftClick:!0},imgOnloadLog:{list:[],hasLog:!1,delayLock:!1,timer:null}};i.exports.init=function(){return n.component("timelineView",{name:"timelineView",template:'<div class="module-timeline-view" v-dynamic-class="listViewClass">\n    <template v-if="listViewType===1 && renderLists.curDay && renderLists.curDay.top != null">\n        <!-- 用这个来实现推上去的效果 - -!~ -->\n        <div class="timeline-title timeline-title-curday"\n            v-if="renderLists.curDay.top < 0"\n            :style="{transform: \'translateY(\' + renderLists.curDay.top + \'px)\',\n                \'border-bottom\': getPackUpInfo(renderLists.curDay.day) ? \'1px solid #f2f6fd\' : \'\'}">\n            <div class="checkbox-item" @click.stop="chooseOneDay(renderLists.curDay.day)">\n                <span class="icon chooseAll"></span>\n                <span class="icon timeline-checksmall icon-checksmall" v-if="getGroupChooseAll(renderLists.curDay.day)"></span>\n            </div>\n            <div class="timelineInfo"><span class="timeline-day">{{renderLists.curDay.day | formatTime}}</span>\n                <span class="open-status" v-text="getPackUpInfo(renderLists.curDay.day) ? \'展开\' : \'收起\'" @click.stop.prevent="togglePackUp(renderLists.curDay.day)">\n                </span>\n            </div>\n        </div>\n        <div class="timeline-title timeline-title-curday timeline-title-curday-fixed"\n            v-else-if="listTitleCheckFunc()"\n            :style="{\'border-bottom\': getPackUpInfo(renderLists.curDay.day) ? \'1px solid #f2f6fd\' : \'\'}">\n            <div class="checkbox-item" @click.stop="chooseOneDay(renderLists.curDay.day)">\n                <span class="icon chooseAll"></span>\n                <span class="icon timeline-checksmall icon-checksmall" v-if="getGroupChooseAll(renderLists.curDay.day)"></span>\n            </div>\n            <div class="timelineInfo"><span class="timeline-day">{{renderLists.curDay.day | formatTime}}</span>\n                <span class="open-status" v-text="getPackUpInfo(renderLists.curDay.day) ? \'展开\' : \'收起\'" @click.stop.prevent="togglePackUp(renderLists.curDay.day)">\n                </span>\n            </div>\n        </div>\n    </template>\n    <div class="timeline-container" style="height: auto;"\n        :style="{height: listViewHeight ? listViewHeight + \'px\' : \'100%\'}">\n        <template v-if="listViewType===0">\n            <div class="timeline-item" v-for="(day, key) in orderTimeLineDataList">\n                <div class="timeline-title">\n                    <div class="checkbox-item" @click.stop="chooseOneDay(day.dayDesc)">\n                        <span class="icon icon-hollowCircle chooseAll"></span>\n                        <span class="icon timeline-checksmall icon-checksmall" v-if="getGroupChooseAll(day.dayDesc)"></span>\n                    </div>\n                    <div class="timelineInfo"><span class="timeline-day">{{day.dayDesc | formatTime}}</span>\n                        <span class="open-status" v-text="getPackUpInfo(day.dayDesc) ? \'展开\' : \'收起\'" @click.stop.prevent="togglePackUp(day.dayDesc,$event)"></span>\n                        </div>\n                </div>\n                <transition name="slide-fade">\n                    <div class="timeline-content list-content" v-if="!getPackUpInfo(day.dayDesc)">\n                        <div class="timeline-content-item content-item" v-for="(file, index) in day" @click.stop=" listStatus===2 ? toggleChoose({index:file.index, date:file.date}) : openFile(file.index)" :data-index="file.index" :data-fsid="file.fs_id" :style="{left: file.left + \'px\', top: file.top + \'px\'}" :class="[{\'choosen\':file.choose}]" @contextmenu.prevent="rightClick(file.index,$event)">\n                            <img class="img" v-if="file.thumb" :src="{value: file.thumb} | imageFormat312" :style="file.resolution | positionFix312">\n                            <div class="hoverMask"></div>\n                            <span node-type="timeline-checkbox" class="timeline-checkbox"  @click.stop="toggleChoose({index:file.index, date:file.date})">\n                            <span v-if="listStatus===2" class="icon icon-hollowCircle hoverCircle" ></span>\n                            <span class="icon circle-icon" ></span>\n                            <span class="icon checkgridsmall" ></span>\n                            </span>\n                            <span class=" icon icon-imageEnlarge" :class="[listStatus===2 ? \'imageEnlarge\' : \'\']" @click.stop="openFile(file.index)"></span>\n                        </div>\n                    </div>\n                </transition>\n            </div>\n        </template>\n        <template v-else>\n            <div class="recycle-group" v-for="(renderGroup, index) in renderLists" style="position: absolute;" :style="{left: renderGroup.left + \'px\', top: renderGroup.top + \'px\', width: renderGroup.width + \'px\', height: renderGroup.height + \'px\'}">\n                <div class="day-group timeline-item" v-for="(dayGroup, index) in renderGroup" style="position: absolute;" :style="{left: dayGroup.left + \'px\', top: dayGroup.top + \'px\', width: dayGroup.width + \'px\', height: dayGroup.height + \'px\'}" :date="dayGroup.dayDesc">\n                    <div class="timeline-title" style="position: absolute; left: 0; top: -40px;"\n                    :style="{\'border-bottom\': getPackUpInfo(dayGroup.dayDesc) ? \'1px solid #f2f6fd\' : \'\'}">\n                        <div class="checkbox-item" @click.stop="chooseOneDay(dayGroup.dayDesc)">\n                            <span class="icon chooseAll"></span>\n                            <span class="icon timeline-checksmall icon-checksmall" v-if="getGroupChooseAll(dayGroup.dayDesc)"></span>\n                        </div>\n                        <div class="timelineInfo"><span class="timeline-day">{{dayGroup.dayDesc | formatTime}}</span>\n                            <span class="open-status" v-text="getPackUpInfo(dayGroup.dayDesc) ? \'展开\' : \'收起\'" @click.stop.prevent="togglePackUp(dayGroup.dayDesc,$event)"></span></div>\n                    </div>\n                    <div class="timeline-content list-content" style="position: absolute; left: 0; top: 0;" :style="{width: dayGroup.width + \'px\', height: (dayGroup.height + \'px\')}">\n                        <div class="line-group" v-for="(lineGroup, index) in dayGroup" style="position: absolute;" :style="{left: lineGroup.left + \'px\', top: lineGroup.top + \'px\', width: lineGroup.width + \'px\', height: lineGroup.height + \'px\'}">\n                            <!--这里是提供给调用方对于不同的img处理时，可传入自己的处理组件-->\n                            <component :is="listItemComp"\n                                v-if="listItemComp != null"\n                                :listItemComp="listItemComp"\n                                :lineData="lineGroup"\n                                :dayGroup="dayGroup"\n                                :onMouseSelect="onMouseSelect"\n                                @on-toggle-choose="toggleChoose"\n                                @on-open-file="openFile"\n                                @on-load-more="loadMoreData"\n                                @on-image-error="imageError"\n                                @on-image-loaded="imageLoaded"\n                                @on-right-click="rightClick"\n                                @on-hover-item="hoverItem"\n                                ></component>\n                            <div class="timeline-content-item content-item"\n                                v-else\n                                v-for="(file, index) in lineGroup"\n                                :key="file.fs_id"\n                                style="position: absolute;"\n                                :style="{left: file.left + \'px\', top: file.top + \'px\'}"\n                                @click.stop=" listStatus===2 ? toggleChoose({index:file.index, date:dayGroup.dayDesc}) : openFile({index:file.index, date:dayGroup.dayDesc})"\n                                :data-index="file.index"\n                                :data-fsid="file.fs_id"\n                                :class="{\'choosen\':file.choose, \'shift-hover\': file.shiftHover}"\n                                @contextmenu.prevent="rightClick({index:file.index, date:dayGroup.dayDesc},$event)"\n                                @mouseover.stop.prevent="hoverItem(file.index, dayGroup.dayDesc, $event);">\n                                <span v-if="file.status === \'needMore\'"\n                                    class="timeline-content-more block-need-more"\n                                    @click.stop="loadMoreData(dayGroup.dayDesc, file)">查看更多<i class="need-more-icon icon icon-arrow-right"></i></span>\n                                <span v-else-if="file.status === \'isLoading\'"></span>\n                                <span v-else-if="file.status === \'isLoadingMore\'"\n                                    class="block-loading-more">\n                                    <svg class="spinner" width="26px" height="26px" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg">\n                                        <circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30" style="stroke:#09AAFF"></circle>\n                                    </svg>\n                                </span>\n                                <div class="file-container" v-else>\n                                    <div class="fileicon"\n                                        :class="{\'image-err\': file.imgErr}">\n                                        <div class="img-container"\n                                            v-if="file.thumb && !file.imgErr "\n                                            :style="{backgroundImage: file.imgLoaded && file.formatThumb ? \'url(\' + file.formatThumb + \')\' : \'none\',\n                                                    opacity: file.imgLoaded ? 1 : 0}">\n                                        </div>\n                                        <img :time="new Date().getTime()" class="thumb" v-if="file.thumb && !file.imgErr && !file.imgLoaded"\n                                            style="visibility: hidden;"\n                                            :src="imageFormat312(file)"\n                                            @error="imageError($event, file);"\n                                            @load="imageLoaded($event, file);">\n\n                                        <i v-if="file.category == 3 && /\\.livp$/i.test(file.path)" class="icon-livp"></i>\n\n                                        <div class="hoverMask"></div>\n                                        <div class="hoverBorder"></div>\n                                        <div  class="hoverCover":style="{display: (listStatus===2 && !file.choose)? \'inline-block\':\'\'}"></div>                     \n                                        <div v-if="listStatus===2" class="hoverCoverBottom"></div> \n                                    </div>\n                                    <span node-type="timeline-checkbox" class="timeline-checkbox"  @click.stop="toggleChoose({index:file.index, date:dayGroup.dayDesc}) ">\n                                        <span v-if="listStatus===2 " class="icon icon-hollowCircle hoverCircle" ></span>\n                                        <span class="icon circle-icon icon-circle" ></span>\n                                        <span class="icon checkgridsmall icon-checkgridsmall" ></span>\n                                    </span>\n                                    <span class=" icon icon-imageEnlarge imageEnlargeShow" :class="[listStatus===2 ? \'imageEnlarge\' : \'\'] " @click.stop="openFile({index:file.index, date:dayGroup.dayDesc});"></span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </template>\n        <timeline-ruler v-if="showRuler"\n            :listContainer="listContainer"\n            :listViewContainer="listViewContainer"\n            :type="type"\n            :listContent="listContent"></timeline-ruler>\n    </div>\n</div>',props:{type:String,listViewType:Number,listViewClass:{type:String,"default":""},showRuler:{type:Boolean,"default":!1},loadMoreDataInDay:Function,scrollListFunc:Function,resizeEventFunc:Function,listItemComp:Function,listItemClick:Function,listContainer:String,listViewContainer:String,mouseSelectFunc:Function,listTitleCheckFunc:{type:Function,"default":function(){return!0}}},data:function(){return{listContent:".timeline-container"}},components:{"timeline-ruler":l},mounted:function(){var e=this;this.$store.commit("setOnMouseSelectFunc",{onMouseSelectFunc:e.onMouseSelect})},methods:{imageError:function(e,t){t&&n.set(t,"imgErr",!0)},imageLoaded:function(e,t){if(t&&n.set(t,"imgLoaded",!0),"timeline"===this.$route.name){var i=d.imgOnloadLog.list;if(!d.imgOnloadLog.hasLog&&t.imgOnloadStartTime&&i.length<this.thumbnailCount){var s=(new Date).getTime(),o=function(e){var t=0;return e.forEach(function(e){t+=e}),t},l=function(){d.imgOnloadLog.hasLog||(a.log.send({url:"//update.pan.baidu.com/statistics",op:"loadImage",type:"ignore",other0:"small",other1:"false",other2:i.length,other3:o(i),other4:!1,other5:"webtimeline"}),d.imgOnloadLog.hasLog=!0,clearTimeout(d.imgOnloadLog.timer))},c=t.imgOnloadStartTime;e.target&&e.target.getAttribute("time")&&(c=e.target.getAttribute("time")),i.push(s-c),d.imgOnloadLog.delayLock||(d.imgOnloadLog.timer=setTimeout(l,2e4),d.imgOnloadLog.delayLock=!0),i.length>=this.thumbnailCount&&l()}}},imageFormat312:function(e){if(e){var t={value:e.thumb,size:e.resolution,orientation:e.orientation},i=c.imageFormat312(t);return n.set(e,"formatThumb",i),i}return null},getPackUpInfo:function(e){return this.packUpInfo[e]},getGroupChooseAll:function(e){return this.groupChooseAll[e]},toggleChoose:function(e){var t=e.index,i=e.date;if(null!=this.listItemClick&&this.listItemClick.call(this),2===this.listStatus&&this.shiftStatus&&this.choosedItemArr.length){var n=this.choosedItemArr,s=n[n.length-1],o=s.index;this.$store.dispatch("timeline/setSomeChoose",{start:{day:s.year+s.month+s.day,index:o},end:{day:i,index:t}}),d.logFlag.shiftClick&&(a.log.send({type:"web_album_newlist_shift_click",logFrom:this.type}),d.logFlag.shiftClick=!1)}else this.$store.dispatch("timeline/setChoosedItem",{index:t,date:i})},openFile:function(e){if(e&&void 0!==e.index&&void 0!==e.date){var t=e.index,i=e.date,n=this.timeLineDataList[i][t];this.$store.dispatch("openFiles",{fileinfo:n})}},loadMoreData:function(e,t){t&&(t.status="isLoadingMore"),this.loadMoreDataInDay.call(this,e)},togglePackUp:function(e,t){var i=this,n=(this.objHeight,"");n=t?o(t.target).parents(".timeline-title").next(".list-content"):o('[date="'+e+'"]').find(".list-content");var s=this.packUpInfo[e],l=function(){var t=i.renderLists,n=i.recycleListConf&&i.recycleListConf.listHeaderSlotGap||0;if(t.curDay&&t.curDay.day===e){var s=t&&t.curDay&&t.curDay.scrollTop||0,o=document.querySelector(".module-list-view");if(s>0){if(o){var l=o.scrollTop;o.scrollTop=l-s}}else if(n&&o){var l=o.scrollTop;n>l&&(o.scrollTop=n)}}};s?(i.$store.commit("timeline/setPackUpInfo",{date:e}),i.$store.dispatch("timeline/setCountListForShow",{dayStr:e}),l(),i.$store.dispatch("timeline/triggerLayout",{dayStr:e,resize:!0}),n.css({opacity:0}),n.animate({opacity:1},400,function(){})):n.animate({opacity:0},400,function(){n.css({opacity:1}),i.$store.commit("timeline/setPackUpInfo",{date:e}),i.$store.dispatch("timeline/setCountListForShow",{dayStr:e}),l(),i.$store.dispatch("timeline/triggerLayout",{dayStr:e,resize:!0})}),d.logFlag.shiftClick&&(a.log.send({type:"web_album_newlist_toggle_packup",logFrom:this.type}),d.logFlag.shiftClick=!1)},chooseOneDay:function(e){this.$store.dispatch("timeline/setchooseOneDay",{date:e})},rightClick:function(e,t){var i=e.index,n=e.date,s=this.timeLineDataList[n][i];s.choose||this.$store.dispatch("timeline/setChoosedItem",{index:i,date:n}),this.$store.commit("setContextMenu",{show:!0,left:t.pageX-194,top:t.pageY-69,index:i,date:n})},hoverItem:function(e,t){if(2===this.listStatus&&this.shiftStatus&&this.choosedItemArr.length){var i=this.choosedItemArr,n=i[i.length-1],s=n.index;this.$store.dispatch("timeline/setSomeHover",{start:{day:n.year+n.month+n.day,index:s},end:{day:t,index:e}})}},onMouseSelect:function(e){var t=o(".timeline-container");if(null!=e&&null!=t){if("function"==typeof this.mouseSelectFunc)return void this.mouseSelectFunc();for(var i=t.offset(),n=i.left,s=i.top,l=this.recycleListConf,a={left:e.left-n,top:e.top-s,width:e.width,height:e.height},c=l&&l.itemObj&&l.itemObj.width,r=l&&l.itemObj&&l.itemObj.height,d=this.renderLists,p=0;p<d.length;p++)for(var m=d[p],h={left:m.left||0,top:m.top},u=0;u<m.length;u++)for(var g=m[u],f=(l&&l.groupHeightGap||0,{left:g.left,top:g.top}),y=0;y<g.length;y++)for(var v=g[y],x={left:v.left,top:v.top},k=0;k<v.length;k++){var L=v[k],C=(L.index,h.left+f.left+x.left+L.left),D=h.top+f.top+x.top+L.top,w=C+c,b=D+r,G=a.left,F=a.left+a.width,I=a.top,S=a.top+a.height;(C>G&&F>C||w>G&&F>w||G>C&&w>F)&&(D>I&&S>D||b>I&&S>b||I>D&&b>S)?L.choose||this.toggleChoose({date:L.year+L.month+L.day,index:L.index}):L.choose&&this.toggleChoose({date:L.year+L.month+L.day,index:L.index})}}}},created:function(){if(d.logFlag)for(var e in d.logFlag)d.logFlag.hasOwnProperty(e)&&(d.logFlag[e]=!0)},computed:n.util.extend({objHeight:function(){return this.recycleListConf.itemObj.height}},r({vmode:"getVmode",listStatus:"getListStatus",lists:"getListsData",renderLists:"getRenderLists",listTip:"getListTip",listViewHeight:"getListViewHeight",choosedItemArr:"getChoosedItemArr",chooesedItemMap:"getChooesedItemMap",getRouteType:"getRouteType",timeLineDataList:"getTimeLineDataList",timeLineList:"getTimeLineList",dayList:"getDayList",packUpInfo:"getPackUpInfo",groupChooseAll:"getGroupChooseAll",shiftStatus:"getShiftStatus",recycleListConf:"getRecycleListConf",thumbnailCount:"getTimelineThumbnailCount"}))})}});
;define("pan-timeline:widget/components/system/listView/gridView/gridView.js",function(e,t,i){"use strict";var s=e("base:thirdParty/vue/vue.js"),o=e("base:thirdParty/vue/vuex.js"),n=e("system-core:context/context.js").instanceForSystem,l=e("pan-timeline:widget/filters/index.js"),a=o.mapGetters,r={shiftClick:!0};i.exports.init=function(){return s.component("gridView",{name:"gridView",template:'<div node-type="module-grid-container" class="module-grid-container g-clearfix" v-dynamic-class="\'g-clearfix  module-grid-container\' + listViewClass"  :style="{height: listViewHeight ? listViewHeight + \'px\' : \'100%\'}">\n    <div class="g-clearfix grid-view" style="height: auto;">\n        <template  v-if="listViewType===0">\n            <dd class="g-clearfix grid-viewport-item" v-for="(file, key) in lists" @click.stop=" listStatus===2 ? toggleChoose(key) : openFile(key)" :class="[{\'choosen\':file.choose}]"\n            @contextmenu.prevent=\'rightClick(key,$event)\'>\n                <div class="fileicon">\n                <img class="thumb" v-if="file.thumbs" :src="{value:file.thumbs.url1} | imageFormat312">\n                <div class="hoverMask"></div>\n                </div>\n                <span node-type="timeline-checkbox" class="timeline-checkbox" @click.stop="toggleChoose(key)">\n                <span v-if="listStatus===2" class="icon icon-hollowCircle hoverCircle" v-dynamic-class="listViewClass"></span>\n                    <span class="icon circle-icon"></span>\n                    <span class="icon checkgridsmall"></span>\n                </span>\n                <span class=" icon icon-imageEnlarge" :class="[listStatus===2 ? \'imageEnlarge\' : \'\']" @click.stop="openFile(key)"></span>\n            </dd>\n        </template>\n        <template v-else>\n            <div class="recycle-group" v-for="(renderGroup, index) in renderLists"\n                style="position: absolute;" \n                :style="{left: renderGroup.left + \'px\', top: renderGroup.top + \'px\', width: renderGroup.width + \'px\', height: renderGroup.height + \'px\'}">\n                <div class="line-group" v-for="(lineGroup, index) in renderGroup"\n                    style="position: absolute;" \n                    :style="{left: lineGroup.left + \'px\', top: lineGroup.top + \'px\', width: lineGroup.width + \'px\', height: lineGroup.height + \'px\'}">\n                    <dd class="g-clearfix grid-viewport-item content-item" v-for="(file, key) in lineGroup"\n                        :key="file.fs_id"\n                        @click.stop=" listStatus===2 ? toggleChoose(file.index) : openFile(file.index)"\n                        :data-index="file.index"\n                        style="position:absolute;"\n                        :style="{left: file.left + \'px\', top: file.top + \'px\'}"\n                        :data-fsid="file.fs_id"\n                        :class="{\'choosen\': file.choose, \'shift-hover\': file.shiftHover}"\n                        @contextmenu.prevent="rightClick(file.index,$event)"\n                        @mouseover.stop.prevent="hoverItem(file.index, $event);">\n                        <div class="fileicon"\n                            :class="{\'image-err\': file.imgErr}">\n                            <div class="img-container"\n                                v-if="(file.thumbs || file.thumb) && !file.imgErr"\n                                :style="{backgroundImage: file.imgLoaded && file.formatThumb ? \'url(\' + file.formatThumb + \')\' : \'none\',\n                                        opacity: file.imgLoaded ? 1 : 0}">\n                            </div>\n                            <img class="thumb" v-if="(file.thumbs || file.thumb) && !file.imgErr && !file.imgLoaded"\n                                style="visibility: hidden;"\n                                :src="{value: (file.thumb || file.thumbs.url1)} | imageFormat312"\n                                @error="imageError($event, file);"\n                                @load="imageLoaded($event, file);">\n\n                            <i v-if="file.category == 3 && /\\.livp$/i.test(file.path)" class="icon-livp"></i>\n\n                            <div class="hoverMask"></div>\n                            <div class="hoverBorder"></div>\n                            <div  class="hoverCover":style="{display: (listStatus===2 && !file.choose)? \'inline-block\':\'\'}"></div>                                     \n                            <div v-if="listStatus===2" class="hoverCoverBottom"></div> \n                        </div>\n                        <span node-type="timeline-checkbox" class="timeline-checkbox" v-dynamic-class="listViewClass" @click.stop="toggleChoose(file.index)">\n                            <span v-if="listStatus===2" class="icon icon-hollowCircle hoverCircle" v-dynamic-class="listViewClass"></span>\n                            <span class="icon circle-icon" v-dynamic-class="listViewClass"></span>\n                            <span class="icon checkgridsmall" v-dynamic-class="listViewClass"></span>\n                        </span>\n                        <span class=" icon icon-imageEnlarge imageEnlargeShow" :class="[listStatus===2 ?   \'imageEnlarge\' : \'\']" @click.stop="openFile(file.index)">\n                        </span>\n                    </dd>\n                </div>\n            </div>\n        </template>\n    </div>\n</div>',props:{type:String,listViewClass:{type:String,"default":""},listItemClick:Function},data:function(){return{}},mounted:function(){var e=this;this.$store.commit("setOnMouseSelectFunc",{onMouseSelectFunc:e.onMouseSelect})},destroyed:function(){},methods:{imageError:function(e,t){t&&s.set(t,"imgErr",!0)},imageLoaded:function(e,t){var i;if(t.thumb||t.thumbs&&t.thumbs.url1){var o=t.thumb||t.thumbs.url1;i=this.imageFormat312(o)}t&&i&&s.set(t,"formatThumb",i),t&&s.set(t,"imgLoaded",!0)},imageFormat312:function(e){return e?l.imageFormat312({value:e}):null},toggleChoose:function(e){if(null!=this.listItemClick&&this.listItemClick.call(this),2===this.listStatus&&this.shiftStatus&&this.choosedItemArr.length){var t=this.choosedItemArr,i=(this.chooesedItemMap,t[t.length-1].index);this.$store.dispatch(this.getRouteType+"/setSomeChoose",{start:i,end:e}),r.shiftClick&&(n.log.send({type:"web_album_newlist_drag_select",logFrom:this.type}),r.shiftClick=!1)}else this.$store.dispatch(this.getRouteType+"/setChoosedItem",{index:e})},openFile:function(e){var t=this.lists[e];this.$store.dispatch("openFiles",{fileinfo:t})},rightClick:function(e,t){this.lists[e].choose||this.$store.dispatch(this.getRouteType+"/setChoosedItem",{index:e}),this.$store.commit("setContextMenu",{show:!0,left:t.pageX-194,top:t.pageY-69,index:e})},imgLoad:function(e){var t=e.target,i=t.parentNode.offsetWidth,s=t.parentNode.offsetHeight,o=t.offsetWidth,n=t.offsetHeight;t.style.left=(i-o)/2+"px",t.style.top=(s-n)/2+"px"},hoverItem:function(e){if(2===this.listStatus&&this.shiftStatus&&this.choosedItemArr.length){var t=this.choosedItemArr,i=(this.chooesedItemMap,t[t.length-1].index);this.$store.commit("setSomeHover",{start:i,end:e})}},onMouseSelect:function(e){var t=$(".module-grid-container");if(null!=e&&null!=t)for(var i=t.offset(),s=this.recycleListConf,o=i.left,n=i.top,l={left:e.left-o,top:e.top-n,width:e.width,height:e.height},a=s&&s.itemObj&&s.itemObj.width,r=s&&s.itemObj&&s.itemObj.height,c=this.renderLists,h=0;h<c.length;h++)for(var d=c[h],p={left:d.left,top:d.top},f=0;f<d.length;f++)for(var m=d[f],g={left:m.left,top:m.top},u=0;u<m.length;u++){var v=m[u],y=v.index,x=p.left+g.left+v.left,w=p.top+g.top+v.top,C=x+a,b=w+r,k=l.left,S=l.left+l.width,V=l.top,L=l.top+l.height;(x>k&&S>x||C>k&&S>C||k>x&&C>S)&&(w>V&&L>w||b>V&&L>b||V>w&&b>L)?v.choose||this.toggleChoose(y):v.choose&&this.toggleChoose(y)}}},created:function(){if(r)for(var e in r)r.hasOwnProperty(e)&&(r[e]=!0)},computed:s.util.extend({},a({vmode:"getVmode",listStatus:"getListStatus",lists:"getListsData",renderLists:"getRenderLists",listTip:"getListTip",listViewType:"getListViewType",listViewHeight:"getListViewHeight",choosedItemArr:"getChoosedItemArr",chooesedItemMap:"getChooesedItemMap",getRouteType:"getRouteType",shiftStatus:"getShiftStatus",recycleListConf:"getRecycleListConf"}))})}});
;define("pan-timeline:widget/system/util/queue.js",function(t,n,i){"use strict";function e(){var t=[];this.push=function(n){return t.push(n),!0},this.pop=function(){return t.shift()},this.getHead=function(){return t[0]},this.getTail=function(){return t[t.length-1]},this.clear=function(){t=[]},this.size=function(){return t.length},this.slice=function(n,i){return t.slice(n,i)}}i.exports=e});
;define("pan-timeline:widget/components/system/list/listInit/listRecycle.js",function(e,t,i){"use strict";var n=e("pan-timeline:widget/system/util/queue.js"),r={caculateLayout:function(e,t,i){if("function"==typeof t.caculateLayoutFunc)return t.caculateLayoutFunc.call(this,e,t);if("timeline"===t.recycleType){var n=r.caculateTimeLineRenderList(e,t,i);return n}if("classify"===t.recycleType){var n=r.caculateClassifyRenderList(e,t,i);return n}var n=r.caculateDefaultRenderList(e,t,i);return{listViewHeight:n.listViewHeight,renderList:n.renderList}},caculateDefaultRenderList:function(e,t,i){var n=t.itemObj||{},r=t.container;if("object"!=typeof r||!document.querySelector(r.dom))return{};var a=document.querySelector(r.dom)&&document.querySelector(r.dom).clientWidth,o=document.querySelector(".module-list-view"),l=(o.scrollHeight,o.scrollTop),u=o.clientHeight,c=n.height,h=n.width,s=("100%"===h?1:Math.floor(a/h))||5,d=Math.ceil(e.length/s),f=d*c,m=t.maxLineGap;"function"==typeof m&&(m=t.maxLineGap.call(this,r,n));var g=Math.ceil(u/c),p=Math.floor(l/c),y=Math.max(p-m,0),v=Math.min(p+g+m,d),L=s*h,M=y*s,w=v*s,x=[];if(null!=t.numLimitConf){var H=(t.numLimitConf||{maxInRenderGroup:10},t.numLimitConf.maxInRenderGroup),S=t.numLimitConf.maxInLineGroup;"function"==typeof S&&(S=S.call(this,r,n));var G=w/e.length>.7;null!=t.checkloadMore&&(G="function"==typeof t.checkloadMore?t.checkloadMore.call(this,e,w):t.checkloadMore),G&&i.dispatch(t.type+"/getListData",t);var T=H*c,q=Math.ceil(f/T),b=f%T,I=(v-y)*c;x=[];for(var j=y*c,C=Math.floor(j/T),k=Math.ceil((I+(j-C*T))/T),O=0;k>O&&!(M>=w);O++){x[O]=[];for(var R=[],D=(y-1)*c-(C+O)*T,F=Math.min(H-y%H,v-y),Q=0;F>Q;Q++){y++,R[Q]=[];for(var P=M,V=M=Math.min(P+S,e.length),B=e.slice(P,V),z=0;z<B.length;z++)B[z].top=0,B[z].left=z*h;R[Q]=B,R[Q].left=0,R[Q].width=L,R[Q].height=c,R[Q].top=D+=c}x[O]=R,x[O].left=0,x[O].width=L,x[O].top=(C+O)*T,x[O].height=x[O].top>=(q-1)*T?b:T}}return{listViewHeight:f,renderList:x}},caculateTimeLineRenderList:function(e,t,i){if(null!=e){var n=t.itemObj||{},a=t.resize,o=t.container;if(!document.querySelector(o.dom))return{};var l=document.querySelector(o.dom)&&document.querySelector(o.dom).clientWidth,u=document.querySelector(".module-list-view"),c=(u.scrollHeight,u.scrollTop),h=u.clientHeight,s=n.height,d=n.width,f=t.dayStr,m=t.renderHeightObj,g=t.groupHeightGap||0,p=t.numLimitConf.maxInLineGroup;"function"==typeof p&&(p=p.call(this,o,n));var y=t.numLimitConf.maxInRenderGroup,v=t.viewPortGapTimes;"function"==typeof v&&(v=t.viewPortGapTimes.call(this,o,n));var L,M,w,x,H=t.countList,S=t.countListForShow,G=t.dataInfo,T=function(e){H[e]=H[e]||{};var t=H[e].isTrusted,i=!1,n=null!=S&&null!=S[e]?S[e].count||0:H[e].count||0,r=H[e].count||0;n!==r&&0===n&&(i=!0);var a=!1;t||(n=n>100?101:Math.min(n,100)),t&&G[e].hasMore&&n>0&&(n++,a=G[e].isLoading);var o=!1;return(t&&G[e].hasMore&&n>0||!t&&n>100)&&(o=!0),{dayCount:n,needMoreBlock:o,loading:a,isHide:i}},q=H&&Object.keys(H).countingSort()||[],b=function(e,t,i,n){var r=Math.floor(n-(t-e)/s),a={day:q[i],curLine:r,index:i};return a},I=function(){var n,o=0,l=[],u=[];u[0]=[],u[0].top=0,u[0].left=0,u[0].width=C,u[0].height=0;for(var v=0,S=0,I=0,R=0,D=-1,F=(t.renderGroupObj,0),Q=F;Q<q.length;Q++){var P=q[Q];if(H.hasOwnProperty(P)){var V=e[P];if(null==V&&G&&G[P]&&G[P].isLoading===!1&&G[P].hasMore===!1){R=v;continue}var B=T(P),z=B.dayCount,W=(B.needMoreBlock,B.isHide),A=Math.ceil(z/p),E=g+A*s,J=A*s;if(f&&f===P){var K=m&&m[P]||0;x=E-K}if(o+=E,!m||null!=m[P]&&m[P]===E||i.commit("timeline/renderHeightObj",{dayStr:P,height:E}),null==L&&o>=k&&(L=b(k,o-g,Q,A),L.startPos=u[v].height,L.sumHeight=o-E,S=v,n=!0),null==M&&o>=c&&(M=b(c,o-g,Q,A),M.top=g>=o-c?o-c-g:0,M.scrollTop=E-(o-c),I=v),Q===q.length-1&&O>o&&(h>=o&&i.commit(t.type+"/setMoreDataForInit",{needMore:!0}),O=o),null==w&&o>=O&&(w=b(O,o-g,Q,A),R=v),n){var V=e[P];null!=M&&M.day===P,null==V?((null==G||null==G[P]||!G[P].isLoading&&0!=G[P].hasMore)&&r.enQueue(t.type,{func:function(e){e&&i.dispatch(e.type+"/getByCluster",{dayStr:e.dayStr})},params:{type:t.type,dayStr:P}}),V=Array.apply(null,{length:z}).map(function(){return{status:"isLoading"}})):B.needMoreBlock&&(V=e[P].concat(B.isLoading?{status:"isLoadingMore"}:{status:"needMore"}));var N=0,U=V.length;L&&Q===L.index&&(N=L.curLine*j),w&&Q===w.index&&(U=w.curLine*j);var X=[];if(X.dayDesc=P,X.left=0,X.top=u[v].height+g,X.width=C,X.height=J,!W)for(var Y=V.slice(N,U),Z=(N/j-1)*s,$=Math.ceil(U/j-N/j),_=0;$>_;_++){X[_]=[];for(var et=Math.min((_+1)*j,U),tt=Y.slice(_*j,et),it=0;it<tt.length;it++)tt[it].left=it*d,tt[it].top=0;X[_]=tt,X[_].left=0,X[_].width=C,X[_].height=s,X[_].top=Z+=s}u[v].push(X)}if(n!==!1&&(u[v].height+=E,D+=A,D>=y&&(v++,u[v]=[],u[v].top=o,u[v].height=0,D=-1),null!=w&&(n=!1)),n===!1){if(!a){o=null;break}if(f&&null!=x){o=m.sumHeight+x;break}}}}null!=o&&o>0&&i.commit("timeline/renderHeightObj",{sumHeight:o});var l=u.slice(S,R+1);return l.curDay=M,{listViewHeight:o,renderList:l}},j=("100%"===d?1:Math.floor(l/d))||5,C=d*j,k=Math.max(c-h*v,0),O=Math.min(c+h*v),R=I(H,G);return R}},caculateClassifyRenderList:function(e,t,i){var n=t.itemObj||{},r=t.resize,a=t.container;if(!document.querySelector(a.dom))return{};var o=t.listHeaderSlotGap||0,l=document.querySelector(a.dom)&&document.querySelector(a.dom).clientWidth,u=document.querySelector(".module-list-view"),c=(u.scrollHeight,Math.max(u.scrollTop-o,0)),h=u.clientHeight,s=n.height,d=n.width,f=t.countListForShow,m=t.groupHeightGap||0,g=t.numLimitConf.maxInLineGroup;"function"==typeof g&&(g=g.call(this,a,n));var p=t.viewPortGapTimes;"function"==typeof p&&(p=t.viewPortGapTimes.call(this,a,n));var y,v,L,M=t.numLimitConf.maxInRenderGroup,w=t.dataInfo,x=Object.keys(e).countingSort()||[],H=function(e,t,i,n){var r=Math.floor(n-(t-e)/s),a={day:x[i],curLine:r,index:i};return a},S=function(){var n,a=0,l=[],u=[];u[0]=[],u[0].top=0,u[0].left=0,u[0].width=T,u[0].height=0;for(var h=0,p=0,S=0,I=0,j=-1,C=(t.renderGroupObj,0),k=C;k<x.length;k++){var O=x[k];if(e.hasOwnProperty(O)){var R=e[O],D=null!=f&&null!=f[O]?f[O].count||0:R.length||0,F=R.length||0,Q=!1;D!==F&&0===D&&(Q=!0);var P=Math.ceil(D/g),V=m+P*s,B=P*s;if(a+=V,null==y&&a>=q&&(y=H(q,a-m,k,P),p=h,n=!0),null==v&&c>0&&a>=c&&(v=H(c,a-m,k,P),v.top=m>=a-c?a-c-m-o:c>0?0-o:null,v.scrollTop=V-(a-c),S=h),k===x.length-1&&b>a&&(b=a,w&&w.hasMore&&i.dispatch(t.type+"/getListData")),null==L&&a>=b&&(L=H(b,a-m,k,P),I=h),n){var R=e[O],z=0,W=R.length;y&&k===y.index&&(z=y.curLine*G),L&&k===L.index&&(W=L.curLine*G);var A=[];if(A.dayDesc=O,A.left=0,A.top=u[h].height+m,A.width=T,A.height=B,!Q)for(var E=R.slice(z,W),J=(z/G-1)*s,K=Math.ceil(W/G-z/G),N=0;K>N;N++){A[N]=[];for(var U=Math.min((N+1)*G,W),X=E.slice(N*G,U),Y=0;Y<X.length;Y++)X[Y].left=Y*d,X[Y].top=0;A[N]=X,A[N].left=0,A[N].width=T,A[N].height=s,A[N].top=J+=s}u[h].push(A)}if(n!==!1&&(u[h].height+=V,j+=P,j>=M&&(h++,u[h]=[],u[h].top=a,u[h].height=0,j=-1),null!=L&&(n=!1)),n===!1&&!r){a=null;break}}}var l=u.slice(p,I+1);return l.curDay=v,{listViewHeight:a,renderList:l}},G=("100%"===d?1:Math.floor(l/d))||5,T=d*G,q=Math.max(c-h*p,0),b=Math.min(c+h*p),I=S();return I},queue:[],getQueue:function(e){return r.queue[e]||(r.queue[e]=new n),r.queue[e]},enQueue:function(e,t){var i=r.getQueue(e);i.push(t),i.autoFlag||r.autoexecQueue(e,{start:-3})},autoexecQueue:function(e,t){var i=r.getQueue(e),n=i.size();if(n>0){i.autoFlag=!0;var a=t.start||0,o=t.end||n,l=i.slice(a,o),u=t.timeInterval||1e3,c=function(){for(var e=0;e<l.length;e++){var t=l[e];t.func(t.params)}i.clear()};i.autoTimer||(i.autoTimer=setInterval(function(){r.autoexecQueue(e,t)},u)),c()}else clearInterval(i.autoTimer),i.autoTimer=null,i.autoFlag=!1}},a={caculateLayout:r.caculateLayout};i.exports=a});
;define("pan-timeline:widget/store/componentsStore/list/index.js",function(e,t,s){"use strict";var n=e("base:thirdParty/vue/vue.js"),o=e("pan-timeline:widget/components/system/list/listInit/listRecycle.js"),i={processListStatus:function(e){return e.choosedItemArr.length>0?(e.headerOperateStatus=!0,e.listStatus=2):(e.headerOperateStatus=!1,e.listStatus=1),e.listStatus},isEmpty:function(e,t){return e&&e.hasMore===!1&&0===t.length?!0:!1}},r={vmode:null,defaultVmode:"list",currentListView:null,listStatus:0,allChoose:!1,chooseLength:0,lists:[],renderLists:[],choosedItemArr:[],chooesedItemMap:{},listViewHeight:null,listTip:{show:!1,tipContent:"",hasCloseBtn:!0,closeClassName:"",top:null,left:null,closeFunc:function(){}},contextMenu:{show:!1,top:0,left:0,index:-1},listEmpty:{show:!1,listEmptyComponent:null},showListHeader:!0,headerOperateStatus:!1,listHeaderOpDesc:null,checkStatusDesc:null,orderType:"time",sortOrder:!0,headerList:[],lock:!1,recycleListConf:{},mergeSimilar:!1,shiftStatus:!1,onMouseSelectFunc:null},u=JSON.parse(JSON.stringify(r)),a={getLock:function(e){return e.lock},getChooseLength:function(e){return e.chooseLength},getVmode:function(e){return e.vmode},getDefaultVmode:function(e){return e.defaultVmode},getCurrentListView:function(e){return e.currentListView},getListStatus:function(e){return e.listStatus},getListsData:function(e){return e.lists},getRenderLists:function(e){return e.renderLists},getListTip:function(e){return e.listTip},getListEmpty:function(e){return e.listEmpty},getAllChoose:function(e){return e.allChoose},getOrderType:function(e){return e.orderType},getSortOrder:function(e){return e.sortOrder},getHeaderOperateStatus:function(e){return e.headerOperateStatus},getHeaderList:function(e){return e.headerList},getChoosedItemArr:function(e){return e.choosedItemArr},getChooesedItemMap:function(e){return e.chooesedItemMap},getShowListHeader:function(e){return e.showListHeader},getListViewType:function(e){return e.listViewType},getListViewHeight:function(e){return e.listViewHeight},getListHeaderOpDesc:function(e){return e.listHeaderOpDesc},getCheckStatusDesc:function(e){return e.checkStatusDesc},getRecycleListConf:function(e){return e.recycleListConf},getContextMenu:function(e){return e.contextMenu},getMergeSimilar:function(e){return e.mergeSimilar},getShiftStatus:function(e){return e.shiftStatus},getOnMouseSelectFunc:function(e){return e.onMouseSelectFunc}},c={setStateInit:function(e){for(var t in u)if(u.hasOwnProperty(t)){var s=u[t];"object"==typeof s&&(s=JSON.parse(JSON.stringify(s))),n.set(e,t,s)}},setVmode:function(e,t){e.vmode=t.vmode,e.currentListView=t.currentListView},setChooseLength:function(e,t){e.chooseLength=t.chooseLength},setLock:function(e,t){e.lock=t.lock},setDefaultVmode:function(e,t){e.defaultVmode=t.defaultVmode},setListStatus:function(e,t){e.listStatus=t.listStatus},setListsData:function(e,t){e.lists=t.lists,i.processListStatus(e),i.isEmpty(t.listInfo,e.lists)&&t.emptyCb&&t.emptyCb()},setRenderLists:function(e,t){e.renderLists=t.renderLists},setListTip:function(e,t){var s=n.util.extend({show:!1,tipContent:"",hasCloseBtn:!0,closeClassName:"",top:null,left:null,closeFunc:function(){}},t);e.listTip=s},setListEmpty:function(e,t){var s=n.util.extend({show:!1,listEmptyComponent:null,emptyDesc:""},t);e.listEmpty=s,e.listStatus=-1},setAllChoose:function(e,t){e.allChoose=t.allChoose},setChooesedItemMap:function(e,t){e.chooesedItemMap=t.chooesedItemMap},setChoosedItemArr:function(e,t){e.choosedItemArr=t.choosedItemArr,e.chooseLength=e.choosedItemArr.length,i.processListStatus(e),e.headerOperateStatus=e.choosedItemArr.length>0?!0:!1},setOrderType:function(e,t){e.orderType=t.orderType},setSortOrder:function(e,t){e.sortOrder=t.sortOrder},setHeaderOperateStatus:function(e,t){e.headerOperateStatus=t.headerOperateStatus},setHeaderList:function(e,t){e.headerList=t.headerList},setListHeaderOpDesc:function(e,t){e.listHeaderOpDesc=t.listHeaderOpDesc},setCheckStatusDesc:function(e,t){e.checkStatusDesc=t.checkStatusDesc},setChoosedItem:function(e,t){e.choosedItemArr=t.choosedItemArr,e.chooesedItemMap=t.chooesedItemMap,e.headerOperateStatus=e.choosedItemArr.length>0?!0:!1},setShowListHeader:function(e,t){e.showListHeader=t.showListHeader},setListViewHeight:function(e,t){e.listViewHeight=t.listViewHeight},setItemsCheckedfalse:function(e){for(var t=e.choosedItemArr.length,s=e.lists,o=0;t>o;o++){var i=e.choosedItemArr[o];n.set(s[i],"choose",!1),n.util.remove(e.choosedItemArr,o),delete e.chooesedItemMap[i],o--,t--}e.listStatus=1},setRecycleListConf:function(e,t){e.recycleListConf=t.recycleListConf},setContextMenu:function(e,t){"undefined"!=typeof t.show&&(e.contextMenu.show=t.show,e.lock=t.show),"undefined"!=typeof t.top&&(e.contextMenu.top=t.top),"undefined"!=typeof t.left&&(e.contextMenu.left=t.left),"undefined"!=typeof t.index&&(e.contextMenu.index=t.index),"undefined"!=typeof t.date&&(e.contextMenu.date=t.date)},setMergeSimilar:function(e){e.mergeSimilar=!e.mergeSimilar},setShiftStatus:function(e,t){null!=t.shiftStatus&&(e.shiftStatus=t.shiftStatus)},setSomeHover:function(e,t){if(null!=t.start&&null!=t.end)for(var s=Math.min(t.start,t.end),o=Math.max(t.start,t.end)+1,i=0;i<e.lists.length;i++)i>=s&&o>i?n.set(e.lists[i],"shiftHover",!0):n.set(e.lists[i],"shiftHover",!1)},setOnMouseSelectFunc:function(e,t){"function"==typeof t.onMouseSelectFunc&&(e.onMouseSelectFunc=t.onMouseSelectFunc)}},l={triggerLayout:function(e,t){{var s=(e.state,e.commit);e.rootState}if(t.data&&t.params&&t.params.recycleListConf){var i=t.params.recycleListConf;delete t.params.recycleListConf;var r=n.util.extend(t.params,i),u=o.caculateLayout.call(this,t.data,r,e);u&&u.listViewHeight&&(null!=r.resize?r.resize===!0&&(s("setListViewHeight",{listViewHeight:u.listViewHeight}),"function"==typeof t.params.afterChangeHeight&&t.params.afterChangeHeight.call()):(s("setListViewHeight",{listViewHeight:u.listViewHeight}),"function"==typeof t.params.afterChangeHeight&&t.params.afterChangeHeight.call())),u&&u.renderList&&u.renderList.length>0&&(s("setRenderLists",{renderLists:u.renderList}),null!=t.dayStr&&s("timeline/setTimeLineDataInfo",{dayStr:dayStr,hasRendered:!0}),"function"==typeof t.params.afterLayoutFunc&&t.params.afterLayoutFunc.call())}},cancelAllChoose:function(e){for(var t=e.state,s=e.commit,o=t.choosedItemArr,i=0;i<o.length;i++){var r=o[i];n.set(r,"choose",!1)}s("setChoosedItem",{choosedItemArr:[],chooesedItemMap:{}})}};s.exports={state:r,getters:a,mutations:c,actions:l}});
;define("pan-timeline:widget/components/system/list/listLoading/listLoading.js",function(i,t,n){"use strict";var s=i("base:thirdParty/vue/vue.js"),e={init:function(){var i=s.component("list-loading",{name:"listLoading",template:'<div class="list-loading" v-if="show">\n    <svg class="spinner" width="26px" height="26px" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg">\n        <circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30" style="stroke:#09AAFF"></circle>\n    </svg>\n</div>\n',props:{show:{type:Boolean,"default":!1}}});return i}};n.exports=e.init()});
;define("pan-timeline:widget/components/system/list/listTip/listTip.js",function(t,i,s){"use strict";var n=t("base:thirdParty/vue/vue.js"),e={init:function(){var t=n.component("list-tip",{name:"listTip",template:'<div v-if="show" \n    class="list-tip-container"\n    :style="getTipPosition()">\n    <div class="list-tip-content">{{tipContent}}</div>\n    <div v-if="hasCloseBtn"\n        class="list-tip-close icon icon-close"\n        :class="closeClassName"\n        @click.stop="closeTip()">\n    </div>\n</div>',props:{show:{type:Boolean,"default":!1},tipContent:String,hasCloseBtn:{type:Boolean,"default":!0},closeClassName:String,top:String,left:String,closeFunc:Function},methods:{getTipPosition:function(){"number"==typeof this.top&&(this.top+="px"),"number"==typeof this.left&&(this.left+="px");var t=this.top||"0px",i=this.left||"0px";return"top:"+t+";left:"+i+";"},closeTip:function(){"function"==typeof this.closeFunc&&this.closeFunc.call(),this.show=!1}}});return t}};s.exports=e.init()});
;define("pan-timeline:widget/components/system/list/listHeader/listHeader.js",function(e,t,s){"use strict";var a=e("base:thirdParty/vue/vue.js"),l=e("base:thirdParty/vue/vuex.js"),n=l.mapGetters,r={init:function(){var e=a.component("list-header",{name:"listHeader",template:'<div v-if="show"\n    class="module-list-header-container">\n    <div class="module-list-header">\n        <template v-if="!headerOperateStatus">\n            <ul class="list-cols">\n                <li v-for="(headerItem, index) in headerList"\n                    :style="{width: headerItem.width, cursor: headerItem.order ? \'pointer\' : \'default\'}"\n                    :class="[index === 0 ? \'first-col\':\'\',\n                        index === headerList.length - 1 ? \'last-col\':\'\',\n                        headerItem.order ? \'col-hover\' : \'\', \'col\']"\n                    @click.stop="onListColsClick(headerItem);"\n                    :data-key="headerItem.key">\n                    <div v-if="hasAllChooseCK && index === 0"\n                        :class="[allChoose ? \'checked\' : \'\', \'col-item check\']"\n                        @click.stop="toggleAllChoose($event);">\n                        <span class="check-icon"></span>\n                        <span class="icon timeline-checksmall icon-checksmall"></span>\n                    </div>\n                    <span class="text">{{headerItem.name}}</span>\n                    <span v-if="headerItem.order && orderType === headerItem.key"\n                        class="header-order icon title-icon"\n                        :class="[sortOrder ? \'icon-up\' : \'icon-downtitle\']"></span>\n                    <span class="dataInfo">{{listHeaderOpDesc}}</span>\n                </li>\n            </ul>\n        </template>\n        <template  v-else>\n            <div class="list-header-operatearea global-clearfix">\n                <div v-if="hasAllChooseCK"\n                    :class="[allChoose ? \'checked\' : \'\', \'col-item check\']"\n                    @click.stop="toggleAllChoose($event);">\n                    <span class="check-icon"></span>\n                    <span  class="icon timeline-checksmall icon-checksmall"></span>\n                </div>\n                <span class="text">{{checkStatusDesc || defaultDesc}}</span>\n                <span class="dataInfo">{{listHeaderOpDesc}}</span>\n            </div>\n        </template>\n    </div>\n</div>',props:{show:{type:Boolean,"default":!1},headerList:Array,hasAllChooseCK:{type:Boolean,"default":!0},listColsClickFunc:Function},data:function(){return{defaultDesc:"全选"}},methods:{onListColsClick:function(e){var t=this;e.order!==!1&&(t.orderType===e.key?t.$store.commit("setSortOrder",{sortOrder:!t.sortOrder}):(t.$store.commit("setOrderType",{orderType:e.key}),t.$store.commit("setSortOrder",{sortOrder:!0})),"function"==typeof this.listColsClickFunc&&t.listColsClickFunc.call(t,e))},toggleAllChoose:function(){var e=this;this.$store.dispatch(this.routeType+"/toggleAllChoose"),this.$store.commit("setHeaderOperateStatus",{headerOperateStatus:!e.headerOperateStatus})},orderFunc:function(){}},computed:a.util.extend({},n({headerOperateStatus:"getHeaderOperateStatus",allChoose:"getAllChoose",orderType:"getOrderType",sortOrder:"getSortOrder",checkStatusDesc:"getCheckStatusDesc",listHeaderOpDesc:"getListHeaderOpDesc",routeType:"getRouteType",lists:"getListsData",listStatus:"getListStatus"}))});return e}};s.exports=r.init()});
;define("pan-timeline:widget/components/system/list/mouseSelect/mouseSelect.js",function(e,t,l){"use strict";var o=e("base:thirdParty/vue/vue.js"),n=e("base:thirdParty/vue/vuex.js"),i=e("base:widget/libs/jquerypacket.js"),s=e("base:widget/libs/underscore.js"),c=e("system-core:context/context.js").instanceForSystem,r=n.mapGetters,a={logFlag:{dragSelect:!0},init:function(){var e=o.component("mouse-select",{name:"mouseSelect",template:"<div v-if=\"showMouseSelect\"\n    class=\"mouse-select-mask\"\n    :class=\"maskClass\"\n    :style=\"{width: maskStyle.width + 'px', height: maskStyle.height + 'px',\n        left: maskStyle.left + 'px', top: maskStyle.top + 'px'}\">\n</div>",props:{type:String,container:String,item:String,onStart:Function,onEnd:Function,onSelect:Function,canSelect:Function,maskClass:String,scrollDom:String},data:function(){return{showMouseSelect:!1,needScroll:!1,maskStyle:null,isStart:!1,isMove:!1,clientX:null,clientY:null,scrollTopOld:null,inited:!0}},created:function(){if(this.offEvent(),this.bindEvent(),a.logFlag)for(var e in a.logFlag)a.logFlag.hasOwnProperty(e)&&(a.logFlag[e]=!0)},methods:{bindEvent:function(){var e,t=this,l=function(){return!1};null!=this.scrollDom&&(this.needScroll=!0),i(document).on("mousedown",t.container,function(e){if("INPUT"!==e.target.tagName){var o=!0;if(t.$emit("on-mouse-drag",o),t.needScroll){var n=i(t.scrollDom);t.scrollTopOld=n.scrollTop()+i(document).scrollTop()}1===e.which&&(null==t.onStart||t.onStart(e))&&(i(document).delegate(t.container,"selectstart",l),t.isStart=!0,t.clientX=e.clientX,t.clientY=e.clientY)}}),i(document).on("mouseup",function(){return i(document).undelegate(t.container,"selectstart",l),t.isMove?(t.isMove=!1,t.isStart=!1,t.showMouseSelect=!1,null!=t.onEnd&&t.onEnd(t.maskStyle),null!=t.maskStyle&&a.logFlag.dragSelect&&(c.log.send({type:"web_album_newlist_drag_select",logFrom:t.type}),a.logFlag.dragSelect=!1),void(t.maskStyle=null)):void(t.isStart=!1)}),i(document).on("mousemove",function(l){var o=!1;if(t.$emit("on-mouse-drag",o),t.isStart){l.stopPropagation(),l.preventDefault();var n,c,r,a,u;if(null!=t.onSelect&&t.inited&&(e=s.throttle(function(e){t.onSelect(e)},80),t.inited=!1),window.getSelection&&window.getSelection().removeAllRanges(),n=l.clientX-t.clientX,c=l.clientY-t.clientY,t.needScroll){var d=i(t.scrollDom),m=d.scrollTop(),h=i(".module-list-init").offset();h.height=i(".module-list-init").height(),h.width=i(".module-list-init").width(),c=l.clientY+m+i(document).scrollTop()-t.clientY-t.scrollTopOld,u=i(window).height(),l.clientY+5>=u?d.scrollTop(m+20):l.clientY<=h.top&&m>0&&d.scrollTop(m-20)}if(!t.isMove&&(Math.abs(n)>5||Math.abs(c)>5)&&(t.isMove=!0),t.isMove){var h=i(".module-list-init").offset();h.height=i(".module-list-init").height(),h.width=i(".module-list-init").width(),l.preventDefault();var g=t.clientX,p=t.clientY,S=n,f=c;if(t.needScroll){var d=i(t.scrollDom);p=t.clientY-d.scrollTop()+t.scrollTopOld}0>n&&(g+=n,S=-n),0>c&&(p+=c,f=-c);var v=t.maskStyle={top:p,left:g,width:S,height:f};r=t.clientX,a=t.clientY;var w=l.clientX;w<h.left?w=h.left:w>h.left+h.width&&(w=h.left+h.width);var y=l.clientY;n=w-t.clientX,c=y-t.clientY;var d=i(t.scrollDom);t.needScroll&&(a=t.clientY-(d.scrollTop()-t.scrollTopOld)),0>n&&(r+=n,n=-n),0>c&&(a+=c),a<h.top&&(a=h.top),l.clientY+5>=h.top+h.height?c+=Math.abs(d.scrollTop()-t.scrollTopOld):c=0>c?t.clientY-(d.scrollTop()-t.scrollTopOld)-l.clientY:l.clientY-a,c=Math.abs(c),c>h.height&&(c=h.height),t.showMouseSelect||(t.showMouseSelect=!0),null!=e&&e(v)}}})},offEvent:function(){i(document).off("mousedown",this.container),i(document).off("mouseup"),i(document).off("mousemove")}},computed:o.util.extend({},r({}))});return e}};l.exports=a.init()});
;define("pan-timeline:widget/components/system/list/listInit/listUtil.js",function(t,s,e){var i=t("pan-timeline:widget/store/index.js"),n=t("system-core:context/context.js").instanceForSystem,o=t("pan-timeline:widget/components/emptyList/EmptyList.js"),m={defaultErrCB:function(t){i.commit("setTip",{show:!0,msg:n.errorMsg(t),status:"caution",autoClose:!0})},showListEmpty:function(t){i.commit("setListEmpty",{show:!0,listEmptyComponent:o,emptyDesc:t||"你的网盘中暂无照片"})}};e.exports=m});
;define("pan-timeline:widget/components/system/VerticalButton/VerticalButton.js",function(t,e,n){var o=t("base:thirdParty/vue/vue.js"),r=o.component("pan-vertical-button",{name:"VerticalButton",template:'<div class="vertical-button" :class="{noborder: noborder}">\n  <slot></slot>\n</div>\n',props:["noborder"]});n.exports=r});
;define("pan-timeline:widget/components/contextMenu/contextMenu.js",function(e,t,s){"use strict";var n=e("base:widget/libs/jquerypacket.js"),o=e("base:thirdParty/vue/vue.js"),i=e("base:thirdParty/vue/vuex.js"),a=e("system-core:context/context.js").instanceForSystem,l=e("base:widget/tools/service/tools.path.js"),r=e("pan-timeline:widget/components/system/Button/Button.js"),u=e("pan-timeline:widget/components/system/VerticalButton/VerticalButton.js"),c=e("pan-timeline:widget/system/uiRender/panButton/panButton.js"),m=e("pan-timeline:widget/components/emptyList/EmptyList.js"),p=i.mapGetters,h={init:function(){var e=o.component("contextMenu",{name:"contextMenu",template:'<div class="module-contextMenu" v-if="contextMenu.show" :style="position">\n    <pan-vertical-button :noborder="verticalInfo.verticalNoborder" :color="verticalInfo.color">\n        <template v-for="(item, index) in buttons">\n            <pan-button\n            v-for=" (m, index) in item"\n            v-if="m.show == null || m.show === true"\n            :text="m.text"\n            :size="m.size"\n            :styleObj="m.styleObj"\n            :menus="m.menus"\n            @on-click="callsPlugin(m.pluginName)"\n            @on-menu-click="callsPlugin"></pan-button>\n            <div class="line" v-if="index != (buttons.length - 1)"></div>\n        </template>\n    </pan-vertical-button>\n</div>',data:function(){var e=this;return{buttons:[[{text:"打开",size:"small",pluginName:"open",styleObj:{color:"#666"},menus:[]},{text:"下载",size:"small",pluginName:"download",styleObj:{color:"#666"},menus:[]},{text:"分享",size:"small",pluginName:"share",styleObj:{color:"#666"},menus:[]}],[{text:"人脸搜索",size:"small",pluginName:"facesearch",show:!0,styleObj:{color:"#666"},menus:[],showFun:function(){return e.faceStatus}},{text:"云冲印",size:"small",pluginName:"cloudprint",styleObj:{color:"#666"},menus:[],showFun:function(){return!1}},{text:"美化",size:"small",pluginName:"puzzle",numSpecial:{text:["美化","拼图"],limit:1},styleObj:{color:"#666"},menus:[]}],[{text:"复制到",size:"small",pluginName:"copy",styleObj:{color:"#666"},menus:[]},{text:"移动到",size:"small",pluginName:"move",styleObj:{color:"#666"},menus:[]},{text:"修改分类",pluginName:"imageClassify",size:"small",styleObj:{color:"#666"},menus:[],pageModule:["classifyList","faceList"],showFun:function(){return 1===e.choosedItemArr.length}}],[{text:"删除",size:"small",pluginName:"delete",styleObj:{color:"#666"},menus:[]},{text:"移出",size:"small",pluginName:"remove",styleObj:{color:"#666"},menus:[],pageModule:["classifyList","faceList"],showFun:function(){return e.isNewApi&&e.isAffair}},{text:"查看文件夹",size:"small",pluginName:"path",styleObj:{color:"#666"},menus:[]}]],verticalInfo:{verticalNoborder:!0},isNewApi:this.$store.getters.getIsNewVersion,isAffair:!1}},props:{},components:{"pan-button":r,"pan-vertical-button":u},methods:{callsPlugin:function(e){var t="",s=this,n={};switch(e){case"share":t="shareFiles","classifyList"!==this.routeType&&a.log.send({type:"web_album_timeline_share",value:"",sendServerLog:!0});break;case"download":t="downloadFiles","classifyList"!==this.routeType&&a.log.send({type:"web_album_timeline_download",value:"",sendServerLog:!0});break;case"delete":t="deleteFiles",n.emptyCb=this.emptyCb,this.routeType&&a.log.send({type:"web_album_timeline_delete",value:"",sendServerLog:!0});break;case"remove":t="removeFromTag",n.emptyCb=this.emptyCb,n.params={tag_id:s.$route.params.tagId||s.$route.params.clusterType},n.succCb=function(){s.$store.commit("setTip",{show:!0,msg:"全部移出成功",status:"success",autoClose:!0,closeBtn:!1})},n.errCb=this.errCb,this.routeType&&a.log.send({type:"web_album_timeline_remove",value:"",sendServerLog:!0});break;case"facesearch":t="facesearch",this.routeType&&a.log.send({type:"web_album_timeline_facesearch",value:"",sendServerLog:!0});break;case"cloudprint":t="cloudprint",this.routeType&&a.log.send({type:"web_album_timeline_cloudprint",value:"",sendServerLog:!0});break;case"puzzle":t="puzzleFiles",this.routeType&&a.log.send({type:"web_album_timeline_puzzle",value:"",sendServerLog:!0});break;case"iamge":t="iamgeFiles";break;case"imageClassify":t="imageClassify",n.isNewApi=this.isNewApi,n.isNewApi||(n.emptyCb=this.emptyCb);break;case"open":t="openFiles";var o=null;if("recentUpload"===this.routeType){var i=this.contextMenu.index;o=this.lists[i]}else{var r=this.contextMenu.index,u=this.contextMenu.date;o=this.timeLineDataList[u][r]}n.fileinfo=o;break;case"copy":t="copyFiles",this.routeType&&a.log.send({type:"web_album_timeline_copy",value:"",sendServerLog:!0});break;case"move":t="moveFiles",this.routeType&&a.log.send({type:"web_album_timeline_move",value:"",sendServerLog:!0});break;case"path":this.$store.commit("setContextMenu",{show:!1});var c=this.choosedItemArr[this.choosedItemArr.length-1],m=l.parseFullDirFromPath(c.path);return m=m?m:"/",void window.open("//pan.baidu.com/disk/home#dir/path="+encodeURIComponent(m))}this.$store.commit("setContextMenu",{show:!1}),this.$store.dispatch(t,n)},emptyCb:function(){var e=this;e.$store.commit("setListEmpty",{show:!0,listEmptyComponent:m,emptyDesc:e.emptyDesc||"暂无内容，去浏览其他照片吧~"}),this.$route.commit("setListStatus",{listStatus:-1})},handleButtons:function(){for(var e=this,t=function(t){var s=c.handleSpecifiedPageModuleButton(t,e.routeType),n=c.handleSpecifiedNumSpecialButton(t,e.chooseLen),i=t.showFun?t.showFun():!0;s&&n&&i?o.set(t,"show",!0):o.set(t,"show",!1)},s=e.buttons,n=s.length,i=0;n>i;i++)for(var a=s[i],l=a.length,r=0;l>r;r++){var u=a[r];(u.pageModule||u.showFun||u.numSpecial)&&t(u)}}},created:function(){var e=1===+this.$route.params.classifyType?!0:!1;this.isAffair=e},computed:o.util.extend(p({lock:"getLock",choosedItemArr:"getChoosedItemArr",routeType:"getRouteType",contextMenu:"getContextMenu",lists:"getListsData",timeLineDataList:"getTimeLineDataList",faceStatus:"getFaceSearch",listInfo:"getListInfo"}),{chooseLen:function(){return this.choosedItemArr.length},position:function(){var e=n(".frame-main").height(),t=e-this.contextMenu.top,s={left:this.contextMenu.left+"px"};return this.contextMenu.top<=t?s.top=this.contextMenu.top+"px":s.bottom=t+"px",s},show:function(){return this.contextMenu.show}}),watch:{show:function(e,t){var s=this;e===!0&&t===!1&&n("body").on("click",function(){s.$store.commit("setContextMenu",{show:!1}),n("body").off("click",function(){})})},chooseLen:function(e){e>0?this.handleButtons():this.$store.commit("setContextMenu",{show:!1})},$route:{handler:function(e){this.isAffair=e.params&&1===+e.params.classifyType?!0:!1},deep:!0},listInfo:{handler:function(e){this.isAffair=e&&1===e.type?!0:!1},deep:!0}}});return e}};s.exports=h.init()});
;define("pan-timeline:widget/components/system/list/listInit/listInit.js",function(t,e,i){"use strict";var s=t("base:thirdParty/vue/vue.js"),n=t("base:thirdParty/vue/vuex.js"),o=t("pan-timeline:widget/store/componentsStore/list/index.js"),l=t("system-core:context/context.js").instanceForSystem,a=t("pan-timeline:widget/components/system/list/listLoading/listLoading.js"),r=t("pan-timeline:widget/components/system/list/listTip/listTip.js"),c=t("pan-timeline:widget/components/system/list/listEmpty/listEmpty.js"),u=t("pan-timeline:widget/components/system/list/listHeader/listHeader.js"),m=t("pan-timeline:widget/components/system/list/mouseSelect/mouseSelect.js"),p=t("pan-timeline:widget/components/system/list/listInit/listUtil.js"),d=t("pan-timeline:widget/components/emptyList/EmptyList.js"),h=t("base:widget/libs/underscore.js"),w=t("base:widget/libs/jquerypacket.js"),y=t("pan-timeline:widget/store/index.js"),g=t("pan-timeline:widget/components/contextMenu/contextMenu.js"),f=n.mapGetters,L="pan-timeline:widget/components/system/listView/",v={list:"normalListView",grid:"gridView",timeline:"timelineView"},C={logFlag:{whiteAreaCancel:!0},conf:{initedViewCount:0},listView:{},util:{checkListView:function(t){return"string"==typeof t&&Object.keys(v).indexOf(t)>-1?!0:!1},checkInitedListView:function(t){return C.util.checkListView(t)&&null!=C.listView[v[t]]?!0:!1}},setListViewComponents:function(){},initListView:function(e,i){var s=this;if(Array.isArray(e))for(var n=0;n<e.length;n++){var o=e[n],l=v[o];if(C.util.checkListView(o)){var a=L+l+"/"+l+".js";t.async(a,function(t){C.listView[l]=t.init.call(s),++C.conf.initedViewCount>=e.length&&i.call(s)})}}},initList:function(){y.registerModule("list",o),C.listInitVM=s.component("listInit",{name:"listInit",template:'<div class="module-list" v-dynamic-class="listViewClass">\n    <list-loading :show="listStatus === 0"></list-loading>\n    <context-menu></context-menu>\n    <list-header :show="headerList != null && listStatus >= 0"\n        :headerList="headerList"\n        :hasAllChooseCK="hasAllChooseCK"\n        :listColsClickFunc="listColsClickFunc"></list-header>\n    <div class="module-list-view" \n    v-if="listStatus >= 0"\n        @keyup.stop.prevent="lockProcessFunc($event);"\n        @mousewheel="scrollList($event);"\n        @DOMMouseScroll="scrollList($event);"\n        @scroll="scrollList($event);">\n        <slot name="list-header-slot"></slot>\n        <component v-if="currentListView"\n            :is="currentListView" \n            :listViewType="listViewType"\n            :listViewClass="listViewClass"\n            :loadMoreDataInDay="loadMoreDataInDay"\n            :scrollListFunc="scrollListFunc"\n            :resizeEventFunc="resizeEventFunc"\n            :listItemComp="listItemComp"\n            :mouseSelectFunc="mouseSelectFunc"\n            :showRuler="showRuler"\n            :listItemClick="listItemClick"\n            :type="type"\n            :listContainer="scrollDom"\n            :listTitleCheckFunc="listTitleCheckFunc"></component>\n        <mouse-select\n            :type="type"\n            :container="listViewContainer"\n            :scrollDom="scrollDom"\n            :onSelect="onSelect"\n            @on-mouse-drag="changeMouseDragFlag"></mouse-select>\n    </div>\n    <list-empty :show="listEmpty.show"\n        :emptyDesc="listEmpty.emptyDesc"\n        :listEmptyComponent="listEmpty.listEmptyComponent"></list-empty>\n    <list-tip :show="listTip.show"\n        :tipClassName="listTip.tipClassName"\n        :tipContent="listTip.tipContent"\n        :hasCloseBtn="listTip.hasCloseBtn"\n        :closeClassName="listTip.closeClassName"\n        :closeFunc="listTip.closeFunc"\n        :left="listTip.left"\n        :top="listTip.top"></list-tip>\n</div>',data:function(){return{scrollDom:".module-list-view",lockProcessFunc:function(){},notDraging:!0}},props:{listView:Array,headerList:Array,hasAllChooseCK:Boolean,listColsClickFunc:Function,listHeaderOpDesc:String,orderType:String,listViewType:Number,listViewClass:String,type:String,recycleListConf:Object,loadMoreDataInDay:Function,scrollListFunc:Function,resizeEventFunc:Function,listItemComp:Function,mouseSelectFunc:Function,showRuler:Boolean,listItemClick:Function,listViewContainer:String,userArea:Array,emptyDesc:{type:String,"default":"你的网盘中暂无照片"},listTitleCheckFunc:Function},components:s.util.extend({"list-loading":a,"list-tip":r,"list-empty":c,"list-header":u,"context-menu":g,"mouse-select":m},C.listView),methods:{getListData:function(){var t=this,e={};1===this.listViewType&&(e={type:this.type});var i=function(){t.$store.commit("setListEmpty",{show:!0,listEmptyComponent:d,emptyDesc:t.emptyDesc||"你的网盘中暂无照片"})},s=function(t){p.defaultErrCB(t)};e.emptyCb=i,e.errCb=s,null==this.routeType&&this.$store.commit("setRouteType",{routeType:this.$route.name}),this.$store.dispatch(this.routeType+"/getListData",e)},setListMode:function(){var t=this,e=this.$route,i=e.params.vmode;if(t.vmode!==i){if(null==i||!C.util.checkInitedListView(i)){i=t.listView&&t.listView.length&&t.listView[0]||t.defaultVmode;{({name:e.name,params:{vmode:i}})}}this.$store.commit("setVmode",{vmode:i,currentListView:v[i]})}this.$store.commit("setRecycleListConf",{recycleListConf:t.recycleListConf})},initListHeader:function(){null!=this.headerList&&this.$store.commit("setShowListHeader",{showListHeader:!0})},layoutThrottle:h.throttle(function(t){this.$store.dispatch("triggerLayout",{data:this.lists,params:{recycleListConf:this.recycleListConf,resize:t}})},80),scrollList:function(t){return this.lock?(t.preventDefault&&t.preventDefault(),t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),!1):"function"==typeof this.scrollListFunc?void this.scrollListFunc.call(this):void this.layoutThrottle.call(this)},resizeEvent:function(){return"function"==typeof this.resizeEventFunc?void this.resizeEventFunc.call(this):void this.layoutThrottle.call(this,!0)},setShiftStatus:function(t,e){var i=t.keyCode||t.which||t.charCode;16===i&&(this.$store.commit("setShiftStatus",{shiftStatus:e}),e===!1&&(this.$store.commit("setSomeHover",{start:-1,end:-1}),this.$store.dispatch("timeline/setSomeHover")))},changeMouseDragFlag:function(t){null!=t&&(this.notDraging=t)},initEvent:function(){var t=this;window.onresize=function(){t.resizeEvent()},window.addEventListener("keydown",function(e){t.setShiftStatus(e,!0)}),window.addEventListener("keyup",function(e){t.setShiftStatus(e,!1)}),this.listViewContainer&&w(this.listViewContainer).bind("click",function(e){if(t.notDraging&&2===t.listStatus){for(var i=w(e.target),s=[".listheader-container",".content-item"],n=this.userArea||[],o=s.concat(n),a=!0,r=0;r<o.length;r++){var c=o[r],u=i.parents(c).length<=0;u||(a=!1)}if(a){var m=t.routeType;t.$store.dispatch(m+"/cancelAllChoose"),C.logFlag.whiteAreaCancel&&(l.log.send({type:"web_album_newlist_white_area_cancel",logFrom:t.type}),C.logFlag.whiteAreaCancel=!1)}}})}},beforeCreate:function(){},mounted:function(){var t=this;C.initListView(this.listView,function(){t.$store.commit("setDefaultVmode",{defaultVmode:t.listView[0]}),t.setListMode()}),t.getListData(),t.initEvent()},created:function(){if(C.logFlag)for(var t in C.logFlag)C.logFlag.hasOwnProperty(t)&&(C.logFlag[t]=!0)},destroyed:function(){var t=this;window.onresize=null,window.removeEventListener("keydown",function(e){t.setShiftStatus(e,!0)}),window.removeEventListener("keyup",function(e){t.setShiftStatus(e,!1)})},watch:{lock:function(t){this.lockProcessFunc=t?function(t){var e=t.keyCode||t.which||t.charCode;return 38===e||40===e?(t.preventDefault&&t.preventDefault(),t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),!1):void 0}:function(){}},$route:function(){this.setListMode()}},computed:s.util.extend({},f({vmode:"getVmode",defaultVmode:"getDefaultVmode",currentListView:"getCurrentListView",listStatus:"getListStatus",lists:"getListsData",renderLists:"getRenderLists",listTip:"getListTip",listEmpty:"getListEmpty",headerOperateStatus:"getHeaderOperateStatus",showListHeader:"getShowListHeader",timeLineDataList:"getTimeLineDataList",routeType:"getRouteType",onSelect:"getOnMouseSelectFunc",lock:"getLock"}))})}};C.initList(),i.exports=C.listInitVM});
;define("pan-timeline:widget/components/classifyModify/classifyModify.js",function(t,s,e){var i=t("base:thirdParty/vue/vue.js"),a=t("base:thirdParty/vue/vuex.js"),n=a.mapGetters,l=t("base:widget/libs/underscore.js"),c=t("system-core:context/context.js").instanceForSystem,o=t("pan-timeline:widget/api/classifyModify/getlist.js"),d=t("pan-timeline:widget/components/emptyList/EmptyList.js");t("pan-timeline:widget/components/system/Dialog/Dialog.js");var r={init:function(){var t=i.component("classify-modify",{name:"classify-modify",template:'\n<pan-dialog title="修改分类" :type="\'window\'" :width="classifyModifyDlg[\'width\']" :open="classifyModifyDlg[\'isShow\']" :footFixed="classifyModifyDlg[\'footFixed\']" :closeMethod="classifySelect">\n    <div slot="body">\n        <div class="classify-modify-box">\n            <!-- 结果区域 -->\n            <div class="classify-select-result">\n                <p class="result-title">已选分类</p>\n                <div class="result-area">             \n                    <div class="result-btn" v-for="(result, indexCancel) in selectedTags[\'dataList\']">\n                        <p>{{result[\'classify\'][\'tag_name\']}}</p>\n                        <div class="result-btn-close icon icon-classify-modify-remove"\n                        @click.stop="cancelSelect(indexCancel)"></div>\n                    </div>\n                </div>\n            </div>\n            <!-- 选择区域 -->\n            <div class="classify-select-box">\n                <div class="category-box" v-for="(item, indexBase) in labelTags">\n                    <p class="category-tip">{{item[\'type_name\']}}</p>\n                    <div class="category-set">\n                        <p :class="[selectedTags[\'typeList\'].indexOf(element[\'tag_id\']) !== -1 ? \'classify-btn-active\' : \'classify-btn-inactive\', \'classify-btn\']" \n                        v-for="(element, index) in labelTags[indexBase][\'tags\']"\n                        @click.stop="selectClassifyBtn(element, indexBase, index)">{{element[\'tag_name\']}}</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div slot="footer">\n        <pan-button text="是" color="blue" size="large" :disabled="hasOption"@on-click="classifySelect(\'complete\')"></pan-button>\n        <pan-button text="否" size="large" @on-click="classifySelect(\'abandon\')"></pan-button>\n    </div>\n</pan-dialog>\n',data:function(){return{labelTags:[],selectedTags:{typeList:[],dataList:[]}}},computed:i.util.extend({hasOption:function(){var t=this.selectedTags.typeList.length>0?!1:!0;return t}},n({classifyModifyDlg:"getClassifyModify",targetImgClassify:"getTargetImgClassify"})),watch:{targetImgClassify:function(t){if(t&&t.length>0){var s=[],e=[],i=3,a=0;this.labelTags.forEach(function(n,l){n.tags.forEach(function(n,c){i>a&&-1!==t.indexOf(n.tag_id)&&(s.push(n.tag_id),e.push({classify:n,index:c,indexBase:l}),a++)})},this),this.selectedTags={typeList:s,dataList:e}}}},created:function(){this.getLabelTags()},methods:{errCb:function(t){this.$store.commit("setTip",{show:!0,msg:c.errorMsg(t),status:"caution",autoClose:!0,closeBtn:!0})},emptyCb:function(){var t=this;this.$store.commit("setListEmpty",{show:!0,listEmptyComponent:d,emptyDesc:t.emptyDesc||"暂无内容，去浏览其他照片吧~"}),this.$route.commit("setListStatus",{listStatus:-1})},getLabelTags:function(){var t=this,s=function(s){s&&0===s.errno&&l.isArray(s.tags)&&s.tags.length>0?t.labelTags=s.tags:t.errCb(s.errno)};o.getLabelTag().then(s).catch(function(){t.errCb()})},selectClassifyBtn:function(t,s,e){var i=this.selectedTags.typeList,a=this.selectedTags.dataList,n={classify:t,indexBase:s,index:e};i.length<3?-1===i.indexOf(t.tag_id)&&(i.push(t.tag_id),a.push(n)):this.$store.commit("setTip",{show:!0,msg:"只能选择3个分类哦",status:"caution",autoClose:!0,closeBtn:!0})},cancelSelect:function(t){this.selectedTags.typeList.splice(t,1),this.selectedTags.dataList.splice(t,1)},classifySelect:function(t){var s=this,e=this.selectedTags.typeList,i=function(){var t={isShow:!1},e={tagList:[]};s.$store.commit("setTargetImgClassify",e),s.$store.commit("setClassifyModify",t)};if("complete"===t&&e.length>0){var a=parseInt(this.$route.params.clusterType,10),n={params:{dst_tag:JSON.stringify(e)},currentTag:a,emptyCb:this.emptyCb,errCb:this.errCb};i(),this.$store.dispatch("classifyModifyOperate",n),c.log.send({type:"web_album_modify_classify"})}else i();this.initSelectedTags()},initSelectedTags:function(){this.selectedTags={typeList:[],dataList:[]}}}});return t}};e.exports=r.init()});
;define("pan-timeline:widget/components/classifyList/classifyList.js",function(t,i,e){"use strict";var s=t("base:thirdParty/vue/vue.js"),n=t("base:thirdParty/vue/vuex.js"),o=t("base:widget/libs/underscore.js"),l=t("pan-timeline:widget/components/system/list/listInit/listInit.js"),a=t("pan-timeline:widget/components/topToolBar/topToolBar.js"),r=t("pan-timeline:widget/store/index.js"),c=(t("pan-timeline:widget/components/system/list/listInit/listRecycle.js"),t("pan-timeline:widget/components/emptyList/EmptyList.js")),m=t("pan-timeline:widget/components/system/list/listInit/listUtil.js"),u=(t("pan-timeline:widget/components/classifyModify/classifyModify.js"),n.mapGetters),f=n.mapActions,p=o.throttle(function(t){r.dispatch("classifyList/triggerLayout",{resize:t||!1})},80),y={init:function(){var t=s.component("classifyList",{name:"classifyList",template:'<div class="module-classifyList module-type">\n    <topToolBar></topToolBar>\n    <div class="module-list-init">\n        <list-init\n            :listView="listView"\n            :hasAllChooseCK="hasAllChooseCK"\n            :listColsClickFunc="listColsClickFunc"\n            :listViewType="listViewType"\n            :listViewClass="listViewClass"\n            :recycleListConf="recycleListConf"\n            :scrollListFunc="scrollListFunc"\n            :resizeEventFunc="resizeEventFunc"\n            :listViewContainer="listViewContainer"\n            :userArea="userArea"\n            :emptyDesc="errorMsg"\n            :type="type"></list-init>\n    </div>\n    <classify-modify></classify-modify>\n</div>\n',data:function(){return{errorMsg:"暂无内容，去浏览其他照片吧~",listView:["timeline"],hasAllChooseCK:!1,listColsClickFunc:function(){},listViewType:1,listViewClass:"",listViewContainer:".module-list-init",userArea:[".timeline-title",".timeline-ruler"],type:"classifyList",recycleListConf:{recycleType:"classify",type:"classifyList",container:{dom:".module-timeline-view"},numLimitConf:{maxInRenderGroup:20,maxInDayGroup:function(t,i){var e=10;return Math.floor(document.querySelector(t.dom).clientWidth/i.width)*e},maxInLineGroup:function(t,i){return Math.floor(document.querySelector(t.dom).clientWidth/i.width)},minItem:function(){}},itemObj:{width:160,height:160},viewPortGapTimes:function(t,i){var e=Math.floor(document.querySelector(t.dom).clientWidth/i.width);return e>6?2:2},groupHeightGap:40},scrollListFunc:function(){p.call(this)},resizeEventFunc:function(){p.call(this,!0)},getClusterName:function(t){var i=this.$route,e=(i.name,i.params.clusterType),s=t&&t[e]&&t[e].tag_name;return null!=s?(this.$store.commit("setGoBackName",{goBackName:s}),!0):!1},setBoBackName:function(){(this.formatAffairLists||this.formatPositionLists)&&(this.getClusterName(this.formatAffairLists)||this.getClusterName(this.formatPositionLists))}}},components:{ListInit:l,topToolBar:a},beforeCreate:function(){},created:function(){var t=this.$route,i=(t.name,t.params.clusterType);this.$store.commit("timeline/setCurType",{curType:"classifyList"}),this.$store.commit("classifyList/setCluster",{cluster:i}),this.initClassifyData||this.$store.dispatch("classify/getClassifyData")},methods:s.util.extend({},f({panTipClick:"panTipClick"})),activated:function(){this.$store.commit("timeline/setCurType",{curType:"classifyList"}),this.$store.commit("setRecycleListConf",{recycleListConf:this.recycleListConf}),this.$store.dispatch(this.routeType+"/getListData")},mounted:function(){this.setBoBackName()},watch:{formatAffairLists:function(t){this.getClusterName(t)},formatPositionLists:function(t){this.getClusterName(t)},$route:function(){var t=this,i={},e=function(){t.$store.commit("setListEmpty",{show:!0,listEmptyComponent:c,emptyDesc:t.errorMsg})},s=function(t){m.defaultErrCB(t)},n=t.$route,o=n.params.clusterType;t.$store.commit("classifyList/setCluster",{cluster:o}),i.emptyCb=e,i.errCb=s,this.$store.dispatch(this.routeType+"/getListData",i),this.setBoBackName()}},computed:s.util.extend(u({tip:"getTip",routeType:"getRouteType",initClassifyData:"getDataFlag",formatAffairLists:"getFormatAffairlists",formatPositionLists:"getFormatPositionlists"}),{})});return t}};e.exports=y.init()});
;define("pan-timeline:widget/components/system/Tip/Tip.js",function(t,n,s){var e=t("base:thirdParty/vue/vue.js"),i=e.component("pan-tip",{name:"tip",template:'<transition name="tip-fade">\n<div class="pan-tip"\n    :class="tipStatus"\n    v-if="tipShow" v-transclude >\n    <i v-if="useSVGList.indexOf(status) !== -1"\n    class="tip-icon icon" :class="[statusIcon,\'icon-\' + status]"></i>\n    <i v-else\n    class="tip-icon tip-icon-loading" :class="[\'icon-\' + status]"></i>\n    <span class="tip-msg" v-html="msg"></span>\n    <template v-if="processtype === \'bar\'">\n        <!-- 有进度条的样式 -->\n        <span class="tip-process" v-if="processShow">\n            <span class="tip-process-inner" :style="{width: process}"></span>\n        </span>\n        <span class="tip-process-text" v-if="processShow">{{process}}</span>\n    </template>\n    <template v-else>\n        <!-- 没有进度条的样式 -->\n        <span class="tip-process-text" v-if="processShow">{{process}}</span>\n    </template>\n    <span class="tip-enterance" v-if="enteranceShow">\n        <a class="tip-enterance-link" :href="enterance.href" @click.stop="loadPage">{{enterance.text}}</a>\n    </span>\n    <span class="tip-link" v-if="linkShow" @click.stop="onlinkClick">{{linkmsg}}</span>\n    <span v-if="closebtn" class="tip-closeBtn icon tip-icon icon-close" @click.stop="onClick"></span>\n</div>\n</transition>',props:{show:{type:Boolean,"default":!1},identify:{type:String,"default":""},status:{type:String,"default":""},msg:{type:String,"default":""},processnum:{type:Number,"default":0},processtype:{type:String,"default":"percent"},enterance:{type:Object,"default":{}},closebtn:{type:Boolean,"default":!1},linkmsg:{type:String,"default":""},tipname:{type:String,"default":""},icon:{type:String,"default":""}},data:function(){return{marginLeft:"0",useSVGList:["caution","success"]}},created:function(){},computed:{identifyIcon:function(){return"svip"===this.identify||"vip"===this.identify?"sprite"+this.identify+"ic":""},linkShow:function(){return this.linkmsg.length>0?!0:!1},statusIcon:function(){return this.icon?"icon-tips-"+this.icon:this.status.length>0?"icon-tips-"+this.status:"icon-none"},tipStatus:function(){return this.status.length>0?"tip-"+this.status:"tip-icon-none"},processShow:function(){return this.processnum>0?!0:!1},enteranceShow:function(){return this.enterance.text&&this.enterance.href?!0:!1},process:function(){var t=this.processnum+"%";return"percent"===this.processtype&&(t="（"+t+"） ..."),t},tipShow:function(){return this.show}},methods:{onClick:function(){this.$emit("pan-tip-click")},onlinkClick:function(){this.$emit("pan-tip-link-click",{tipName:this.tipname})},loadPage:function(){this.enterance.reload&&setTimeout(function(){window.location.reload()},10)}}});s.exports=i});
;define("pan-timeline:widget/components/humanRemark/humanRemark.js",function(e,t,a){"use strict";var n=e("base:widget/libs/jquerypacket.js"),i=e("base:widget/libs/underscore.js"),r=e("base:thirdParty/vue/vue.js"),s=e("base:thirdParty/vue/vuex.js"),o=s.mapGetters,m=s.mapActions,c=e("pan-timeline:widget/components/system/Dialog/Dialog.js"),l=e("pan-timeline:widget/components/system/Button/Button.js"),u=e("system-core:context/context.js").instanceForSystem,h=e("pan-timeline:widget/api/humanRemark/getlist.js"),p=e("pan-timeline:widget/filters/index.js");e("pan-timeline:widget/components/topToolBar/topToolBar.js"),e("pan-timeline:widget/components/system/Tip/Tip.js");var d=window.yunData||{},g={componentPackageData:{remarked:!1,targetItem:null,myselfItem:null,humanNameList:[],friendNameList:[],friendNameMap:{},bindFriendUk:void 0,nameSet:[],isBindClick:!1},friendData:{friendDataList:[],hasFriendData:!1},watchData:{myselfInfo:{sculpture:d.MYAVATAR,uk:d.MYUK,remarked:!1,tagId:null,appear:!1},showType:1,initReady:!1,editAppear:!1,targetOperation:{cover_photo:null,tag_id:null,fs_id:null,targetName:null,remarkName:null,targetRelation:null,remarkRelation:null,uk:null},namePlaceholder:"输入TA的名字",relationPlaceholder:"请选择你和TA的关系？",associateShow:!1,relationListShow:!1,humanMatchList:[],friendMatchList:[],matchMenuStyle:{count:0,hasFriend:!1,humanEnough:!1},sculptureError:!1,relationList:["爸爸","妈妈","孩子","同事","伴侣","好友","亲戚","其他"],sculptureList:[],mergeDlgInfo:{open:!1,width:460},sculptureDlgInfo:{open:!1,width:602},sculptureIndex:-1,relationIndex:-1,sameHumanInfo:{name:null,sculpture:null,uk:null,tagId:null},sameFriendInfo:{name:null,uk:null,tagId:null},mergeAbandon:!1,modifyEnterance:{name:!1,relation:!1},noRemarkRelation:!1},watchDataCopy:{},postPackageData:{remarkTagID:null,remarkUk:null,multiformity:0,coverFsId:null},statisticsData:{mergeDlgStartTime:null,mergeDlgCloseTime:null},initData:function(){this.componentPackage=JSON.parse(JSON.stringify(g.componentPackageData)),this.postPackage=JSON.parse(JSON.stringify(g.postPackageData))},scrollUtil:{getScrollBottom:function(e){if(e){var t=e.height(),a=Math.max(e[0].scrollHeight,t),n=e.scrollTop(),i=Math.max(a-n-t,0);return i}return 0}}},f=r.component("human-remark",{name:"human-remark",template:'<div class="module-human-remark">\n    <!-- 同名合并 -->\n    <pan-dialog title="提示" :type="\'window\'" :width="mergeDlgInfo.width" :open="mergeDlgInfo.open" :closeMethod="humanMerge">\n        <div slot="body" class="merge-body">\n            <div class="merge-box">\n                <img class="merge-human-left" :src="targetOperation[\'formatSrc\']"></img>\n                <img class="merge-human-right" :src="sameHumanInfo[\'sculpture\']"></img>\n            </div>\n            <p class="prompt-title">TA们是同一个人吗？</p>\n            <p class="prompt-content">确认后照片将合并展示</p>\n        </div>\n        <div slot="footer">\n            <pan-button text="是" color="blue" size="large" @on-click="humanMerge(\'complete\')"></pan-button>\n            <pan-button text="否" size="large" @on-click="humanMerge(\'abandon\')"></pan-button>\n        </div>\n    </pan-dialog>\n\n    <!-- 头像设置 -->\n    <pan-dialog title="头像选择" :type="\'window\'" :width="sculptureDlgInfo.width" :open="sculptureDlgInfo.open" :closeMethod="closeSculptureDialog">\n        <div slot="body" class="sculpture-body">\n            <ul class="sculpture-container">\n                <li class="sculpture-box" v-for="(itemSculpture, index) in sculptureList" @click="selectSculpture(index)">\n                    <img class="sculpture-img" :src="imageSrcFormat(itemSculpture[\'coverPhoto\'])"></img> \n                    <div :class="[sculptureIndex === index? \'sculpture-active\' : \'sculpture-inactive\', \'sculpture-effect\']"></div>\n                </li>\n            </ul>\n        </div>\n        <div slot="footer">\n            <pan-button text="确认" color="blue" size="large" @on-click="completeSculpture"></pan-button>\n            <pan-button text="取消" size="large" @on-click="closeSculptureDialog"></pan-button>\n        </div>\n    </pan-dialog>\n\n    <!-- 备注人物信息 -->\n    <div class="component-core" v-if="initReady">\n        <!-- 状态1 -->\n        <div class="human-info-box" v-if="showType === 1">\n            <div class="head-sculpture-outer" @click.stop="installSculpture">\n                <div :class="[sculptureError ? \'image-err\' : \'\', \'head-sculpture\']">\n                    <img class="head-img" :src="targetOperation[\'formatSrc\']"\n                    @error="imageError"\n                    v-if="!sculptureError"></img>\n                </div>\n            </div>\n            <div class="info-title" @click.stop="transferRemark">TA是谁？</div>\n            <div class="info-tip" @click.stop="transferRemark">快备注下吧，方便快速查找～</div>\n        </div>\n        <!-- 状态2 -->\n        <div class="human-info-box" v-else-if="showType === 2">\n            <div class="head-sculpture-outer" @click.stop="installSculpture">\n                <div :class="[sculptureError ? \'image-err\' : \'\', \'head-sculpture\']">\n                    <img class="head-img" :src="targetOperation[\'formatSrc\']"\n                    @error="imageError"\n                    v-if="!sculptureError"></img>\n                </div>\n            </div>\n            <!-- 「我自己」居中显示 -->\n            <div class="info-name"\n            :style="nameHeightStyle">\n                <div class="name-text"\n                @click.stop="editName"\n                @mouseenter="editRemarkAppear(true)"\n                @mouseleave="editRemarkAppear(false)">{{strLengthLimit}}</div>\n                <div class="name-edit icon icon-remark-edit"\n                :style="remarkedIconStyle"\n                @click.stop="editName"\n                @mouseenter="editRemarkAppear(true)"\n                @mouseleave="editRemarkAppear(false)"></div>              \n            </div>\n            <div class="info-relation" v-if="targetOperation[\'uk\'] !== myselfInfo[\'uk\']"\n            @click.stop="editRelation">{{relationContentText}}</div>\n        </div>\n        <!-- 状态3 -->\n        <div class="human-info-box-edit" v-else-if="showType === 3">\n            <div class="head-sculpture-outer-mini">\n                <div :class="[sculptureError ? \'image-err\' : \'\', \'head-sculpture-mini\']">\n                    <img class="head-img-mini" :src="targetOperation[\'formatSrc\']"\n                    @error="imageError"\n                    v-if="!sculptureError"></img>\n                </div>\n            </div>\n            <div class="detail-info-box-edit"> \n                <input type="text" class="human-name-search" :placeholder="namePlaceholder" v-model.trim="targetOperation[\'targetName\']" v-focus\n                @input="nameAssociate(targetOperation[\'targetName\'])"\n                @focus="nameShowAll"\n                @keyup.enter.stop="nameRemarkComplete">\n                <div :class="[nextToGrey ? \'search-btn-inactive\' : \'search-btn-active\', \'human-remark-search-btn\']" data-type="human-remark-search-btn"@click.stop="nameRemarkComplete">{{nameRemarkText}}</div>\n            </div>\n            <div\n            :class="[!menuStyleAdjust ? (matchMenuStyle[\'hasFriend\'] && !matchMenuStyle[\'humanEnough\'] ? \'match-menu-large-mix\' : \'match-menu-large-single\') : \'match-menu-small\', \'match-menu-base\']"\n            :style="[!menuStyleAdjust ? \'\' : menuSmallStyle]"\n            v-if="associateShow">\n                <div class="match-list-container"\n                    @mousewheel.stop="scrollFunc($event);"\n                    @DOMMouseScroll.stop="scrollFunc($event);"\n                    @scroll.stop="scrollFunc($event);">\n                    <div class="myself-match-menu" v-if="myselfInfo[\'appear\']">\n                        <div class="myself-item" @click.stop="selectMyself">\n                            <div :class="[myselfInfo[\'imgErr\'] ? \'image-err\' : \'\', \'head-img-box\']">\n                                <img class="head-img" :src="myselfInfo[\'sculpture\']"\n                                @error="imageError($event, myselfInfo)"\n                                v-if="!myselfInfo[\'imgErr\']"></img>\n                            </div>\n                            <div class="name-area">我自己</div>                   \n                        </div>\n                    </div>\n                    <div class="save-match-menu">\n                        <div class="human-name-item" v-for="(itemHuman, index) in humanMatchList" @click.stop="selectHuman(index)">\n                            <div :class="[itemHuman[\'imgErr\'] ? \'image-err\' : \'\', \'head-img-box\']">\n                                <img class="head-img" :src="itemHuman[\'coverPhoto\']"\n                                @error="imageError($event, itemHuman)"\n                                v-if="!itemHuman[\'imgErr\']"></img>\n                            </div>\n                            <div class="name-area">{{itemHuman.name}}</div>\n                        </div>\n                    </div>\n                    <div class="friend-match-menu" v-if="friendMatchList && friendMatchList.length !== 0">\n                        <div class="friend-boundary">我的网盘好友</div>\n                        <div class="friend-name-item" v-for="(itemFriend, index) in friendMatchList" @click.stop="selectFriend(index)">\n                            <div :class="[itemFriend[\'imgErr\'] ? \'image-err\' : \'\', \'head-img-box\']">\n                                <img class="head-img" :src="itemFriend[\'coverPhoto\']"\n                                @error="imageError($event, itemFriend)"\n                                v-if="!itemFriend[\'imgErr\']"></img>\n                            </div>\n                            <div class="name-area">{{itemFriend.name}}</div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <!-- 状态4 -->\n        <div class="human-info-box-edit" v-else-if="showType === 4">\n            <div class="head-sculpture-outer-mini">\n                <div :class="[sculptureError ? \'image-err\' : \'\', \'head-sculpture-mini\']">\n                    <img class="head-img-mini" :src="targetOperation[\'formatSrc\']"\n                    @error="imageError"\n                    v-if="!sculptureError"></img>\n                </div>\n            </div>\n            <div class="detail-info-box-edit">\n                <!-- 为啥要在这里套一个div呢？是为了解决IE edge下关系选择框可以手动输入的问题。\n                涉及虚拟DOM更新。 -->\n                <div>\n                    <input \n                    :class="[\'human-relation-search\', targetOperation[\'targetRelation\'] ? \'human-relation-exist\' : \'human-relation-unexist\']"\n                    :value="(targetOperation[\'targetRelation\'] ? targetOperation[\'targetRelation\'] : \'请选择你和TA的关系？\')"\n                    readonly="readonly"\n                    @keyup.enter="relationRemarkComplete"\n                    @click.stop="reChoseRelation">\n                </div>\n                <div :class="[!modifyEnterance.relation || targetOperation[\'targetRelation\'] ? \'search-btn-active\' : \'search-btn-inactive\', \'human-remark-search-btn\']"\n                @click.stop="relationRemarkComplete">{{relationRemarkText}}</div>\n            </div>\n            <ol class="relation-menu" v-if="relationListShow">\n                <li class="relation-item" v-for="(itemRelation, index) in relationList"\n                @click.stop="selectRelation(index)">{{itemRelation}}</li>\n            </ol>\n        </div>\n    </div>\n</div>',data:function(){return g.watchDataCopy},props:{},directives:{focus:{inserted:function(e){e.focus()}}},components:{"pan-dialog":c,"pan-button":l},beforeCreate:function(){g.initData(),g.watchDataCopy=JSON.parse(JSON.stringify(g.watchData))},computed:r.util.extend({strLengthLimit:function(){if(this.targetOperation.remarkName){for(var e=0,t=0;t<this.targetOperation.remarkName.length;t++)if(this.targetOperation.remarkName.charCodeAt(t)<128?e++:e+=2,e>16)return this.targetOperation.remarkName.substring(0,t)+"...";return this.targetOperation.remarkName}},relationContentText:function(){var e="";return e=this.targetOperation.remarkRelation?this.targetOperation.remarkRelation:"来备注下你们的关系吧"},nameHeightStyle:function(){var e={};return e=this.targetOperation.uk===this.myselfInfo.uk?{marginTop:"20px"}:{marginTop:"7px"}},menuStyleAdjust:function(){return this.myselfInfo.appear&&this.matchMenuStyle.count>5||!this.myselfInfo.appear&&this.matchMenuStyle.count>6?(!this.associateShow&&(this.associateShow=!0),!1):(this.myselfInfo.appear||0!==this.matchMenuStyle.count||this.associateShow&&(this.associateShow=!1),!0)},menuSmallStyle:function(){var e,t,a=50,n=40,i=28;return this.myselfInfo.appear?this.matchMenuStyle.count<6&&(e=this.matchMenuStyle.hasFriend?(this.matchMenuStyle.count+1)*a+n+i:(this.matchMenuStyle.count+1)*a+i,t=-(e+10)):this.matchMenuStyle.count<7&&(e=this.matchMenuStyle.hasFriend?this.matchMenuStyle.count*a+n+i:this.matchMenuStyle.count*a+i,t=-(e+10)),{bottom:t+"px"}},nextToGrey:function(){return this.targetOperation.targetName?!1:!0},remarkedIconStyle:function(){var e={};return e=this.editAppear?{color:"#09AAFF"}:{color:"#fff"}},nameRemarkText:function(){return this.modifyEnterance.name?"完成":"下一步"},relationRemarkText:function(){return this.modifyEnterance.relation||this.targetOperation.targetRelation?"完成":"跳过"}},o({humanDataMap:"getHumanDataMap",humanNameData:"getHumanNameData",lock:"getLock"})),watch:{targetOperation:{handler:function(e){var t=/^(我(自|自己)?)?$/;this.relationPlaceholder=e&&e.targetRelation?this.targetOperation.targetRelation:"请选择TA和你的关系？",this.targetOperation.uk!==this.myselfInfo.uk?e&&e.targetName&&(this.myselfInfo.appear=t.test(e.targetName)?!0:!1):this.myselfInfo.appear=!1},deep:!0},showType:function(e){e>2?!this.lock&&this.$store.commit("setLock",{lock:!0}):this.lock&&this.$store.commit("setLock",{lock:!1})},$route:{handler:function(){this.componentUpdate()},deep:!0}},created:function(){},methods:r.util.extend({scrollFunc:function(e){e.wheelDelta<0&&g.scrollUtil.getScrollBottom(n(".match-menu-base"))<=0&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},errCb:function(e){this.$store.commit("setTip",{show:!0,msg:u.errorMsg(e),status:"caution",autoClose:!0,closeBtn:!0})},imageError:function(e,t){t?r.set(t,"imgErr",!0):this.sculptureError=!0},imageSrcFormat:function(e){var t=e?p.imageSrcFormat(e):"";return t},postTipHandle:function(e,t){e?this.$store.commit("setTip",{show:!0,msg:t,status:"success",autoClose:!0,closeBtn:!1}):this.$store.commit("setTip",{show:!0,msg:t,status:"caution",autoClose:!0,closeBtn:!0})},clickHandler:function(e){for(var t=n(e.target),a=[".component-core"],i=!0,r=0;r<a.length;r++){var s=a[r],o=t.parents(s).length<=0;o||(i=!1)}i&&(this.showType=g.componentPackage.remarked?2:1,this.mergeAbandon=!1,this.modifyEnterance={name:!1,relation:!1})},componentUpdate:function(){g.initData(),g.watchDataCopy=JSON.parse(JSON.stringify(g.watchData)),this.buildComponent()},getHumanNameData:function(e){var t=this,a=[],n=function(r){r?0===r.errno?r.list&&(r.list.length>0&&(a=a.concat(r.list)),r.has_more===!0?(e.params.start+=200,h.getHumanName(e.params).then(n).catch(function(){e&&e.errCb&&e.errCb()})):(t.remarkPrepare(a,!1),t.setHumanNameData({list:a}),e.succCb&&e.succCb(),i())):e.errCb(r.errno):e&&e.errCb&&e.errCb()},i=function(){t.getFriendNameData({params:{start:0,limit:150},succCb:t.collectFriendInfo,errCb:t.errCb})};this.humanNameData.length>0?(this.remarkPrepare(this.humanNameData,!0),this.setHumanNameData({list:this.humanNameData}),e.succCb&&e.succCb(),i()):h.getHumanName(e.params).then(n).catch(function(){e&&e.errCb&&e.errCb()})},setHumanNameData:function(e){e.list.forEach(function(e){e.name&&e.relation&&e.cover_photo&&e.count>3&&g.componentPackage.humanNameList.push({name:e.name,relation:e.relation,tagId:e.tag_id,uk:e.uk,coverPhoto:e.cover_photo,coverFsId:e.cover_fs_id})},this)},getFriendNameData:function(e){var t=this,a=function(n){if(n)if(0===n.errno){if(n.records&&n.records.length>0){var i={};n.records.forEach(function(e,t){i[e.uk]=t}),g.friendData.friendDataList=g.friendData.friendDataList.concat(n.records),g.friendData.hasFriendData=!0,t.setFriendNameData({list:n.records}),e.succCb&&e.succCb()}n.has_more===!0&&(e.params.start=e.params.limit,e.params.limit=e.params.limit+150,h.getFriendName(e.params).then(a).catch(function(){e&&e.errCb&&e.errCb()}))}else e.errCb(n.errno);else e&&e.errCb&&e.errCb()};g.friendData.hasFriendData?(this.setFriendNameData({list:g.friendData.friendDataList}),e.succCb&&e.succCb()):h.getFriendName(e.params).then(a).catch(function(){e&&e.errCb&&e.errCb()})},setFriendNameData:function(e){e.list.forEach(function(e){e.remark&&e.avatar_url&&!this.filterExistName(e)&&g.componentPackage.friendNameList.push({name:e.remark,uk:e.uk,coverPhoto:e.avatar_url})},this),g.componentPackage.friendNameList.forEach(function(e,t){g.componentPackage.friendNameMap[e.uk]=t})},filterExistName:function(e){return g.componentPackage.humanNameList.some(function(t){return e.uk===t.uk})},collectHumanInfo:function(){g.componentPackage.nameSet.splice(0,0,g.componentPackage.humanNameList),g.componentPackage.nameSet[0]=g.componentPackage.nameSet[0].filter(function(e){return e.tagId!==g.componentPackage.targetItem.tag_id&&e.uk!==this.myselfInfo.uk},this)},collectFriendInfo:function(){g.componentPackage.nameSet.splice(1,0,g.componentPackage.friendNameList)},remarkPrepare:function(e,t){var a="others",r=parseInt(this.$route.params.tagId,10);g.postPackage.remarkTagID=this.$route.params.tagId;var s=null;if(t){var o=this.humanDataMap.myself,m=this.humanDataMap.others,c=i.keys(o);"{}"!==n.stringify(o)?(this.myselfItem=this.humanNameData[o[c[0]]],this.myselfInfo.remarked=!0,this.myselfInfo.sculpture=this.myselfItem.cover_photo,this.myselfInfo.tagId=this.myselfItem.tag_id,void 0===o[r]?s=this.humanNameData[m[r]]:(s=this.myselfItem,a="myself")):(s=this.humanNameData[m[r]],this.initMyselfInfo())}else s=e.find(function(e){return e.tag_id===g.postPackage.remarkTagID},this),this.myselfItem=e.find(function(e){return e.uk===this.myselfInfo.uk},this),this.myselfItem?(this.myselfInfo.remarked=!0,this.myselfInfo.sculpture=this.myselfItem.cover_photo,this.myselfInfo.tagId=this.myselfItem.tag_id):this.initMyselfInfo();s&&(s.name||s.uk===this.myselfInfo.uk)?(this.showType=2,this.targetOperation.remarkName=s.name,this.targetOperation.uk=s.uk,g.componentPackage.remarked=!0,s.uk===this.myselfInfo.uk?a="myself":this.targetOperation.remarkRelation=s.relation):(this.showType=1,this.myselfInfo.appear=!0),i.isObject(s)&&(this.$emit("judgeTargetHuman",a),this.targetOperation.cover_photo=s.cover_photo,this.targetOperation.tag_id=g.postPackage.remarkTagID,this.targetOperation.cover_fs_id=s.cover_fs_id),p.getImageFromDB(this.targetOperation),g.componentPackage.targetItem=s||{},this.initReady=!0},initMyselfInfo:function(){this.myselfInfo={sculpture:d.MYAVATAR,uk:d.MYUK,remarked:!1,tagId:null,appear:!1}},getRemarkSculptureData:function(e){var t=this,a=function(a){a?0===a.errno?a.list&&a.list.list&&a.list.list.length>0&&(t.setRemarkSculptureData({list:a.list.list}),e.succCb()):e.errCb(a.errno):e&&e.errCb&&e.errCb()};h.getRemarkSculpture(e.params).then(a).catch(function(){e&&e.errCb&&e.errCb()})},setRemarkSculptureData:function(e){this.sculptureList=[],e.list.forEach(function(e){e.cover_photo&&this.sculptureList.push({coverPhoto:e.cover_photo,coverFsId:e.cover_fs_id})},this)},postRemarkInfoData:function(e){var t=this,a=e.type,n=e.params,i=!1,r=!0;switch(a){case 1:delete n.name,delete n.person_uk;break;case 3:var s=n.name;delete n.name;break;case 4:delete n.person_uk}if(t.noRemarkRelation){var o=n.relation;delete n.relation,r=!1,t.noRemarkRelation=!1}var m=function(e){if(e&&0===e.errno){var m=[2,7,8];t.postTipHandle(!0,"标记成功"),2===a?(n.name="我自己",i=!0):3===a&&(n.name=s),r||(n.relation=o),t.$store.commit("modifyHumanNameData",{params:n}),-1!==m.indexOf(a)&&t.$store.commit("updateHumanDataMap",{hasMyself:i,list:t.humanNameData}),t.componentUpdate()}else t.postTipHandle(!1,"标记失败"),t.showType=g.componentPackage.remarked?2:1};h.postRemarkInfo(n).then(m).catch(function(){e&&e.errCb&&e.errCb()})},postRemarkCoverData:function(e){var t=this,a=function(a){a&&0===a.errno?(t.postTipHandle(!0,"头像修改成功"),t.targetOperation.cover_photo=e.coverPhoto,t.targetOperation.formatSrc=e.coverPhoto,t.$store.commit("modifyHumanNameData",{params:r.util.extend(e.params,{cover_photo:t.targetOperation.cover_photo})}),u.log.send({type:"web_album_human_modify_sculpture"})):t.postTipHandle(!1,"头像修改失败")};h.postRemarkCover(e.params).then(a).catch(function(){e&&e.errCb&&e.errCb()})},postMergeClusterData:function(e){var t=this,a=function(a){if(a&&0===a.errno){if(e&&e.params&&e.type&&e.historyRecord){var n=!1,i=[1,3];-1!==i.indexOf(e.type)&&(n=!0),t.postTipHandle(!0,"人物合并成功"),t.$store.commit("deleteHumanNameData",{params:e.params}),t.$store.commit("updateHumanDataMap",{hasMyself:n,list:t.humanNameData}),t.$router.replace(e.historyRecord),t.componentUpdate(),u.log.send({type:"web_album_human_mergeList_success"})}}else t.postTipHandle(!1,"人物合并失败"),u.log.send({type:"web_album_human_mergeList_fail"})};h.postMergeCluster(e.params).then(a).catch(function(){e&&e.errCb&&e.errCb()})},buildComponent:function(){this.getHumanNameData({params:{start:0,limit:200,key:"tag",type:3},succCb:this.collectHumanInfo,errCb:this.errCb})},transferRemark:function(){this.initTargetNameAndRelation("",""),this.showType=3},initTargetNameAndRelation:function(e,t){this.targetOperation.targetName=e,this.targetOperation.targetRelation=t},installSculpture:function(){this.getRemarkSculptureData({params:{person_id:this.$route.params.tagId,start:0,limit:36},succCb:this.sculptureOpen,errCb:this.errCb})},sculptureOpen:function(){this.sculptureDlgInfo.open=!0},selectSculpture:function(e){this.sculptureIndex=e},closeSculptureDialog:function(){this.sculptureDlgInfo.open=!1,this.sculptureIndex=-1},completeSculpture:function(){-1!==this.sculptureIndex&&(this.sculptureDlgInfo.open=!1,p.getImageFromDB(this.targetOperation),g.postPackage.coverFsId=this.sculptureList[this.sculptureIndex].coverFsId,this.postRemarkCoverData({params:{person_id:g.postPackage.remarkTagID,fs_id:g.postPackage.coverFsId},coverPhoto:this.sculptureList[this.sculptureIndex].coverPhoto,errCb:this.errCb}),this.sculptureIndex=-1)},editName:function(){this.initTargetNameAndRelation("",this.targetOperation.remarkRelation),this.namePlaceholder="请修改人物名字",this.modifyEnterance.name=!0,this.showType=3},editRelation:function(){this.initTargetNameAndRelation(this.targetOperation.remarkName,""),this.modifyEnterance.relation=!0,this.relationListShow=!0,this.showType=4},editRemarkAppear:function(e){this.editAppear=e?!0:!1},humanMerge:function(e){var t,a;this.sameHumanInfo.uk===this.myselfInfo.uk?(t=this.myselfItem.tag_id,a=1):(t=this.sameHumanInfo.tagId,a=g.postPackage.remarkTagID===this.myselfInfo.tagId?2:this.myselfInfo.remarked?3:4),this.mergeDlgInfo.open=!1,g.statisticsData.mergeDlgCloseTime=(new Date).getTime(),this.associateShow=!1,"complete"===e?this.postMergeClusterData({params:{person_id:parseInt(t,10),merged_person_id:parseInt(g.postPackage.remarkTagID,10)},historyRecord:{name:"faceList",params:{tagId:t}},type:a,errCb:this.errCb}):"abandon"===e?(this.sameHumanInfo.uk===this.myselfInfo.uk?(this.showType=g.componentPackage.remarked?2:1,this.targetOperation.targetName=""):(this.nameRemarkComplete(),this.mergeAbandon=!0,g.postPackage.multiformity=1),u.log.send({type:"web_album_human_mergeDlg_abandon"})):(this.showType=g.componentPackage.remarked?2:1,u.log.send({type:"web_album_human_mergeDlg_cancel"})),u.log.send({type:"web_album_human_select_remarked"}),u.log.send({type:"web_album_human_mergeDlg_stayTime",time:g.statisticsData.mergeDlgCloseTime-g.statisticsData.mergeDlgStartTime,url:"//update.pan.baidu.com/statistics",clienttype:0,op:"webtimeline",op_from:"webtimelinehandle"})},nameAssociate:function(e){if(e){for(var t=e.split(""),a=["*",".","?","+","$","^","[","]","(",")","{","}","|","\\","/"],n=t.map(function(e){return-1!==a.indexOf(e)?"\\"+e:e}).join(""),i=new RegExp(n),r=[[],[]],s=0;s<g.componentPackage.nameSet.length;s++){for(var o=0;o<g.componentPackage.nameSet[s].length;o++)e&&i.test(g.componentPackage.nameSet[s][o].name)&&r[s].push(g.componentPackage.nameSet[s][o]);r[s]&&0!==r[s].length&&r[s].sort(function(e,t){return e.name.localeCompare(t.name)})}this.humanMatchList=r[0],this.friendMatchList=r[1],this.matchMenuStyle=this.calculateCount(this.humanMatchList,this.friendMatchList)}else this.humanMatchList=g.componentPackage.nameSet[0],this.friendMatchList=g.componentPackage.nameSet[1],this.matchMenuStyle=this.calculateCount(this.humanMatchList,this.friendMatchList),this.myselfInfo.appear=!0,this.associateShow=!0},nameShowAll:function(){g.componentPackage.remarked&&(this.targetOperation.targetName=this.targetOperation.remarkName),this.associateShow=!0,this.nameAssociate(this.targetOperation.targetName)},calculateCount:function(e,t){var a=i.isArray(e)?e.length:0,n=i.isArray(t)?t.length:0,r=a+n,s=!1,o=!1;return n&&(s=!0),a>5&&(o=!0),{count:r,hasFriend:s,humanEnough:o}},selectMyself:function(){this.myselfInfo.remarked?this.myselfInfo.uk===g.componentPackage.targetItem.uk?this.showType=2:(this.sameHumanInfo.name="我自己",this.sameHumanInfo.sculpture=this.myselfInfo.sculpture,this.sameHumanInfo.uk=this.myselfInfo.uk,this.mergeDlgInfo.open=!0,g.statisticsData.mergeDlgStartTime=(new Date).getTime()):(this.sameFriendInfo.name="我自己",this.sameFriendInfo.uk=this.myselfInfo.uk,g.postPackage.remarkUk=this.sameFriendInfo.uk,this.postRemarkInfoData({params:{person_id:g.postPackage.remarkTagID,person_uk:g.postPackage.remarkUk,multi:g.postPackage.multiformity},type:2,errCb:this.errCb})),this.associateShow=!1},selectHuman:function(e){this.sameHumanInfo.name=this.humanMatchList[e].name,this.sameHumanInfo.sculpture=this.humanMatchList[e].coverPhoto,this.sameHumanInfo.uk=this.humanMatchList[e].uk,this.sameHumanInfo.tagId=this.humanMatchList[e].tagId,this.targetOperation.targetName=this.sameHumanInfo.name,this.mergeDlgInfo.open=!0,g.statisticsData.mergeDlgStartTime=(new Date).getTime(),this.associateShow=!1},selectFriend:function(e){this.sameFriendInfo.name=this.friendMatchList[e].name,this.sameFriendInfo.uk=this.friendMatchList[e].uk,this.sameFriendInfo.tagId=this.friendMatchList[e].tagId,this.targetOperation.targetName=this.sameFriendInfo.name,g.postPackage.remarkUk=this.sameFriendInfo.uk,g.componentPackage.bindFriendUk=this.sameFriendInfo.uk,this.associateShow=!1,this.nameRemarkComplete()},nameRemarkComplete:function(){if(!this.nextToGrey){if(this.targetOperation.uk===this.myselfInfo.uk&&"我自己"===this.targetOperation.targetName)return void(this.showType=2);this.modifyEnterance.name?(this.noRemarkRelation=!0,this.completeRemark(),u.log.send({type:"web_album_human_modify_name"})):(this.showType=4,this.relationListShow=!0,this.targetOperation.targetRelation="",this.relationIndex=-1)}},selectRelation:function(e){this.relationListShow=!1,this.relationIndex=e,this.targetOperation.targetRelation=this.relationList[this.relationIndex]},relationRemarkComplete:function(){this.modifyEnterance.relation?(-1!==this.relationIndex&&(this.targetOperation.targetName=this.targetOperation.remarkName,this.completeRemark()),u.log.send({type:"web_album_human_modify_relation"})):(-1===this.relationIndex&&(this.targetOperation.targetRelation=this.targetOperation.remarkRelation,this.noRemarkRelation=!0),this.completeRemark())},completeRemark:function(){var e=g.componentPackage.targetItem,t=null,a=e.uk?!0:!1,n=a&&e.uk===this.myselfInfo.uk?!0:!1,i=this.myselfInfo.remarked?["我自己"]:[];g.componentPackage.nameSet[0].forEach(function(e){i.push(e.name)}),this.targetOperation.targetName!==e.name||this.mergeAbandon?g.postPackage.remarkUk&&!n?t=3:-1===i.indexOf(this.targetOperation.targetName)?a?(t=n?7:5,g.postPackage.remarkUk=""):t=4:(t=n?8:6,e.uk&&(g.postPackage.remarkUk=""),g.postPackage.multiformity=1):t=1,this.postRemarkInfoData({params:{person_id:g.postPackage.remarkTagID,person_uk:g.postPackage.remarkUk,name:this.targetOperation.targetName,relation:this.targetOperation.targetRelation,multi:g.postPackage.multiformity},type:t,errCb:this.errCb}),this.relationIndex=-1,this.mergeAbandon=!1,g.postPackage.remarkUk=null},reChoseRelation:function(){this.relationListShow=!0,this.targetOperation.targetRelation="",this.relationIndex=-1}},m({panTipClick:"panTipClick"})),mounted:function(){this.buildComponent(),n(".module-list-init").bind("click",this.clickHandler)},destroyed:function(){n(".module-list-init").unbind("click",this.clickHandler)}});a.exports=f});
;define("pan-timeline:widget/system/util/timeLog.js",function(e,t,i){var n=e("system-core:context/context.js").instanceForSystem,s=function(e){"undefined"!=typeof e.type&&"undefined"!=typeof e.op&&(this.type=e.type,this.op=e.op,this.faceEndTime=0,this.faceStartTime=0,this.events())};s.prototype.begin=function(){this.faceStartTime=Date.parse(new Date)},s.prototype.send=function(){this.faceEndTime=Date.parse(new Date),n.log.send({type:this.type,time:this.faceEndTime-this.faceStartTime,url:"//update.pan.baidu.com/statistics",clienttype:"0",op_from:"webtimelinehandle",op:this.op})},s.prototype.events=function(){var e=this;window.addEventListener("unload",function(){e.send()},!1)},i.exports=s});
;define("pan-timeline:widget/components/faceList/faceList.js",function(t,e,i){"use strict";var n=t("base:thirdParty/vue/vue.js"),s=t("base:thirdParty/vue/vuex.js"),a=t("pan-timeline:widget/components/system/list/listInit/listInit.js"),o=t("pan-timeline:widget/components/topToolBar/topToolBar.js"),r=t("pan-timeline:widget/components/contextMenu/contextMenu.js"),l=t("pan-timeline:widget/components/system/Button/Button.js"),c=t("pan-timeline:widget/store/index.js"),m=t("pan-timeline:widget/components/system/Tip/Tip.js"),u=t("base:widget/libs/underscore.js"),p=t("pan-timeline:widget/components/humanRemark/humanRemark.js"),d=t("pan-timeline:widget/components/emptyList/EmptyList.js"),h=t("pan-timeline:widget/components/system/list/listInit/listUtil.js"),y=t("pan-timeline:widget/system/util/timeLog.js"),f=t("system-core:context/context.js").instanceForSystem;t("pan-timeline:widget/components/system/list/listInit/listRecycle.js");var g=null,L=s.mapGetters,w=s.mapActions,C=u.throttle(function(t){c.dispatch("faceList/triggerLayout",{resize:t||!1})},80),v={init:function(){var t=n.component("faceList",{name:"faceList",template:'<div class="module-face-list module-type">\n    <top-tool-bar></top-tool-bar>\n    <div class="module-list-init">\n        <list-init\n            :listView="listView"\n            :hasAllChooseCK="hasAllChooseCK"\n            :listColsClickFunc="listColsClickFunc"\n            :listViewType="listViewType"\n            :listViewClass="listViewClass"\n            :recycleListConf="recycleListConf"\n            :scrollListFunc="scrollListFunc"\n            :resizeEventFunc="resizeEventFunc"\n            :listViewContainer="listViewContainer"\n            :userArea="userArea"\n            :emptyDesc="errorMsg"\n            :type="type">\n            <div class="face-operate-bar" slot="list-header-slot">\n                <keep-alive>\n                    <human-remark\n                    @judgeTargetHuman="judgeIsMyself"></human-remark>\n                </keep-alive>\n                <pan-button\n                    class="share-btn"\n                    :text="shareBtnDeac"\n                    :className="className"\n                    @on-click="callSharePlugin();">\n                </pan-button>\n                <!-- 操作顶部工具栏，禁用备注区域 lyuyexin 2017-8-11 -->\n                <div class="remark-forbidden" v-if="remarkAndShareForbidden"></div>\n            </div>\n        </list-init>\n    </div>\n    <classify-modify></classify-modify>\n</div>\n',data:function(){return{errorMsg:"暂无内容，去浏览其他照片吧~",listView:["timeline"],hasAllChooseCK:!1,listColsClickFunc:function(){},listViewType:1,listViewClass:"facelist",listViewContainer:".module-list-init",userArea:[".timeline-title",".timeline-ruler"],type:"faceList",recycleListConf:{recycleType:"classify",type:"faceList",container:{dom:".module-timeline-view"},numLimitConf:{maxInRenderGroup:20,maxInDayGroup:function(t,e){var i=10;return Math.floor(document.querySelector(t.dom).clientWidth/e.width)*i},maxInLineGroup:function(t,e){return Math.floor(document.querySelector(t.dom).clientWidth/e.width)},minItem:function(){}},itemObj:{width:160,height:160},viewPortGapTimes:function(t,e){var i=Math.floor(document.querySelector(t.dom).clientWidth/e.width);return i>6?2:2},groupHeightGap:40,listHeaderSlotGap:85},scrollListFunc:function(){C.call(this)},resizeEventFunc:function(){C.call(this,!0)},shareBtnDeac:"分享TA的照片",className:"share-all",remarkAndShareForbidden:!1}},components:{"list-init":a,"top-tool-bar":o,"context-menu":r,"pan-tip":m,"pan-button":l,"human-remark":p},created:function(){g=new y({op:"webtimeline",type:"faceListRemainTimeTotal"}),g.begin();var t=this.$route,e=(t.name,t.params.tagId);this.$store.commit("timeline/setCurType",{curType:"faceList"}),this.$store.commit("faceList/setTagid",{tagId:e})},methods:n.util.extend({getFileArr:function(){var t=[];if(this.timeLineDataList)for(var e in this.timeLineDataList)this.timeLineDataList.hasOwnProperty(e)&&this.timeLineDataList[e].length&&(t=t.concat(this.timeLineDataList[e]));return t},callSharePlugin:function(){var t=this.getFileArr();t.length?this.$store.dispatch("shareFiles",{shareList:t}):this.$store.commit("setTip",{show:!0,msg:"数据错误，请稍后重试",status:"caution",autoClose:!0}),f.log.send({type:"web_album_share_allpic_click"})},judgeIsMyself:function(t){this.shareBtnDeac="myself"===t?"分享我的照片":"分享TA的照片"}},w({panTipClick:"panTipClick"})),activated:function(){this.$store.commit("timeline/setCurType",{curType:"faceList"}),this.$store.commit("setRecycleListConf",{recycleListConf:this.recycleListConf}),this.$store.dispatch(this.routeType+"/getListData")},destroyed:function(){g.send()},computed:n.util.extend(L({contextMenu:"getContextMenu",tip:"getTip",routeType:"getRouteType",listStatus:"getListStatus",timeLineDataList:"getTimeLineDataList"}),{}),watch:{$route:function(){var t=this,e={},i=function(){t.$store.commit("setListEmpty",{show:!0,listEmptyComponent:d,emptyDesc:t.errorMsg})},n=function(t){h.defaultErrCB(t)},s=t.$route,a=s.params.tagId;t.$store.commit("faceList/setTagid",{tagId:a}),e.emptyCb=i,e.errCb=n,this.$store.dispatch(this.routeType+"/getListData",e)},listStatus:function(t){this.remarkAndShareForbidden=2===t?!0:!1}}});return t}};i.exports=v.init()});
;define("pan-timeline:widget/components/guideAuto/guideQueue.js",function(e,a,n){var c=window.yunData,o=[{asyncCanShow:!0,key:"newface_dialog_"+c.MYUK,pageType:["classify"],canShow:"newFaceDlg",execute:"newFaceDlgHandle",goNext:!0},{asyncCanShow:!0,key:"remark_myself_"+c.MYUK,pageType:["classify"],canShow:"remarkMyself",execute:"remarkMyselfHandle"}];n.exports=o});
;define("pan-timeline:widget/components/guideAuto/guideAuto.js",function(e,t,i){var n=e("base:thirdParty/vue/vue.js"),a=e("base:thirdParty/vue/vuex.js"),u=a.mapGetters,r=e("base:widget/libs/underscore.js"),o=e("system-core:context/context.js").instanceForSystem,s=e("base:widget/storage/storage.js"),c=e("pan-timeline:widget/api/classify/getlist.js"),d=window.yunData,h=e("pan-timeline:widget/components/guideAuto/guideQueue.js"),g=1,f=2,l=3,m={queue:JSON.parse(JSON.stringify(h)),init:function(){var e=n.component("pan-auto-guide",{template:"<div class=\"guide-auto-box\">\n    <!-- 居中弹框引导 -->\n    <pan-guide v-if=\"guideSwitch['centerGuide']\"\n    :is-auto=\"true\"\n    :open=\"centerGuide['config']['open']\"\n    :width=\"centerGuide['config']['width']\"\n    :guide-img-style=\"centerGuide['config']['imgStyle']\"\n    :button-text=\"centerGuide['config']['buttonText']\"\n    :close-method=\"centerGuide['closeMethod']\"\n    :enter-method=\"centerGuide['enterMethod']\"></pan-guide>\n\n    <!-- 广告位 -->\n\n    <!-- 引导标注「我自己」 -->\n    <myself-remark v-if=\"guideSwitch['customize']['remark-myself']\"\n    :guideOut=\"customize['remark-myself']['isOut']\"\n    :humanData=\"customize['remark-myself']['data']\"></myself-remark>\n    <!-- 人脸弹窗说明 -->\n    <newface-dialog v-if=\"faceDlg\"></newface-dialog>\n</div>\n",data:function(){return{centerGuide:{config:{},closeMethod:function(){},enterMethod:function(){}},advertisement:{},customize:{"remark-myself":{isOut:!1,data:{sample:[],complex:[]}}},guideSwitch:{centerGuide:!1,advertisement:!1,customize:{"remark-myself":!1}},faceDlg:!1}},computed:n.util.extend(u({privateSwitch:"getPrivateSwitch",routeType:"getRouteType"})),created:function(){this.guideDequeue()},watch:{$route:function(e){m.queue=JSON.parse(JSON.stringify(h)),"classify"===e.name&&this.guideDequeue()}},methods:{errCb:function(e){this.$store.commit("setTip",{show:!0,msg:o.errorMsg(e),status:"caution",autoClose:!0,closeBtn:!0})},guidePreHandle:function(){var e=this,t=function(e){var t=e.date.split("-"),i=e.time.split(":");return t.forEach(function(e,t){var e=parseInt(e,10);1===t&&(e-=1)}),i.forEach(function(e){var e=parseInt(e,10)}),new Date(t[0],t[1],t[2],i[0],i[1],i[2]).getTime()},i=function(){var t=e.$route.name;return t},n=m.queue.shift();if(!n)return g;var a=n.key?s.getItem(n.key):"",u=n.pageType?n.pageType:[];if(n.period)var r=t(n.period.start),o=t(n.period.termination),c=(new Date).getTime();var d=i(),h=!!a,f=!0,p=!0;return r&&o&&(r>c||c>o)&&(f=!1),u&&u.length>0&&-1===u.indexOf(d)&&(p=!1),!n.ignore&&f&&!h&&p?n:l},guideDequeue:function(e,t){var i;if(void 0===e){var n=this.guidePreHandle();if(r.isObject(n))i=n;else{if(n!==l)return;this.guideDequeue()}}else e?(i=m.queue.shift(),t&&(i.data=t)):this.guideDequeue();if(r.isObject(i)){if(i.key&&i.key.indexOf("remark_myself")>-1&&1===this.privateSwitch)return;if(i.asyncCanShow!==!0){var a=this.guideHandle(i);if(a!==l)return;this.guideDequeue()}else{var u=this[i.canShow];if(!r.isFunction(u))throw new Error("If the asyncCanShow has been set true, and the canShow was must be a function.");i.asyncCanShow=void 0,i.canShow=void 0,m.queue.unshift(i),u()}}},guideGoAhead:function(e,t){m.queue&&m.queue.length>0&&(m.queue[0].canShow=e,this.guideDequeue(e,t))},guideHandle:function(e){if(!e.canShow)return e.goNext?l:f;var t=this[e.execute];if(!r.isFunction(t))throw new Error("If the asyncCanShow has been set true, and the execute was must be a function.");t(e.data),!e.ManualKeyOperate&&e.key&&s.setItem(e.key,!0)},centerToDo:function(){this.centerGuide.config={open:!0,width:540,imgStyle:{width:"450px",height:"300px",marginTop:"-20px",background:'url("/static/pan-timeline/widget/components/classify/image/classify-demo_nomd5.png") center center no-repeat'},buttonText:"申请体验"},this.centerGuide.closeMethod=function(){},this.centerGuide.enterMethod=function(){},this.guideSwitch.centerGuide=!0},remarkMyself:function(){var e=this,t=function(t){t&&0===t.errno&&t.list&&(t.list.length>0&&t.list[0].uk!==d.MYUK||0===t.list.length)?i({params:{mark:0},errCb:e.errCb}):e.guideGoAhead(!1)},i=function(t){var i=function(t){t&&0===t.errno&&t.list&&t.list.length>6?(o.log.send({type:"web_album_human_remark_myself_dialog"}),e.guideGoAhead(!0,t)):e.guideGoAhead(!1)};c.getLabelUsers(t.params).then(i).catch(function(){t.errCb(),e.guideGoAhead(!1)})};c.getLabelUsers().then(t).catch(function(){e.errCb(),e.guideGoAhead(!1)})},remarkMyselfHandle:function(e){var t=42,i=function(e,t){var i={tag_id:e,cover_photo:t};return i},n=this.customize["remark-myself"],a=e.list,u=a.slice(0,6),r=a.length>=t?a.slice(6,42):a.slice(6);u.forEach(function(e){var t=e.tag_id,a=e.cover_photo;n.data.sample.push(i(t,a))}),r.forEach(function(e){var t=e.tag_id,a=e.cover_photo;n.data.complex.push(i(t,a)),n.isOut=!0}),this.guideSwitch.customize["remark-myself"]=!0},newFaceDlg:function(){var e=this,t=function(t){0===t.list[2097152]?(e.guideGoAhead("true"),o.log.send({type:"web_album_human_new_face_dialog"})):e.guideGoAhead(!1)},i={"switch":2097152,uid:d.MYUK};c.getNewFaceSwitch(i).then(t).catch(function(){e.guideGoAhead(!1)})},newFaceDlgHandle:function(){this.faceDlg=!0}}});return e}};i.exports=m.init()});
;define("pan-timeline:widget/components/guideAuto/util/guideDialog/guideDialog.js",function(e,t,i){var n=e("base:thirdParty/vue/vue.js"),o=e("base:thirdParty/vue/vuex.js"),d=o.mapGetters,u=n.component("pan-guide",{template:'<base-dialog\n    :width="width"\n    :open="open"\n    :isguide="isguide"\n    @on-close-dialog="guideClose(closeMethod)">\n    <!-- 引导弹框 -->\n    <template>\n        <div slot="body">\n            <div class="guide-img"\n            :style="guideImgStyle"></div>\n        </div>\n        <div slot="footer">\n            <div class="guide-button"\n            @click="guideEnter(enterMethod)">{{buttonText}}</div>\n        </div>\n    </template>\n</base-dialog>',data:function(){return{isguide:!0}},props:{isAuto:{type:Boolean,"default":!1},open:{type:Boolean,"default":!1},width:{type:Number,"default":440},guideImgStyle:{type:Object},buttonText:{type:String},closeMethod:{type:Function},enterMethod:{type:Function}},computed:n.util.extend({},d({guide:"getGuide"})),methods:{guideClose:function(e){return this.isAuto?this.open=!1:this.$store.commit("setGuide",{open:!1}),"function"==typeof e?e():void 0},guideEnter:function(e){return this.isAuto?this.open=!1:this.$store.commit("setGuide",{open:!1}),"function"==typeof e?e():void 0}}});i.exports=u});
;define("pan-timeline:widget/components/guideAuto/util/myselfRemark/myselfRemark.js",function(e,t,i){var s=e("base:thirdParty/vue/vue.js"),n=e("system-core:context/context.js").instanceForSystem,l=e("pan-timeline:widget/api/guide/getlist.js"),o=e("pan-timeline:widget/api/humanRemark/getlist.js"),r=e("pan-timeline:widget/filters/index.js");e("pan-timeline:widget/components/system/Dialog/Dialog.js");var a=window.yunData,c=s.component("myself-remark",{template:'\n<div class="guide-remark-myself">\n    <!-- 引导：标注我自己 -->\n    <pan-dialog title="选择自己的头像" :type="\'window\'" :width="sampleBox.width" :open="sampleBox.open"\n    :closeMethod="sampleSelect">\n        <div slot="body" class="sample-select-body">\n            <div class="sample-prompt">\n                <p class="sample-select-title">以下哪个是你？</p>\n                <p class="sample-select-content">点击头像标注后，人物分类中优先展示你的照片</p>\n            </div>\n            <div class="sample-area">\n                <div :class="[{\'sample-unit-error\': sampleResult[\'imgErrList\'].indexOf(index) !== -1}, \'sample-unit\']" v-for="(item, index) in humanData[\'sample\']"\n                    @click="chooseInSample(item, index)">\n                    <img v-if="sampleResult[\'imgErrList\'].indexOf(index) === -1"\n                    :class="[{\'head-active\': sampleResult[\'indexArr\'].indexOf(index) !== -1, \'head-inactive\': sampleResult[\'isClicked\'] && sampleResult[\'indexArr\'].indexOf(index) === -1\n                    && sampleResult[\'indexArr\'].length > 4, \'sample-head-hover\': !(sampleResult[\'isClicked\'] && sampleResult[\'indexArr\'].indexOf(index) === -1\n                    && sampleResult[\'indexArr\'].length > 4)}, \'sample-head\']"\n                    :src="imageSrcFormat(item[\'cover_photo\'])"\n                    @error="imgError(index, \'sample\', $event)">\n                    <div v-if="sampleResult[\'imgErrList\'].indexOf(index) === -1"\n                    :class="[sampleResult[\'indexArr\'].indexOf(index) === -1 ? \'select-box-disappear\' : \'select-box-appear\', \'select-box\']">\n                        <em class="select-box-content icon icon-checkgridsmall"></em>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div slot="footer">\n            <pan-button text="这是我" color="blue" size="large" :disabled="sampleBox[\'btnDisabled\']" @on-click="sampleSelect(\'complete\')"></pan-button>\n            <div class="get-more-sculpture">\n                <p class="get-more-area"\n                @click="sampleSelect(\'more\')">以上都不是</p>\n            </div>\n        </div>\n    </pan-dialog>\n    <!-- 引导：标注我自己（更多） -->\n    <pan-dialog title="选择自己的头像" :type="\'window\'" :width="complexBox.width" :open="complexBox.open"\n    :closeMethod="complexSelect">\n        <div slot="body" class="complex-select-body">\n            <div class="complex-area">\n                <div :class="[{\'complex-unit-error\': complexResult[\'imgErrList\'].indexOf(index) !== -1}, \'complex-unit\']" v-for="(item, index) in humanData[\'complex\']"\n                    @click="chooseInComplex(item, index)">\n                    <img v-if="complexResult[\'imgErrList\'].indexOf(index) === -1"\n                    :class="[{\'head-active\': complexResult[\'indexArr\'].indexOf(index) !== -1, \'head-inactive\': complexResult[\'isClicked\'] && complexResult[\'indexArr\'].indexOf(index) === -1\n                    && complexResult[\'indexArr\'].length > 4, \'complex-head-hover\': !(complexResult[\'isClicked\'] && complexResult[\'indexArr\'].indexOf(index) === -1\n                    && complexResult[\'indexArr\'].length > 4)}, \'complex-head\']"\n                    :src="imageSrcFormat(item[\'cover_photo\'])"\n                    @error="imgError(index, \'complex\', $event)">\n                    <div v-if="complexResult[\'imgErrList\'].indexOf(index) === -1"\n                    :class="[complexResult[\'indexArr\'].indexOf(index) === -1 ? \'select-box-disappear\' : \'select-box-appear\', \'select-box\']">\n                        <em class="select-box-content icon icon-checkgridsmall"></em>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div slot="footer">\n            <pan-button text="取消" size="large" @on-click="complexSelect(\'abandon\')"></pan-button>\n            <pan-button text="这是我" color="blue" size="large" :disabled="complexBox[\'btnDisabled\']"@on-click="complexSelect(\'complete\')"></pan-button>\n        </div>\n    </pan-dialog>\n</div>\n\n',name:"myself-remark",data:function(){return{firstScreenCount:0,sampleBox:{width:460,open:!1,btnDisabled:!0},complexBox:{width:460,open:!1,btnDisabled:!0},sampleResult:{isClicked:!1,limit:5,indexArr:[],list:[],imgErrList:[]},complexResult:{isClicked:!1,limit:5,indexArr:[],list:[],imgErrList:[]}}},props:{guideOut:{type:Boolean,"default":!1},humanData:{type:Object,"default":{sample:[],complex:[]}}},watch:{firstScreenCount:function(e){e===this.humanData.sample.length&&(this.sampleBox.open=!0)}},components:{},created:function(){var e=[];this.humanData.sample.forEach(function(t){e.push(t.cover_photo)},this),this.preLoad(e)},methods:{errCb:function(e){this.$store.commit("setTip",{show:!0,msg:n.errorMsg(e),status:"caution",autoClose:!0,closeBtn:!0})},imgError:function(e,t){"sample"===t?this.sampleResult.imgErrList.push(e):this.complexResult.imgErrList.push(e)},preLoad:function(e){for(var t=this,i=0;i<e.length;i++){var s=new Image;s.src=this.imageSrcFormat(e[i]),s.onload=function(){t.firstScreenCount+=1},s.onerror=function(){t.firstScreenCount+=1}}},imageSrcFormat:function(e){var t=e?r.imageSrcFormat(e):"";return t},sampleSelect:function(e){var t=this;"more"===e?(this.sampleBox.open=!1,this.complexBox.open=!0):"complete"===e?this.sampleResult.isClicked&&(this.sampleBox.open=!1,this.sampleResult.list.length>1?this.appearAlertDlg(t.doRemarkMyself,t.sampleResult.list):this.doRemarkMyself(this.sampleResult.list)):this.sampleBox.open=!1},complexSelect:function(e){var t=this;"abandon"===e?this.complexBox.open=!1:"complete"===e?this.complexResult.isClicked&&(this.complexBox.open=!1,this.complexResult.list.length>1?this.appearAlertDlg(t.doRemarkMyself,t.complexResult.list):this.doRemarkMyself(this.complexResult.list)):this.complexBox.open=!1},appearAlertDlg:function(e,t){this.$store.commit("setDialog",{type:"confirm",title:"照片合并",width:442,content:"所选择头像对应照片将被合并到一起，并且标记为“我自己”，是否继续？",closeMethod:null,buttonConfirm:{text:"确定",color:"blue",size:"large",method:e,params:[t]},buttonCancel:{text:"取消",color:"",size:"large",method:""}})},chooseInSample:function(e,t){var i=this.sampleResult;if(-1===i.imgErrList.indexOf(t)){var s=i.indexArr.indexOf(t);i.indexArr.length<i.limit&&-1===s?(i.indexArr.push(t),i.list.push(e.tag_id),i.isClicked||(i.isClicked=!0,this.sampleBox.btnDisabled=!1)):-1!==s&&(i.indexArr.splice(s,1),i.list.splice(s,1),0===i.indexArr.length&&i.isClicked&&(i.isClicked=!1,this.sampleBox.btnDisabled=!0))}},chooseInComplex:function(e,t){var i=this.complexResult;if(-1===i.imgErrList.indexOf(t)){var s=i.indexArr.indexOf(t);i.indexArr.length<i.limit&&-1===s?(i.indexArr.push(t),i.list.push(e.tag_id),i.isClicked||(i.isClicked=!0,this.complexBox.btnDisabled=!1)):-1!==s&&(i.indexArr.splice(s,1),i.list.splice(s,1),0===i.indexArr.length&&i.isClicked&&(i.isClicked=!1,this.complexBox.btnDisabled=!0))}},doRemarkMyself:function(e){var t=this,i=e.shift(),s={person_id:i,person_uk:a.MYUK},n=function(s){s&&0===s.errno?e.length>0?t.mergePerson({from:e,to:i}):t.remarkSuccessTip(i):t.remarkFailTip()};o.postRemarkInfo(s).then(n).catch(function(){t.errCb()})},mergePerson:function(e){var t=this,i={from:JSON.stringify(e.from),to:e.to},s=function(i){i&&0===i.errno?t.searchTaskQuery({taskId:i.task_id,targetId:e.to}):t.remarkFailTip()};l.postMergePerson(i).then(s).catch(function(){t.errCb()})},searchTaskQuery:function(e){var t=this,i={taskid:e.taskId},s=setInterval(function(){var n=["running","waiting"],o=function(i){i&&0===i.errno?-1===n.indexOf(i.status)?(clearInterval(s),"success"===i.status?t.remarkSuccessTip(e.targetId):t.remarkFailTip()):t.remarkAsyncTip(i.progress):t.remarkFailTip()};l.getTaskQuery(i).then(o).catch(function(){t.errCb()})},1e3)},remarkFailTip:function(){this.$store.commit("setTip",{show:!0,msg:"标记失败",status:"caution",autoClose:!0,closeBtn:!0})},remarkSuccessTip:function(e){this.$store.commit("setTip",{show:!0,msg:"标记成功",status:"success",enterance:{text:"点击进入",href:"/disk/timeline#/faceList/"+e,reload:!0}}),n.log.send({type:"web_album_human_remark_myself_success"})},remarkAsyncTip:function(e){this.$store.commit("setTip",{show:!0,msg:"正在标记，请稍后",status:"loading",processNum:e})}}});i.exports=c});
;define("pan-timeline:widget/components/guideAuto/util/newFaceDialog/newFaceDialog.js",function(e,n,i){var a=e("base:thirdParty/vue/vue.js"),o=e("pan-timeline:widget/api/classify/getlist.js"),t=window.yunData,s=a.component("newface-dialog",{template:'\n<div class="newface-dialog">\n    <!-- 人脸弹窗说明 -->\n    <pan-dialog title="人脸分类说明" :open="isShow" :type="\'window\'" :closeMethod="closeNewFaceDlg">\n        <div slot="body" class="newface-body">\n            <p class="newface-info pb">为了帮助您更好地查找和管理图片，我们将您网盘图片中的相似人脸归为一组，您还可以为人脸标上标签。</p>\n            <p class="newface-info pb">图片数据和人脸标签都仅保存在您的个人帐号内，不会用于其他任何用途，请放心使用。</p>\n            <p class="newface-info">如需关闭，可在图片分类右上角<span class="icon icon-setting"></span>处的\n            『关闭智能分类人脸分组』关闭，关闭后您已标记的人脸标签信息将被删除，且无法使用人脸分类的相关功能。</p>\n        </div>\n        <div slot="footer">\n            <pan-button text="我知道了" size="large" color="blue" @on-click="closeNewFaceDlg"></pan-button>\n        </div>\n    </pan-dialog>\n</div>\n\n',name:"newface-dialog",data:function(){return{isShow:!1}},created:function(){this.isShow=!0},methods:{closeNewFaceDlg:function(){this.isShow=!1,o.setNewFaceSwitch({switch_on:2097152,uid:t.MYUK})}}});i.exports=s});
;define("pan-timeline:widget/components/recentUpload/recentUpload.js",function(e,t,i){"use strict";var n=e("base:thirdParty/vue/vue.js"),o=e("base:thirdParty/vue/vuex.js"),s=e("pan-timeline:widget/components/system/list/listInit/listInit.js"),l=e("pan-timeline:widget/components/topToolBar/topToolBar.js"),r=(e("pan-timeline:widget/store/index.js"),e("pan-timeline:widget/system/util/util.js")),c=o.mapGetters,a=o.mapActions,d={init:function(){var e=n.component("recent-upload",{name:"recentUpload",template:'<div class="module-recentUpload">\n    <topToolBar></topToolBar>\n    <div class="module-list-init">\n        <list-init\n        :listView="listView"\n        :headerList="headerList"\n        :hasAllChooseCK="hasAllChooseCK"\n        :listColsClickFunc="listColsClickFunc"\n        :listViewType="listViewType"\n        :listViewClass="listViewClass"\n        :recycleListConf="recycleListConf"\n        :listViewContainer="listViewContainer"\n        :emptyDesc="errorMsg"\n        :type="type"></list-init>\n    </div>\n</div>\n',data:function(){return{errorMsg:null,listView:["grid"],headerList:[{name:"全选",key:"checkall",checkbox:!0,width:"100%",order:!1}],hasAllChooseCK:!0,listColsClickFunc:function(){},listViewType:1,listViewClass:"",listViewContainer:".module-list-init",type:"recentUpload",recycleListConf:{recycleType:"grid",type:"recentUpload",container:{dom:".module-grid-container"},numLimitConf:{maxInRenderGroup:10,maxInLineGroup:function(e,t){return document.querySelector(e.dom)?Math.floor(document.querySelector(e.dom).clientWidth/t.width):5}},itemObj:{width:160,height:160},maxLineGap:function(e,t){if(document.querySelector(e.dom)){var i=Math.floor(document.querySelector(e.dom).clientWidth/t.width);if(i>6)return 5}return 8}}}},components:{ListInit:s,topToolBar:l},beforeCreate:function(){r.time("listRender-recentupload")},created:function(){var e=this.$route,t=e.name;this.$store.commit("recentUpload/setCurType",{curType:t})},methods:n.util.extend({},a({panTipClick:"panTipClick"})),activated:function(){this.$store.commit("setRecycleListConf",{recycleListConf:this.recycleListConf}),this.$store.dispatch(this.routeType+"/getListData")},computed:n.util.extend(c({contextMenu:"getContextMenu",tip:"getTip",routeType:"getRouteType"}),{})});return e}};i.exports=d.init()});
;define("pan-timeline:widget/components/searchList/searchList.js",function(t,e,i){"use strict";var s=t("base:thirdParty/vue/vue.js"),n=t("base:thirdParty/vue/vuex.js"),o=t("pan-timeline:widget/components/system/list/listInit/listInit.js"),r=t("pan-timeline:widget/components/topToolBar/topToolBar.js"),c=t("pan-timeline:widget/components/contextMenu/contextMenu.js"),a=t("pan-timeline:widget/components/system/Tip/Tip.js"),l=t("pan-timeline:widget/components/system/list/listInit/listUtil.js"),p=t("pan-timeline:widget/components/emptyList/EmptyList.js"),m=n.mapGetters,u=n.mapActions,h={uiil:{getTimeList:function(){}},init:function(){var t=s.component("recent-upload",{name:"searchList",template:'<div class="module-search-list">\n    <top-tool-bar></top-tool-bar>\n    <div class="module-list-init">\n        <list-init\n        :listView="listView"\n        :headerList="headerList"\n        :hasAllChooseCK="hasAllChooseCK"\n        :listColsClickFunc="listColsClickFunc"\n        :listViewType="listViewType"\n        :listViewClass="listViewClass"\n        :recycleListConf="recycleListConf"\n        :listViewContainer="listViewContainer"\n        :emptyDesc="emptyDesc"\n        :type="type"></list-init>\n    </div>\n</div>\n',data:function(){return{emptyDesc:"暂无匹配的结果，尝试下其他关键词吧～",listView:["grid"],headerList:[{name:"全选",key:"checkall",checkbox:!0,width:"100%",order:!1}],hasAllChooseCK:!0,listColsClickFunc:function(){},listViewType:1,listViewClass:"",listViewContainer:".module-list-init",type:"searchList",recycleListConf:{recycleType:"grid",type:"searchList",container:{dom:".module-grid-container"},numLimitConf:{maxInRenderGroup:10,maxInLineGroup:function(t,e){var i=document.querySelector(t.dom);return i?Math.floor(i.clientWidth/e.width):5}},itemObj:{width:160,height:160},maxLineGap:function(t,e){var i=document.querySelector(t.dom);if(i){var s=Math.floor(i.clientWidth/e.width);if(s>6)return 5}return 8}},searchDesc:null}},components:{"list-init":o,"top-tool-bar":r,"context-menu":c,"pan-tip":a},beforeCreate:function(){},methods:s.util.extend({setSearch:function(){var t=this.$route,e=t.name,i=t.params.searchType,s=t.params.keyword,n=1===+i?t.query.key:s;this.$store.commit("recentUpload/setCurType",{curType:e}),this.$store.commit("searchList/setSearchParam",{searchType:i,keyword:s}),null!=n&&(this.searchDesc=n)}},u({panTipClick:"panTipClick"})),created:function(){this.setSearch()},activated:function(){this.$store.commit("setRecycleListConf",{recycleListConf:this.recycleListConf}),this.$store.dispatch(this.routeType+"/getListData")},computed:s.util.extend(m({contextMenu:"getContextMenu",tip:"getTip",routeType:"getRouteType"}),{}),watch:{$route:function(){var t=this;this.setSearch();var e={},i=function(){t.$store.commit("setListEmpty",{show:!0,listEmptyComponent:p,emptyDesc:t.emptyDesc})},s=function(t){l.defaultErrCB(t)};e.emptyCb=i,e.errCb=s,this.$store.dispatch(this.routeType+"/getListData",e)}}});return t}};i.exports=h.init()});
;define("pan-timeline:widget/components/timeline/groupTimeline/groupTimeline.js",function(e,i,t){"use strict";var n=e("base:thirdParty/vue/vue.js"),o=e("base:widget/libs/jquerypacket.js"),s=e("base:thirdParty/vue/vuex.js"),a=(e("pan-timeline:widget/filters/index.js"),s.mapGetters),l={animateCount:0,init:function(){var e=n.component("groupTimeline",{name:"groupTimeline",template:'<div>\n    <div class="timeline-content-item content-item "\n        v-for="(file, index) in lineData"\n        :key="gidInfo.move"\n        :index="index"\n        :date="file.date"\n        :gid="file.gid"\n        style="position: absolute;"\n        :style="{left: file.left + \'px\', top: file.top + \'px\',background: file.isCover ? \'#fff\' : \'#f1f1f1\'}"\n        :class="{\'thumb-group-item\' : (file.gid > 0), \'choosen\': file.choose, \'shift-hover\': file.shiftHover}"\n        @click.stop=" listStatus===2 ? toggleChoose({index:file.index, date:dayGroup.dayDesc, file: file}) : openFile({index:file.index, date:dayGroup.dayDesc, file: file,lineindex:index},$event)"\n        @contextmenu.prevent="rightClick({index:file.index, date:dayGroup.dayDesc},$event)"\n         @mouseover.stop.prevent="hoverItem(file.index, dayGroup.dayDesc, $event);">\n        <span v-if="file.status === \'needMore\'"\n            class="timeline-content-more block-need-more"\n            @click.stop="loadMoreData(dayGroup.dayDesc, file)">查看更多<i class="need-more-icon icon icon-arrow-right"></i></span>\n        <span v-else-if="file.status === \'isLoading\'"></span>\n        <span v-else-if="file.status === \'isLoadingMore\'"\n            class="block-loading-more">\n            <svg class="spinner" width="26px" height="26px" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg">\n                <circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30" style="stroke:#09AAFF"></circle>\n            </svg>\n        </span>\n        <div v-else \n            class="file-container" \n            :class="{\'cover\':(file.isCover && !file.groupStatus)}">\n            <div class="fileicon"\n                :class="{\'image-err\': file.imgErr}">\n                <div class="img-container"\n                    v-if="file.thumb && !file.imgErr"\n                    :style="{backgroundImage: file.imgLoaded && file.formatThumb ? \'url(\' + file.formatThumb + \')\' : \'none\',\n                                                opacity: file.imgLoaded ? 1 : 0}">\n                </div>\n                <img class="thumb" v-if="file.thumb && !file.imgErr && !file.imgLoaded"\n                    style="visibility: hidden;"\n                    :src="{value: file.thumb} | imageFormat312"\n                    @error="imageError($event, file);"\n                    @load="imageLoaded($event, file);">\n                <div class="hoverMask"></div>\n                <div class="hoverBorder"></div>\n                <div  class="hoverCover":style="{display: (listStatus===2 && !file.choose)? \'inline-block\':\'\'}"></div>                                     \n                <div v-if="listStatus===2" class="hoverCoverBottom"></div> \n            </div>\n            <span class="timeline-checkbox" @click.stop="toggleChoose({file:file, date:dayGroup.dayDesc}) ">\n                <span v-if="listStatus===2 " class="icon icon-hollowCircle hoverCircle "></span>\n                <span class="icon circle-icon "></span>\n                <span class="icon checkgridsmall "></span>\n            </span>\n            <span class=" icon icon-imageEnlarge imageEnlargeShow" :class="[(listStatus===2 && file.groupStatus !== false) ? \'imageEnlarge\' : \'\'] " @click.stop="openFile({index:file.index, date:dayGroup.dayDesc},$event) "></span>\n            <div class="thumb-group-cover-bg" v-if="file.isCover"\n                :class="[file.groupStatus === false ? \'thumb-group-close\' : \'thumb-group-open\']">\n                <span class="thumb-group-desc" v-text="file.groupStatus === false ? file.length + \'张\' : \'收起\'"></span>\n            </div>\n        </div>\n        <div class="cover-backgound" v-if="file.groupStatus===false && file.isCover">\n                <div class="bg-one bg"></div>\n                <div class="bg-two bg"></div>\n        </div>\n    <div>\n</div>',props:{lineData:[Object,Array],dayGroup:[Object,Array],onMouseSelect:Function},data:function(){return{gidInfo:{gid:-1,index:-1,date:"",left:-1,move:!1,limit:-1,status:!1,num:-1,dealNum:0,flag:!1,thumb:"",thumbs:{}},posInfo:{},count:0,animateList:[],animateListShow:!1}},created:function(){this.$store.commit("setOnMouseSelectFunc",{onMouseSelectFunc:function(){}})},destroyed:function(){this.grouped||this.$store.commit("setOnMouseSelectFunc",{onMouseSelectFunc:this.onMouseSelect})},methods:{toggleGroup:function(e,i){var t=e.year+e.month+e.day;this.$store.dispatch("timeline/operateGroupCover",{dayStr:t,gid:e.gid,triggerLayoutCb:i})},toggleChoose:function(e){var i=e.file,t=e.date;if(i)if(i.gid>0&&i.isCover&&i.groupStatus===!1){var n=this.gidMap,o=n[t],s=i.gid,a=o&&o[s],l=a.start,r=a.start+a.length-1;this.shiftStatus?(e.index=r,e.file=a[a.length-1],this.$emit("on-toggle-choose",e)):this.$store.dispatch("timeline/setSomeChoose",{start:{day:t,index:l},end:{day:t,index:r}})}else e.index=i.index,this.$emit("on-toggle-choose",e)},openFile:function(e,i){var t=this,n=e.file,o=e.lineindex;if(null!=n&&n.gid>0&&n.isCover){var s=n.year+n.month+n.day,a=this.gidInfo;a.gid=n.gid,a.index=o,a.date=s,a.left=n.left,a.thumb=n.thumb,a.num=this.getAnimateData(),a.dealNum=Math.min(this.lineNum-o-1,a.num-1),a.limit=o+this.getAnimateData(),this.animateCount=a.num-1;var l=n.groupStatus;return a.status=l,void(l?(this.doAnimate(i),setTimeout(function(){t.toggleGroup(n)},300)):t.toggleGroup(n,function(){t.$nextTick(function(){t.doAnimate(i)})}))}this.$emit("on-open-file",e)},imageError:function(e,i){this.$emit("on-image-error",e,i)},imageLoaded:function(e,i){this.$emit("on-image-loaded",e,i)},rightClick:function(e,i){this.$emit("on-right-click",e,i)},loadMoreData:function(e,i){this.$emit("on-load-more",e,i)},hoverItem:function(e,i,t){this.$emit("on-hover-item",e,i,t)},doAnimate:function(e){for(var i=this.gidInfo,t=this,n=e.target,s=o(n).parents(".content-item"),a=s.attr("index"),l=s.nextAll(),r=0;r<i.dealNum;r++){var c=l[r],d=parseInt(a,10)+r;i.status?(this.posInfo[d]=c.style.left,function(e,n){o(e).animate({left:i.left,opacity:0},300,function(){e.style.left=t.posInfo[n],e.style.opacity=1})}(c,d)):(this.posInfo[d]=c.style.left,c.style.left="number"==typeof i.left?i.left+"px":i.left,c.style.opacity=0,function(e,i){var n=t.posInfo[i];o(e).animate({left:n,opacity:.3},300,function(){e.style.opacity=1})}(c,d))}},getAnimateData:function(){var e=this.gidInfo;return this.gidMap[e.date][e.gid].length}},computed:n.util.extend({lineNum:function(){return this.recycleListConf.numLimitConf.maxInLineGroup(this.recycleListConf.container,this.recycleListConf.itemObj)},objWidth:function(){return this.recycleListConf.itemObj.width}},a({listStatus:"getListStatus",gidMap:"getGidMap",gidArr:"getGidArr",recycleListConf:"getRecycleListConf",shiftStatus:"getShiftStatus",grouped:"getGroupStatus"})),mounted:function(){}});return e}},r={init:l.init};t.exports=r.init()});
;define("pan-timeline:widget/components/timeline/timeline.js",function(e,t,i){"use strict";var n=e("base:thirdParty/vue/vue.js"),o=e("base:thirdParty/vue/vuex.js"),l=e("base:widget/libs/underscore.js"),s=e("pan-timeline:widget/store/index.js"),r=e("pan-timeline:widget/components/system/list/listInit/listInit.js"),c=(e("pan-timeline:widget/components/operateBtn/operateBtn.js"),e("pan-timeline:widget/components/topToolBar/topToolBar.js"),e("pan-timeline:widget/components/system/list/listInit/listRecycle.js"),e("pan-timeline:widget/components/timeline/groupTimeline/groupTimeline.js")),m=window.yunData,u=o.mapGetters,a=o.mapActions,p=l.throttle(function(e){s.dispatch("timeline/triggerLayout",{resize:e}),s.commit("timeline/changeRulerPos")},80),d={init:function(){var e=n.component("timeLine",{name:"timeLine",template:'<div class="module-timelineList module-type">\n    <topToolBar\n        :type="type"></topToolBar>\n    <div class="module-list-init">\n        <list-init\n            :listView="listView"\n            :hasAllChooseCK="hasAllChooseCK"\n            :listColsClickFunc="listColsClickFunc"\n            :listViewType="listViewType"\n            :listViewClass="listViewClass"\n            :recycleListConf="recycleListConf"\n            :loadMoreDataInDay="loadMoreDataInDay"\n            :scrollListFunc="scrollListFunc"\n            :resizeEventFunc="resizeEventFunc"\n            :listItemComp="listItemComp"\n            :showRuler="showRuler"\n            :listItemClick="listItemClick"\n            :listViewContainer="listViewContainer"\n            :userArea="userArea"\n            :emptyDesc="emptyDesc"\n            :type="type"></list-init>\n    </div>\n</div>\n',data:function(){return{emptyDesc:null,listView:["timeline"],hasAllChooseCK:!1,listColsClickFunc:function(){},listViewType:1,listViewClass:"",listViewContainer:".module-list-init",userArea:[".timeline-title",".timeline-ruler"],type:"timeline",showRuler:!0,recycleListConf:{recycleType:"timeline",type:"timeline",container:{dom:".module-timeline-view"},numLimitConf:{maxInRenderGroup:20,maxInDayGroup:function(e,t){var i=10;return document.querySelector(e.dom)?Math.floor(document.querySelector(e.dom).clientWidth/t.width)*i:5*i},maxInLineGroup:function(e,t){return document.querySelector(e.dom)?Math.floor(document.querySelector(e.dom).clientWidth/t.width):5}},itemObj:{width:160,height:160},viewPortGapTimes:function(e,t){if(document.querySelector(e.dom)){var i=Math.floor(document.querySelector(e.dom).clientWidth/t.width);if(i>6)return 2}return 2},groupHeightGap:40},loadMoreDataInDay:function(e){s.dispatch("timeline/getByCluster",{dayStr:e})},scrollListFunc:function(){p.call(this)},resizeEventFunc:function(){p.call(this),s.dispatch("timeline/setRulerList")},listItemClick:this.onItemClick}},components:{ListInit:r},created:function(){var e=this.$route,t=e.name;this.$store.commit("timeline/setCurType",{curType:t})},mounted:function(){},methods:n.util.extend({onItemClick:function(){null!=localStorage&&localStorage.getItem(m.MYNAME+"_director_guide")&&!localStorage.getItem("timelineShiftTip")&&(this.$store.commit("setTip",{show:!0,msg:"按住Shift键，批量选择更多图片",status:"success",autoClose:!0,icon:"none"}),localStorage.setItem("timelineShiftTip",!0))}},a({panTipClick:"panTipClick"})),activated:function(){var e=this;this.$store.commit("timeline/setCurType",{curType:"timeline"}),this.$store.commit("setRecycleListConf",{recycleListConf:this.recycleListConf}),e.$store.dispatch(e.routeType+"/getListData")},computed:n.util.extend({listItemComp:function(){return this.grouped?c:null}},u({tip:"getTip",grouped:"getGroupStatus",contextMenu:"getContextMenu",routeType:"getRouteType"}))});return e}};i.exports=d.init()});
;define("pan-timeline:widget/components/tipLine/tipLine.js",function(t,n,i){var e=t("base:thirdParty/vue/vue.js"),c={tipLine:null,init:function(){c.tipLine=e.component("tip-line",{name:"tip-line",template:'<div class="module-tip-line" v-if="tipContent">\n    <div class="tip-content">\n        <span v-html="tipContent"></span>\n        <a v-if="btnDesc.length" class="tip-content-btn"\n            v-html="btnDesc"\n            :href="href"\n            @click="btnClick();"></a>\n        <span class="icon icon-close tip-line-close"\n            @click.stop="closeClick();"></span>\n    </div>\n</div>',props:{tipContent:{type:String,"default":""},href:{type:String,"default":"javascript:;"},btnDesc:{type:String,"default":""},btnClick:{type:Function,"default":function(){}},closeClick:{type:Function,"default":function(){this.$store.commit("setTipLineObj",{tipContent:null})}},tipLineClass:{type:String,"default":""}},watch:{tipContent:function(t){t?this.$store.commit("setContainerHeight",{containerHeight:"calc(100% - 53px)"}):this.$store.commit("setContainerHeight",{containerHeight:"100%"})}}})},Dialog:null};c.init(),i.exports=c.tipLine});
;define("pan-timeline:widget/data/yunData.js",function(a,t,n){var i={},d={};i.data={},window.yunData||(window.yunData={}),window.yunData.getPrimitiveValue=function(a){return a?i.data[a]:i.data},d.setData=function(a){if(a){if(1===arguments.length){if("object"==typeof a)for(var t in a)a.hasOwnProperty(t)&&(i.data[t]=a[t]);return window.yunData=window.yunData||{},window.yunData.ISYEARVIP=i.data.is_evip,window.yunData.ISVIP=i.data.is_vip,window.yunData.ISSVIP=i.data.is_svip,window.yunData.MYUK=i.data.uk,window.yunData.MYNAME=i.data.username,window.yunData.MYBDSTOKEN=i.data.bdstoken,window.yunData.LOGINSTATUS=i.data.loginstate,window.yunData.MYAVATAR=i.data.photo||"",window.yunData.skinName=i.data.skinName||"white",void(window.yunData.VIPLEVEL=i.data.vip_level)}"SERVERTIME"===arguments[0]&&(i.data.servertime=arguments[1]),window.yunData[arguments[0]]=arguments[1]}},d.get=function(){return i.data},n.exports=d});
;define("pan-timeline:widget/directives/index.js",function(e,i,n){"use strict";var s={"dynamic-class":{bind:function(e,i){if(/\+/.test(i.expression))e.className=i.value;else if(i.value&&i.value.length){for(var n=e.className.split(/\s+/),s="",a=0;a<n.length;a++){var t=n[a];s+=t+" "+t+"-"+i.value+" "}e.className=s.trim()}}},"image-format":{bind:function(){}},transclude:{inserted:function(e){document.body.appendChild(e)}}};n.exports=s});
;define("pan-timeline:widget/pageModule/aside/aside.js",function(e){function t(e,t){if(t.isVisible===!1?e.hide():e.show(),t.title&&e.find(l.itemTitle).text(t.title),t.iconClass&&e.find(l.imgIcon).addClass(t.iconClass),t.href&&e.find(l.itemHref).attr("href",t.href).removeAttr("cat"),t.guide){var i=t.guide;if("object"!=typeof i)throw new Error("[aside] The new nav item must has property: guide. And the guide must be an object");if(i.dom){var o=n(i.dom);i.positionX&&o.css("left",i.positionX),i.positionY&&o.css("top",i.positionY),e.find(l.itemHref).append(o)}}t.click&&"function"==typeof t.click&&e.bind("click",function(e){t.click.call(o,e)})}function i(e){var i=n(l.listItem),o=n(r);t(o,e),e.index&&e.index<i.length?i.eq(e.index).after(o):i.last().after(o)}function o(e){var i,o=n(l.listItem);if(!(e.index&&e.index<o.length))throw new Error("[aside] The index of item which you will change must in the range of 0 ~ "+o.length);i=o.eq(e.index),t(i,e)}var n=e("base:widget/libs/jquerypacket.js"),s=e("base:widget/storage/storage.js"),a=e("system-core:context/context.js").instanceForSystem,d=a.message,c=a.Broker,r='<li node-type="dcca2ba" class="ocvZ08Z"><a node-type="fmpfE6wZ" class="lnaiZVyE" hideFocus="true" href="javascript:void(O);"><span class="text"><span node-type="gekLwva" class="ueLzXZ"></span><span node-type="biLj6L"></span></span></a></li>',l={mod:".module-aside",listItem:".fOHAbxb li[data-key]",picHotIco:'em[node-type~="auikEbpa"]',picItem:'a[node-type~="qhpsE9yE"]',itemTitle:'span[node-type~="biLj6L"]',imgIcon:'span[node-type~="gekLwva"]',itemHref:"a"},m=n(l.mod),p={list:function(){location.href="/disk/home#/all?path=%2F&vmode=list"},pic:function(){return!1},doc:function(){location.href="/disk/home#/category?type=4&vmode=list"},video:function(){location.href="/disk/home#/category?type=1&vmode=list"},mbt:function(){location.href="/disk/home#/category?type=7&vmode=list"},music:function(){location.href="/disk/home#/category?type=2&vmode=list"},other:function(){location.href="/disk/home#/category?type=6&vmode=list"}};d.listen("nav-add-item",i),function(){m.find(".FvBGOQ").prev(".ktLqjE").show(),m.find(".JKEQDvb").prev(".ktLqjE").show(),m.delegate(l.listItem,"mouseover",function(e){n(e.target).closest(l.listItem).addClass("vgKGgu")}),m.delegate(l.listItem,"mouseout",function(e){n(e.target).closest(l.listItem).removeClass("vgKGgu")}),m.delegate(l.listItem,"click",function(e){var t=n(e.target).closest(l.listItem),i=t.data("key"),o="leftSideNavigator_"+i;a.log.send({type:o,value:i}),a.spy.checkNodeMonitorSync("leftNav",o),p[i]&&p[i]()}),s.getItem("redPointNotice")||n.ajax({url:"/api/image/getreddot",dataType:"json",success:function(e){if(e.isdot===!0){var t=n('li[data-key="pic"]');t.append('<div class="qpaZXYa" node-type="iniExQZ"></div>').one("click",function(){var e=n('div[node-type="iniExQZ"]');e.length&&n(this).remove(e)}),s.setItem("redPointNotice",!0)}}}),n.browser.msie&&6==n.browser.version||n.getJSON("/api/image/getuinfo",function(e){e&&0==e.errno&&2==e.lt_flag&&o({index:1,href:"/disk/timeline"})})}(),c.initButtonBroker([{name:"aside-middle",config:{className:"iwZ7Pa",container:n(".module-aside .FvBGOQ")}},{name:"aside-bottom",config:{className:"qkmaGmE",container:n(".module-aside .JKEQDvb")}}])});
;define("pan-timeline:widget/system/vueExtend/vueExtend.js",function(e,t,r){"use strict";var n=e("base:thirdParty/vue/vue.js"),u={getState:function(e,t){if(e.curType){var r=e[e.curType].hasOwnProperty(t)?e[e.curType][t]:e[t];return r}return e[t]},setState:function(e,t,r){e.curType&&e[e.curType].hasOwnProperty(t)?n.set(e[e.curType],t,r):n.set(e,t,r)},extendStore:function(e){var t={},r=function(e,t){for(var r=["state","getters","actions","mutations"],u=0;u<r.length;u++){var s=r[u];if(null!=t[s]){e[s]=e[s]||{};var a="state"===s?JSON.parse(JSON.stringify(t[s])):t[s];e[s]=n.util.extend(e[s],a)}}return e};if(null!=e)for(var u=0;u<e.length;u++)null!=e[u]&&(t=r(t,e[u]));return t}};r.exports=u});
;define("pan-timeline:widget/system/fileService/fileOperate/fileOperate.js",function(e,l,a){var r=e("base:widget/tools/tools.js"),d=e("system-core:context/context.js").instanceForSystem,i=d.router,m=d.pluginControl,n=m.Registry,o=m.BrokerData.getAllData().fileIcon;a.exports.getInfo=function(e,l,a,d,m){e=e||"";var c=e.substring(e.lastIndexOf("/")+1),t={fileName:c,name:r.toEntity(c)};if(d)return t.smallIcon="dir-multi-small",t.middleIcon="dir-multi-middle",t.largeIcon="dir-multi-large",t;if(l)return e.match(/^\/apps$/)?(t.smallIcon="dir-apps-small",t.largeIcon="dir-apps-large",t.middleIcon="dir-apps-middle",t.name="我的应用数据",t):e.match(/^\/百度云收藏$/)?(t.smallIcon="dir-cang-small",t.largeIcon="dir-cang-large",t.middleIcon="dir-cang-middle",t.name="我的收藏",t):e.match(/^\/来自PC的备份文件$/)?(t.smallIcon="dir-backup-small",t.largeIcon="dir-backup-large",t.middleIcon="dir-backup-middle",t):e.match(/^\/apps\//)||e.match(/^\/百度云收藏\//)||e.match(/^\/来自PC的备份文件\//)?(t.smallIcon="dir-app-small",t.largeIcon="dir-app-large",t.middleIcon="dir-app-middle",t):e.match(/^cardHolder/)?(t.smallIcon="dir-card-small",t.largeIcon="dir-card-large",t.middleIcon="dir-card-middle",t.name="我的卡包",t):e.match(/^shareHolder/)?(t.smallIcon="dir-share-small",t.largeIcon="dir-share-large",t.middleIcon="dir-share-middle",t.name="共享给我的文件夹",t):m?(t.smallIcon="dir-share-small",t.largeIcon="dir-share-large",t.middleIcon="dir-share-middle",t):"sharedir"===i.currentRouteName?(t.smallIcon="dir-share-small",t.largeIcon="dir-share-large",t.middleIcon="dir-share-middle",t):(t.smallIcon="dir-small",t.largeIcon="dir-large",t.middleIcon="dir-middle",t);t.largeIcon="default-large",t.smallIcon="default-small",t.middleIcon="default-middle";var s=-1!==e.lastIndexOf(".")?r.getFileCategory(e):"*";o[s]&&(3===o[s].length?(t.smallIcon=o[s][0],t.largeIcon=o[s][1],t.middleIcon=o[s][2]):2===o[s].length?(t.smallIcon=o[s][0],t.largeIcon=o[s][1]):(t.smallIcon=o[s],t.largeIcon=o[s]));var g=n.getDefaultPluginIdByExtension(s);return!a&&g&&(g=n.getPluginById(g).name+"@"+n.getOtherInfoById(g).group),t.plugin=g,t};var c=["dir","multi","shouchang","yingyong","yingyong_child","beifen","doc","docx","xls","xlsx","ppt","pptx","pdf","txt","jpg","jpeg","gif","bmp","png","jpe","cur","svg","svgz","tif","tiff","ico","wma","wav","mp3","aac","ra","ram","mp2","ogg","aif","mpega","amr","mid","midi","m4a","wmv","rmvb","mpeg4","mpeg2","flv","avi","3gp","mpga","qt","rm","wmz","wmd","wvx","wmx","wm","swf","mpg","mp4","mkv","mpeg","mov","asf","zip","rar","torrent"];a.exports.isOpenedFile=function(e,l){return l&&"torrent"===e?!1:c.indexOf(e)>=0}});
;define("pan-timeline:widget/store/componentsStore/timeline/timeline-list.js",function(t,e,i){"use strict";var n=t("base:thirdParty/vue/vue.js"),o=t("pan-timeline:widget/api/timeline/getlist.js"),r=t("pan-timeline:widget/system/fileService/fileOperate/fileOperate.js"),a=t("pan-timeline:widget/components/system/list/listInit/listUtil.js"),s=t("pan-timeline:widget/system/vueExtend/vueExtend.js"),l=t("base:widget/libs/underscore.js"),u=t("pan-timeline:widget/system/util/util.js"),h=t("system-core:context/context.js").instanceForSystem,c={fixListData:function(t,e,i){for(var o=t.length,a=(new Date).getTime(),s=0;o>s;s++){var l=t[s].year+t[s].month+t[s].day;n.set(t[s],"date",l),t[s].moreInfo=r.getInfo(t[s].path,t[s].isdir,!0),t[s].iddir=void 0===t[s].iddir?0:t[s].iddir,n.set(t[s],"choose",e),i&&10>s&&(t[s].imgOnloadStartTime=a)}return t}},d={curType:"timeline",grouped:!1,timeline:{cluster:0,yearCluster:[],yearCur:-1,timeLineDataList:{},timeLineList:{},countList:{},countListForShow:{},timeLineDataInfo:{},rulerList:[],clickPos:null,packUpInfo:{},groupChooseAll:{},shiftHoverArr:[],hasRendered:!1,needMoreDataForInit:!1,renderHeightObj:{},yearMonthHeightObj:{},thumbnailCount:0}},g={getTimeLineDataList:function(t){return s.getState(t,"timeLineDataList")},getYearCluster:function(t){return s.getState(t,"yearCluster")},getTimeLineList:function(t){return s.getState(t,"timeLineList")},getPackUpInfo:function(t){return s.getState(t,"packUpInfo")},getTimeLineDataInfo:function(t){return s.getState(t,"timeLineDataInfo")},getGroupChooseAll:function(t){return s.getState(t,"groupChooseAll")},getCountList:function(t){return s.getState(t,"countList")},getRulerList:function(t){return s.getState(t,"rulerList")},getCurRulerPos:function(t){return s.getState(t,"clickPos")},getGroupStatus:function(t){return s.getState(t,"grouped")},getGidMap:function(t){return s.getState(t,"gidMap")},getGidArr:function(t){return s.getState(t,"gidArr")},getTimelineThumbnailCount:function(t){return s.getState(t,"thumbnailCount")}},m={"timeline/setStateInit":function(t){t.grouped=!1,t.timeline.clickPos=0},"timeline/setCurType":function(t,e){null!=e.curType&&(t.curType=e.curType)},"timeline/setYearCluster":function(t,e){var i=[];if(null!=e.yearCluster){for(var n=0;n<e.yearCluster.length;n++)i.push(e.yearCluster[n].year);var o="";i.indexOf(!1)&&(o=i.splice(i.indexOf("other"),1)[0]),i=i.sort(function(t,e){return e-t}),o&&i.push(o)}else null!=e.yearClusterList&&(i=e.yearClusterList);s.setState(t,"yearCluster",i),s.setState(t,"yearCur",0)},"timeline/setYearCur":function(t,e){s.setState(t,"yearCur",e.yearCur)},"timeline/setTimeline":function(t,e){if(e.timelineList&&e.timelineList.length){var i=e.timelineList,n=i[0].year,o=s.getState(t,"timeLineList")||{};o[n]=o[n]||{};for(var r=0;r<i.length;r++){var a=i[r],l=a.month,u=a.day,h=n+l+u+"";o[n][l]=o[n][l]||[],o[n][l]=o[n][l].concat(h).sort()}s.setState(t,"timeLineList",o)}else if("delete"===e.op&&null!=e.dayStr){var h=e.dayStr,c=s.getState(t,"timeLineList"),d=s.getState(t,"yearCluster"),n=h.slice(0,4),l=h.slice(4,6);if(h.indexOf("other")>-1&&(n="other",l="other"),c[n]&&c[n][l]){var g=c[n][l];g.splice(g.indexOf(h),1),0===g.length&&(delete c[n][l],"{}"===JSON.stringify(c[n])&&(delete c[n],d.splice(d.indexOf(n),1),0===d.length&&s.setState(t,"rulerList",[])))}}},"timeline/setCountList":function(t,e){if(null!=e.time&&null!=e.count){var i=(t.dispatch,s.getState(t,"countList")),n=s.getState(t,"countListForShow");if(i[e.time]&&null!=i[e.time].count){if(e.isTrusted)if(i[e.time].isTrusted=!0,"delete"===e.op)i[e.time].count-=e.count;else if("deleteAll"===e.op||0===e.start&&0===e.count)i&&delete i[e.time],n&&delete n[e.time];else if(0===e.start)i[e.time].count=e.count;else{var o=i[e.time].count?i[e.time].count:0;i[e.time].count=e.count+o}}else i[e.time]={count:e.count,isTrusted:!0}}else if(e.countList&&e.countList.length)for(var i=e.countList,r=s.getState(t,"countList"),a=0;a<i.length;a++){var l=i[a].year+i[a].month+i[a].day,u=i[a].count?i[a].count:1;r[l]={count:u,isTrusted:!1}}},"timeline/setGroupStatus":function(t,e){if(null!=e.dayStr&&null!=e.gid){var i=s.getState(t,"gidMap"),n=e.dayStr,o=e.gid;if(null!=i[n]&&null!=i[n][o]){i[n][o].groupStatus=!i[n][o].groupStatus;for(var r=i[n][o].file,a=i[n][o].groupStatus,l=r.length||0,u=0;l>u;u++)r[u].groupStatus=a}}},"timeline/setTimeLineDataInfo":function(t,e){if(null!=e.dayStr){var i=s.getState(t,"timeLineDataInfo");i[e.dayStr]=i[e.dayStr]||{},null!=e.isLoading&&n.set(i[e.dayStr],"isLoading",e.isLoading),null!=e.hasMore&&(e.hasMore&&null!=e.start&&n.set(i[e.dayStr],"start",e.start+100),n.set(i[e.dayStr],"hasMore",e.hasMore)),null!=e.hasRendered&&n.set(i[e.dayStr],"hasRendered",e.hasRendered)}},"timeline/setPackUpInfo":function(t,e){var i=e.date,o=s.getState(t,"packUpInfo");void 0!==e.choose?n.set(o,i,e.choose):n.set(o,i,!o[i])},"timeline/setGroupAllChoose":function(t,e){var i=e.date,o=s.getState(t,"groupChooseAll");void 0!==e.choose?n.set(o,i,e.choose):n.set(o,i,!o[i])},"timeline/changeRulerPos":function(t,e){var i=s.getState(t,"rulerList");if(i){if(0===i.length)return;if(e&&null!=e.clickPos)return void s.setState(t,"clickPos",e.clickPos);var n=document.querySelector(".module-list-view"),o=document.querySelector(".timeline-container"),r=document.querySelector(".module-list-init"),a=document.querySelector(".timeline-ruler");if(n&&o&&a&&r){var l,u=o.offsetHeight,h=r.offsetHeight,c=n.scrollTop;l=u===h?0:c/(u-h);var d=a.offsetHeight;s.setState(t,"clickPos",l*d)}}},"timeline/setShiftHoverArr":function(t,e){e.shiftHoverArr&&s.setState(t,"shiftHoverArr",e.shiftHoverArr)},"timeline/setHasRendered":function(t,e){null!=e.hasRendered&&s.setState(t,"hasRendered",e.hasRendered)},"timeline/setMoreDataForInit":function(t,e){e&&null!=e.needMore&&s.setState(t,"needMoreDataForInit",e.needMore)},"timeline/renderHeightObj":function(t,e){if(e)if(null!=e.dayStr&&null!=e.height){var i=s.getState(t,"renderHeightObj");i&&(i[e.dayStr]=e.height)}else if(e.heightObj)s.setState(t,"renderHeightObj",e.heightObj);else if(null!=e.sumHeight){var i=s.getState(t,"renderHeightObj");i&&(i.sumHeight=e.sumHeight)}},"timeline/thumbnailCount":function(t,e){e&&e.thumbnailCount&&s.setState(t,"thumbnailCount",e.thumbnailCount)}},f={"timeline/getListData":function(t,e){var i=(t.commit,t.state),o=t.dispatch,r=(t.rootState,s.getState(i,"hasRendered"));r?n.nextTick(function(){o("timeline/triggerLayout",{resize:!0})}):o("timeline/getClusters",{emptyCb:e&&e.emptyCb}).then(function(){o("timeline/getTimeline",{getListDataSucc:function(t){var n=function(){for(var t=s.getState(i,"yearCluster"),n=s.getState(i,"yearCur"),r=n;r<t.length;r++)o("timeline/getTimeline",e)};if(t&&t.length){var r=t[0].year+t[0].month+t[0].day;o("timeline/getByCluster",{dayStr:r}).then(function(){n()})}else n()}})})},"timeline/getClusters":function(t,e){var i=t.commit,n=(t.state,t.rootState),r=n.isNewVersion,s=function(t){t?0===t.errno?t.list&&t.list.length?i("timeline/setYearCluster",{yearCluster:t.list}):e&&"function"==typeof e.emptyCb&&e.emptyCb():a.defaultErrCB(t.errno):a.defaultErrCB()};return o.getClusters({isNewApi:r}).then(function(t){s.call(this,t)}).catch(function(){a.defaultErrCB()})},"timeline/getTimeline":function(t,e){var i=t.commit,n=t.state,r=t.dispatch,a=t.rootState,l=a.isNewVersion,u=s.getState(n,"yearCur");s.setState(n,"yearCur",u+1);var h=s.getState(n,"yearCluster"),c=s.getState(n,"timeLineList"),d=h[u],g={},m=function(t){if(t&&0===t.errno){if(t.list&&0===t.list.length){var o=h.indexOf(d);h.splice(o,1),i("timeline/setYearCluster",{yearClusterList:h});var a=h.length,l=s.getState(n,"timeLineList"),g=Object.keys(l);g.length===a&&r("timeline/setRulerList",{setLog:!0});var m=Math.max(0,s.getState(n,"yearCur"));s.setState(n,"yearCur",m-1)}else if(t.list&&t.list.length){i("timeline/setTimeline",{timelineList:t.list}),i("timeline/setCountList",{countList:t.list});var f=s.getState(n,"needMoreDataForInit");f&&(i("timeline/setMoreDataForInit",{needMore:!1}),r("timeline/loadMoreDataForInit",{data:t.list}));var a=h.length,g=Object.keys(c);g.length===a&&r("timeline/setRulerList",{setLog:!0}),r("timeline/triggerLayout",{caculateHeight:!0,year:h[u]})}t.list&&e&&"function"==typeof e.getListDataSucc&&e.getListDataSucc.call(this,t.list)}};if(h&&h.length&&u<=h.length-1){if(isNaN(+h[u])&&1!==h.length){var f=[{year:"other",month:"other",day:"other",count:1}];return i("timeline/setTimeline",{timelineList:f}),i("timeline/setCountList",{countList:f})}return l?g.year=h[u]:g.condition=JSON.stringify({year:h[u]}),g.isNewApi=l,o.getTimeline(g).then(function(t){m.call(this,t)}).catch(function(){})}e&&"function"==typeof e.emptyCb&&e.emptyCb()},"timeline/getByCluster":function(t,e){if(e){var i=t.commit,n=t.state,r=t.dispatch,l=t.rootState,u=l.isNewVersion,h=e.dayStr,c=s.getState(n,"timeLineDataInfo"),d=c[h]||{},g=s.getState(n,"grouped"),m=s.getState(n,"countList"),f=s.getState(n,"timeLineDataList"),p=d.start?d.start:0,S={},y=function(t){if(t&&0===t.errno){if(0===t.list.length&&t.has_more)return i("timeline/setTimeLineDataInfo",{dayStr:h,hasMore:t.has_more,start:p,len:t.list.length,isLoading:!1}),void r("timeline/getByCluster",e);if(t.list&&t.list.length>=0){var o=s.getState(n,"hasRendered");o||i("timeline/setHasRendered",{hasRendered:!0}),"other"===L&&(h="otherotherother",r("timeline/triggerLayout",{caculateHeight:!0,year:"other"}));var u=f&&f[h]&&f[h].length||0;r("timeline/setTimeLineDataList",{timelineData:t.list,startNum:u,grouped:g||!1,dayStr:h,op:"add"}),0!==p||0!==t.list.length||t.has_more||i("timeline/setTimeline",{dayStr:h,op:"delete"}),i("timeline/setTimeLineDataInfo",{dayStr:h,hasMore:t.has_more,start:p,len:t.list.length,isLoading:!1}),i("setListStatus",{listStatus:2===l.list.listStatus?2:1});var d=!0,S=m[h]&&m[h].count,y=f[h]&&f[h].length;S>y&&c[h]&&c[h].hasRendered&&(d=!1),i("timeline/setCountList",{time:h,count:t.list.length,start:p,isTrusted:!0}),r("timeline/setCountListForShow",{dayStr:h});var v=s.getState(n,"yearCluster"),C=s.getState(n,"timeLineList");r("timeline/triggerLayout",{dayStr:h,resize:d,isFirst:v&&v.length!==Object.keys(C)})}else i("timeline/setTimeLineDataInfo",{dayStr:h,isLoading:!1,hasMore:!1})}else i("timeline/setTimeLineDataInfo",{dayStr:h,isLoading:!1}),a.defaultErrCB(t.errno)};if(d&&d.isLoading!==!0){var v=g?1:0,L=e.year||h.slice(0,4),C=e.month||h.slice(4,6),I=e.cluster||h.slice(6,8);return h&&h.indexOf("other")>-1&&(L="other",C="other",I="other"),i("timeline/setTimeLineDataInfo",{dayStr:h,isLoading:!0}),S=u?{key:"day_data",start:p,format:1,grouped:v,day:L.indexOf("other")>-1?"other":L+C+I+""}:{key:"day",start:p,thumb:1,type:1,condition:JSON.stringify({year:L,month:C}),cluster:I,grouped:v},S.isNewApi=u,o.getByCluster(S).then(function(t){y.call(this,t)}).catch(function(){a.defaultErrCB()})}}},"timeline/loadMoreDataForInit":function(t,e){if(e&&e.data){var i=t.dispatch,n=e.data,o=n[0].year+n[0].month+n[0].day;i("timeline/getByCluster",{dayStr:o})}},"timeline/triggerLayout":function(t,e){var i=(e.dayStr,t.commit),n=t.state,o=t.dispatch,r=t.rootState,l=r.list.recycleListConf,u=s.getState(n,"timeLineDataInfo"),h=s.getState(n,"timeLineDataList"),c=s.getState(n,"timeLineList"),d=s.getState(n,"groupDataList"),g=s.getState(n,"countList"),m=s.getState(n,"countListForShow"),f=s.getState(n,"grouped"),p=s.getState(n,"renderHeightObj"),S=s.getState(n,"yearMonthHeightObj"),y=s.getState(n,"yearCluster"),v=function(){null!=e.dayStr&&i("timeline/setTimeLineDataInfo",{dayStr:e.dayStr,hasRendered:!0}),i("setListStatus",{listStatus:2===r.list.listStatus?2:1})},L=function(){},C={recycleListConf:l,dataInfo:e.dataInfo||u,countList:g,countListForShow:m,afterLayoutFunc:e.afterLayoutFunc||v,afterChangeHeight:e.afterChangeHeight||L,resize:e.resize,dayStr:e.isFirst?null:e.dayStr,renderHeightObj:p,timeLineList:c,yearMonthHeightObj:S,caculateHeight:e.caculateHeight,year:e.year},I=e.data||h;if(f&&(I=d),e.reload===!0){var M=document.querySelector(".module-list-view");M&&(M.scrollTop=0),i("setListStatus",{listStatus:0})}o("triggerLayout",{data:I,params:C}),0===y.length&&a.showListEmpty()},"timeline/setTimeLineDataList":function(t,e){var i=t.state,o=t.commit,r=t.dispatch,a=s.getState(i,"groupChooseAll"),l=s.getState(i,"packUpInfo"),u=s.getState(i,"timeLineDataList"),h=s.getState(i,"groupDataList");if(e.timelineData&&e.timelineData.length>=0){var d=e.timelineData,g=u,h=h,m=e.startNum||0;if(0===m&&0===d.length){var f=e.dayStr;if(g&&delete g[f],h&&delete h[f],u&&n.util.remove(u,f),r("timeline/setRulerList"),"function"==typeof e.emptyCb){var p=!1;for(O in u)p=O&&O.length?!0:!1;if(!p)return void e.emptyCb()}}else if(e.grouped){var S,y=s.getState(i,"gidMap"),v=(s.getState(i,"gidArr"),s.getState(i,"coverIndexArr")),f=d[0].year+d[0].month+d[0].day,L=y[f]=y[f]||{},C=[],I=g[f]||[],M={},D=[];"change"===e.op&&(M=L,S=e.timelineData);var w=[];if("add"===e.op||"delete"===e.op){I=[];for(var x=0;x<d.length;x++){var O=d[x],b=m+x;if(O.index=b,O.gid>0){O.isCover=!1,O.groupStatus=!1;var T=M[O.gid]=M[O.gid]||{};T.indexArr=T.indexArr||[],T.indexArr.push(O.index),T.groupStatus=T.groupStatus||!1,T.file=T.file||[],0===T.file.length&&(O.isCover=!0,O.groupStatus=T.groupStatus,T.start=b),T.file.push(O),D.indexOf(O.gid)<0&&D.push(O.gid),I.push(O)}else I.push(O)}for(var x=0;x<D.length;x++){var A=D[x],H=M[A],F=H.file,j=F[0];if(F.length<=1)delete M[A],delete j.isCover,delete j.groupStatus;else if(w.push(j.index),H.start=j.index,H.length=j.length=F.length,null!=L[A]){var k=++L[A].groupIndex,R=+(A+"."+k);L[R]=H,j.gid=R}else L[A]=H,L[A].groupIndex=0}S=I,v[f]=(v[f]||[]).concat(w),M=L}w=v[f].sort(function(t,e){return t-e});var P=0,N=void 0===a[f]?!1:a[f];N&&"add"===e.op&&r("timelline/setChoose",{lists:S,date:f}),S=(g[f]||[]).concat(c.fixListData(S,N));for(var G=0;G<w.length;G++){var B=w[G],E=S[B],q=E.gid,U=M[q]&&M[q].length||0,_=M[q]&&M[q].groupStatus;C=C.concat(S.slice(P,B)),P=B+U,C=C.concat(_?S.slice(B,B+U):S.slice(B,B+1))}C=C.concat(S.slice(P)),h[f]=C,("add"===e.op||"delete"===e.op)&&(g[f]=S)}else{for(var f=d[0].year+d[0].month+d[0].day,N=void 0===a[f]?!1:a[f],m=e.startNum||0,x=0;x<d.length;x++){var O=d[x],k=m+x;O.index=k}if("delete"===e.op)return void n.set(u,f,d);var Y=s.getState(i,"thumbnailCount"),z=!1;if(0===Y&&d&&d.length){var J=s.getState(i,"countList"),V=J&&Object.keys(J).countingSort()||[];f===V[0]&&(o("timeline/thumbnailCount",{thumbnailCount:d.length<10?d.length:10}),z=!0)}var W=c.fixListData(d,N,z);N&&"add"===e.op&&r("timelline/setChoose",{lists:W,date:f});var g=(g[f]||[]).concat(d);n.set(l,f,void 0===l[f]?!1:l[f]),n.set(a,f,N),n.set(u,f,g)}}},"timelline/setChoose":function(t,e){for(var i=e.lists,n=e.date,o=t.commit,r=t.rootState,a=r.list.choosedItemArr,s=r.list.chooesedItemMap,l=(r.list.chooseLength,i.length),u=0;l>u;u++)a.push(i[u]),s[n]=s[n]?s[n]:[],s[n].push(a.length-1);o("setChooesedItemMap",{chooesedItemMap:s}),o("setChoosedItemArr",{choosedItemArr:a})},"timeline/setChoosedItem":function(t,e){{var i=e.index,o=e.date,r=t.commit,a=t.state,l=t.rootState,u=(l.list.chooseLength,s.getState(a,"timeLineDataList")),h=u[o],c=l.list.choosedItemArr,d=l.list.chooesedItemMap;l.list.listStatus}if(h&&h[i])if(h[i].choose){n.set(h[i],"choose",!1);var g=d[o],m=c.indexOf(h[i]);c.splice(m,1),n.util.remove(g,m);for(var f in d)for(var p=d[f],S=p.length,y=0;S>y;y++)p[y]>m&&(p[y]=p[y]-1)}else n.set(h[i],"choose",!0),c.push(h[i]),d[o]=d[o]?d[o]:[],d[o].push(c.length-1);r("setChooesedItemMap",{chooesedItemMap:d}),r("setChoosedItemArr",{choosedItemArr:c});var v=!1,L=l.list;L&&L.chooesedItemMap&&L.chooesedItemMap[o]&&u[o]&&L.chooesedItemMap[o].length===u[o].length&&(v=!0),r("timeline/setGroupAllChoose",{date:o,choose:v})},"timeline/setchooseOneDay":function(t,e){var i=e.date,o=t.commit,r=t.state,a=t.rootState,l=a.list.choosedItemArr,u=a.list.chooesedItemMap,h=(a.list.chooseLength,s.getState(r,"timeLineDataList")),c=s.getState(r,"groupChooseAll"),d=h[i],g=d&&d.length||0;o("timeline/setGroupAllChoose",{date:i});var m=c[i];if(m)for(var f=0;g>f;f++){var p=d[f];p.choose||(n.set(p,"choose",!0),l.push(p),u[i]=u[i]?u[i]:[],u[i].push(l.length-1))}else{for(var f=(u[i],0);g>f;f++){var p=d[f];if(p.choose){n.set(p,"choose",!1);var S=l.indexOf(p);l.splice(S,1)}}u[i].splice(0,u[i].length)}o("setChooesedItemMap",{chooesedItemMap:u}),o("setChoosedItemArr",{choosedItemArr:l})},"timeline/setSomeChoose":function(t,e){var i=t.dispatch;i("timeline/setMultiProcess",n.util.extend({op:"choose"},e))},"timeline/setSomeHover":function(t,e){var i=t.dispatch;i("timeline/setMultiProcess",n.util.extend({op:"hover"},e))},"timeline/setMultiProcess":function(t,e){var i=t.state,o=t.commit,r=(t.dispatch,t.rootState);if("hover"===e.op){var a=s.getState(i,"shiftHoverArr");if(a.length){for(var l=0;l<a.length;l++)n.set(a[l],"shiftHover",!1);a=[]}}if(e.start&&e.start.day&&null!=e.start.index&&e.end&&e.end.day&&null!=e.end.index){for(var u=r.list.choosedItemArr,h=r.list.chooesedItemMap,c=(r.list.chooseLength,e.start.day),d=e.start.index,g=e.end.day,m=e.end.index,f=s.getState(i,"timeLineDataList"),p=s.getState(i,"countList"),S=p&&Object.keys(p).countingSort()||[],y=S.indexOf(c),v=S.indexOf(g),L=Math.min(y,v),C=Math.max(y,v),l=L;C>=l;l++){var I=S[l],M=f[I],D=0,w=M.length-1;I===c&&(D=d),I===g&&(w=m);for(var x=Math.min(Math.min(D,w),M.length-1),O=Math.min(Math.max(D,w),M.length-1),b=x;O>=b;b++){var T=M[b];if("hover"===e.op)n.set(T,"shiftHover",!0),a.push(T);else if(null!=T)if(T.choose){if(!r.list.shiftStatus){n.set(T,"choose",!1);var A=h[I],H=u.indexOf(T);u.splice(H,1),n.util.remove(A,H);for(var F in h)for(var j=h[F],k=j.length,R=0;k>R;R++)j[R]>H&&(j[R]=j[R]-1)}}else n.set(T,"choose",!0),u.push(T),h[I]=h[I]||[],h[I].push(u.length-1)}"choose"===e.op&&(h[I].length===f[I].length?o("timeline/setGroupAllChoose",{date:I,choose:!0}):o("timeline/setGroupAllChoose",{date:I,choose:!1}))}"choose"===e.op?(o("setChooesedItemMap",{chooesedItemMap:h}),o("setChoosedItemArr",{choosedItemArr:u})):"hover"===e.op&&o("timeline/setShiftHoverArr",{shiftHoverArr:a})}},"timeline/cancelAllChoose":function(t){var e=t.commit,i=t.state,o=t.rootState,r=o.list.choosedItemArr,a=o.list.chooesedItemMap,l=(o.list.chooseLength,s.getState(i,"timeLineDataList"));for(var u in a){e("timeline/setGroupAllChoose",{date:u,choose:!1});for(var h=a[u],c=h.length,d=0;c>d;d++){var g=r[h[d]],m=l[u].indexOf(g),f=l[u][m];f&&n.set(f,"choose",!1)}a[u].splice(0,a[u].length)}r.splice(0,r.length),e("setChooesedItemMap",{chooesedItemMap:a}),e("setChoosedItemArr",{choosedItemArr:r})},"timeline/updateBackedDatadata":function(t,e){var i=t.state,o=t.commit,r=t.dispatch,a=e.dayData,l=t.rootState,u=l.list.choosedItemArr,h=l.list.chooesedItemMap,c=(l.list.chooseLength,s.getState(i,"timeLineDataList")),d=[];if(a)for(var g in a){for(var m=a[g],f=m.length,p=0;f>p;p++){var S=m[p];n.util.remove(c[g],S);var y=u.indexOf(S);if(y>-1){u.splice(y,1),n.util.remove(h[g],y);for(var v in h)for(var L=h[v],C=L.length,I=0;C>I;I++)L[I]>y&&(L[I]=L[I]-1)}}d.indexOf(g)<0&&d.push(g),r("timeline/setCountForFileOp",e),r("timeline/setCountListForShow",{dayStr:g})}else{for(var g in h){for(var m=h[g],f=m.length,p=0;f>p;p++){var S=u[m[p]];n.util.remove(c[g],S)}d.indexOf(g)<0&&d.push(g);var M={op:e.op,emptyCb:e.emptyCb,additionalList:{}};M.additionalList[g]=h[g],r("timeline/setCountForFileOp",M),r("timeline/setCountListForShow",{dayStr:g}),h[g].splice(0,h[g].length)}u.splice(0,u.length)}o("setChooesedItemMap",{chooesedItemMap:h}),o("setChoosedItemArr",{choosedItemArr:u});for(var p=0;p<d.length;p++){var D=d[p];r("timeline/setTimeLineDataList",{timelineData:c[D],grouped:s.getState(i,"grouped"),startNum:0,dayStr:D,emptyCb:e.emptyCb,op:"delete"})}r("timeline/triggerLayout",{resize:!0})},"timeline/setCountForFileOp":function(t,e){var i=t.state,n=t.commit,o=e.additionalList||e.dayData;for(var r in o){var a={time:r,isTrusted:!0,count:o[r].length};e.op&&"delete"===e.op?a.op=e.op:void 0===i.countList[r]&&(a.start=0),n("timeline/setCountList",a)}},"timeline/updateYearMonthHeight":function(t,e){var i=t.state;e&&e.yearMonthHeightObj&&s.setState(i,"yearMonthHeightObj",e.yearMonthHeightObj)},"timeline/setRulerList":function(t,e){var i=t.state,o=t.commit,r=s.getState(i,"yearCluster"),a=s.getState(i,"timeLineList"),l=r.length,c=Object.keys(a),d=document.querySelector(".module-timeline-view"),g=0;if(d&&c.length===l){for(var m=s.getState(i,"countList"),f=s.getState(i,"countListForShow"),p=t.rootState,S=p.list.recycleListConf,y=S.itemObj.height||176,v=Math.floor(d.clientWidth/y),L=S.groupHeightGap||56,C=[],I=function(t){var e=s.getState(i,"timeLineDataInfo"),n=m[t]&&m[t].isTrusted,o=null!=f&&null!=f[t]?f[t]&&f[t].count||0:m[t]&&m[t].count||0;return n||(o=o>100?101:Math.min(o,100)),n&&e[t]&&e[t].hasMore&&o>0&&o++,g+=o,o},M=function(t,e){if(null!=t&&null!=e){for(var i=a[t][e]||[],n=0,o=0,r=0;r<i.length;r++){var s=I(i[r]),l=Math.ceil(s/v);n+=l,o++}return{lineCount:n,dayCount:o}}},D=document.querySelector(".timeline-ruler")&&document.querySelector(".timeline-ruler").clientHeight,w=0,x=0,O={},b=0;b<r.length;b++){var T=w,A=x,H=r[b],F=a[H];for(var j in F)if(F.hasOwnProperty(j)){var k=M(H,j);F[j].monthLineCount=k.lineCount,F[j].monthDayCount=k.dayCount,w+=k.lineCount,x+=k.dayCount}O[H]={},O[H].yearLineCount=w-T,O[H].yearDayCount=x-A}for(var R,P,N=w*y+x*L,G=D/N,B=C.pxGap=Math.max(Math.ceil(.01*D),34),E=0,q=!1,U=0,b=0;b<r.length;b++){var H=r[b],_=O[H],Y=(_.yearLineCount*y+_.yearDayCount*L)*G,z=0===b?-18:-10;if(!(0>=_)){"other"===H&&(H="神秘时间");var J={type:"year",pos:E,posForShow:E+z,desc:H,show:!0,height:Y};if(0!==J.height){if(0===b&&J.height<B&&(q=!0),0===b||b===r.length-1?J.show=!0:q&&b>0?E+J.height>B?q=!1:J.show=!1:J.height<B&&(U>=B?(U=0,J.show=!0,R=C.length):(U+=te.height,J.show=!1)),P&&J.height>=B){var V=C[P];J.pos-V.pos<B&&(V.show=!1,P=null)}if(R&&J.height>=B){var W=C[R];J.pos-W.pos<B&&(W.show=!1,R=null)}B>D-(E+Y)&&(J.show=!1),C.push(J);var F=a[H];if(null!=F)for(var K=Object.keys(F).sort(function(t,e){return e-t}),Q=0,X=0,Z=0;Z<K.length;Z++){var j=K[Z],k=F[j],$=(k.monthLineCount*y+k.monthDayCount*L)*G,te={type:"month",pos:E,posForShow:E+z,show:!0,height:$,desc:H+"年"+j+"月",month:0===j.indexOf("0")?j.slice(1):j};J.show?0===Q||te.posForShow-J.posForShow<B?(X+=te.height,te.show=!1):te.height<B?X>=B?(X=0,te.show=!0,P=C.length):(X+=te.height,te.show=!1):te.height>=B&&P&&te.posForShow-C[P].posForShow<B&&(C[P].show=!1,P=null):te.show=!1,E+=$,C.push(te),Q++}}}}if(C.length){var ee=C[C.length-1];ee.height>10&&ee.show?C.push({type:"month",pos:ee.pos,posForShow:ee.pos+ee.height+z,show:!0,height:ee.height,desc:ee.desc,month:null}):(ee.show=!0,ee.month=null)}s.setState(i,"rulerList",C),o("timeline/changeRulerPos"),e&&e.setLog&&n.nextTick(function(){var t=u.timeEnd("listRender-timeline");h.log.send({url:"//update.pan.baidu.com/statistics",op:"first_screen_load_time",type:"ignore",other0:t,other1:"webtimeline"})})}},"timeline/setCountListForShow":function(t,e){var i=t.state,o=t.dispatch;if(null!=e.dayStr){var r=e.dayStr,a=s.getState(i,"packUpInfo")[r],u=s.getState(i,"countList"),h=s.getState(i,"timeLineDataList"),d=s.getState(i,"groupDataList"),g=s.getState(i,"countListForShow");if(a)g[r]={count:0,isTrusted:!0};else{var m=s.getState(i,"grouped");if(m){var f=d[r]||{},p=f.length;g[r]={count:p,isTrusted:!0}}else if(null!=u[r])g[r]={count:u[r].count,isTrusted:u[r].isTrusted};else{var S=h&&h[r]&&h[r].length||0;g[r]={count:S,isTrusted:!0}}}n.nextTick(function(){c.layoutThrottleFunc?c.layoutThrottleFunc():(c.layoutThrottleFunc=l.throttle(function(){o("timeline/setRulerList")},500),c.layoutThrottleFunc())})}}};i.exports={state:d,getters:g,actions:f,mutations:m}});
;define("pan-timeline:widget/store/componentsStore/timeline/classify-list.js",function(t,i,e){var s=t("base:thirdParty/vue/vue.js"),a=t("pan-timeline:widget/api/timeline/getlist.js"),n=t("pan-timeline:widget/components/system/list/listInit/listUtil.js"),o=t("pan-timeline:widget/system/vueExtend/vueExtend.js"),r={additionalList:{}},l={classifyList:{listInfo:{isLoading:!1,page:0,hasMore:!0,type:1},cluster:0,yearCluster:[],yearCur:-1,timeLineDataList:{},timeLineList:{},countList:{},countListForShow:{},timeLineDataInfo:{},packUpInfo:{},groupChooseAll:{},shiftHoverArr:[],rulerList:[]}},f={getCluster:function(t){return o.getState(t,"cluster")},getListInfo:function(t){return o.getState(t,"listInfo")}},c={"classifyList/setStateInit":function(t){t=s.util.extend(t,JSON.parse(JSON.stringify(l)))},"classifyList/setCluster":function(t,i){o.setState(t,"cluster",i.cluster)},"classifyList/setListInfo":function(t,i){var e=o.getState(t,"listInfo");null!=i.hasMore&&(e.hasMore=i.hasMore),null!=i.page&&(e.page=i.page),null!=i.isLoading&&(e.isLoading=i.isLoading),null!=i.type&&(e.type=i.type)}},u={"classifyList/getListData":function(t,i){var e=100,s=t.commit,l=t.state,f=t.dispatch,c=t.rootState,u=c.isNewVersion;s("timeline/setCurType",{curType:"classifyList"});var L=o.getState(l,"listInfo"),d=o.getState(l,"cluster"),g={};L&&!L.isLoading&&(s("classifyList/setListInfo",{isLoading:!0}),u?g={search_type:1,keyword:d}:g.cluster=d,g.isNewApi=u,g.start=L.page*e||0,a.getByClusterType(g).then(function(t){if(0===t.errno){var e=!1,a=L.page+1;if(t.has_more&&(e=!0),s("classifyList/setListInfo",{hasMore:e,page:a,isLoading:!1}),t.list&&t.list.length>0){if(f("classifyList/modifyYearCluster",t),f("classifyList/setCountForFileOp",{additionalList:r.additionalList}),f("classifyList/triggerLayout"),1===a&&t.list[0]&&t.list[0].tags&&t.list[0].tags[0]&&t.list[0].tags[0].tag_type){var o=t.list[0].tags[0].tag_type;s("classifyList/setListInfo",{type:o})}}else i&&"function"==typeof i.emptyCb&&i.emptyCb()}else i&&i.errCb&&"function"==typeof i.errCb?i.errCb(t.errno):n.defaultErrCB(t.errno),s("classifyList/setListInfo",{isLoading:!1})}).catch(function(){i&&i.errCb&&"function"==typeof i.errCb?i.errCb():n.defaultErrCB(),s("classifyList/setListInfo",{isLoading:!1})}))},"classifyList/modifyYearCluster":function(t,i){for(var e=i&&i.list||[],s=e.length,a=(t.commit,t.state),n=t.dispatch,l=(t.rootState,o.getState(a,"yearCluster")),f=(o.getState(a,"packUpInfo"),o.getState(a,"timeLineDataList")),c=o.getState(a,"timeLineList"),u=o.getState(a,"groupChooseAll"),L={},d=0;s>d;d++){var g=e[d].year,p=e[d].month,y=e[d].day;l.push(e[d].year);var m=g+p+y;L[m]=L[m]?L[m]:[],L[m].push(e[d]),c[g]=c[g]||{},c[g][p]=c[g][p]||[],c[g][p].indexOf(m)<0&&c[g][p].push(m)}r.additionalList={};for(var h in L)r.additionalList[h]=L[h];for(var C in r.additionalList)f[C]&&u[C]&&n("timelline/setChoose",{lists:r.additionalList[C],date:C}),n("timeline/setTimeLineDataList",{timelineData:r.additionalList[C],startNum:f[C]?f[C].length:0})},"classifyList/triggerLayout":function(t,i){var e=t.state,s=t.dispatch,a=t.commit,n=t.rootState,r=o.getState(e,"listInfo"),l=o.getState(e,"timeLineDataList");s("timeline/triggerLayout",{data:l,resize:i&&i.resize||!0,dataInfo:r,afterLayoutFunc:function(){a("setListStatus",{listStatus:2===n.list.listStatus?2:1})}})},"classifyList/setCountForFileOp":function(t,i){if(i){var e=(t.state,t.commit),s=i.additionalList;for(var a in s){var n={time:a,isTrusted:!0,count:s[a].length};i.op&&"delete"===i.op&&(n.op=i.op),e("timeline/setCountList",n)}}},"classifyList/cancelAllChoose":function(t,i){var e=(t.state,t.dispatch);e("timeline/cancelAllChoose",i)},"classifyList/updateBackedDatadata":function(t,i){var e=(t.state,t.dispatch);e("timeline/updateBackedDatadata",i)}};e.exports={state:l,getters:f,actions:u,mutations:c}});
;define("pan-timeline:widget/store/componentsStore/timeline/group-list.js",function(t,e,i){var r=(t("base:thirdParty/vue/vue.js"),t("pan-timeline:widget/system/vueExtend/vueExtend.js")),a={group:{groupDataList:{},coverIndexArr:{},gidMap:{},gidArr:{},cluster:0,yearCluster:[],yearCur:-1,timeLineDataList:{},timeLineList:{},countList:{},countListForShow:{},timeLineDataInfo:{},rulerList:[],clickPos:null,packUpInfo:{},groupChooseAll:{},shiftHoverArr:[],hasRendered:!1,renderHeightObj:{},yearMonthHeightObj:{}}},n={getGroupStatus:function(t){return t.grouped},getGidMap:function(t){return r.getState(t,"gidMap")}},o={},u={"timeline/operateGroupCover":function(t,e){var i=t.commit,a=t.state,n=t.dispatch;if(null!=e.dayStr&&null!=e.gid){var o=e.dayStr,u=(r.getState(a,"timeLineDataInfo")[o]||{},r.getState(a,"timeLineDataList")),s=(r.getState(a,"gidMap"),r.getState(a,"grouped"));i("timeline/setGroupStatus",{dayStr:o,gid:e.gid}),n("timeline/setTimeLineDataList",{timelineData:u[o],grouped:s,op:"change"}),n("timeline/setCountListForShow",{dayStr:o}),n("timeline/triggerLayout",{dayStr:o,resize:!0}),e.triggerLayoutCb&&e.triggerLayoutCb()}},"timeline/setGrouped":function(t,e){var i=t.state,a=t.commit,n=t.dispatch;null!=e.grouped&&(r.setState(i,"grouped",e.grouped),e.grouped?a("timeline/setCurType",{curType:"group"}):a("timeline/setCurType",{curType:"timeline"}),a("setListStatus",{listStatus:0}),n("timeline/getListData"))}};i.exports={state:a,getters:n,actions:u,mutations:o}});
;define("pan-timeline:widget/store/componentsStore/timeline/face-list.js",function(t,e,i){var a=t("base:thirdParty/vue/vue.js"),s=t("pan-timeline:widget/api/timeline/getlist.js"),n=t("pan-timeline:widget/components/system/list/listInit/listUtil.js"),o=t("pan-timeline:widget/system/vueExtend/vueExtend.js"),r={additionalList:{}},l={faceList:{listInfo:{isLoading:!1,page:0,hasMore:!0},tagId:0,yearCluster:[],yearCur:-1,timeLineDataList:{},timeLineList:{},countList:{},countListForShow:{},timeLineDataInfo:{},packUpInfo:{},groupChooseAll:{},shiftHoverArr:[],rulerList:[]}},f={getCluster:function(t){return o.getState(t,"cluster")},getListInfo:function(t){return o.getState(t,"listInfo")}},c={"faceList/setStateInit":function(t){t=a.util.extend(t,JSON.parse(JSON.stringify(l)))},"faceList/setTagid":function(t,e){o.setState(t,"tagId",e.tagId)},"faceList/setListInfo":function(t,e){var i=o.getState(t,"listInfo");null!=e.hasMore&&(i.hasMore=e.hasMore),null!=e.page&&(i.page=e.page),null!=e.isLoading&&(i.isLoading=e.isLoading)}},L={"faceList/getListData":function(t,e){{var i=100,a=t.commit,l=t.state,f=t.dispatch;t.rootState}a("timeline/setCurType",{curType:"faceList"});var c=o.getState(l,"listInfo"),L=o.getState(l,"tagId");c&&!c.isLoading&&(a("faceList/setListInfo",{isLoading:!0}),s.faceSearch({keyword:L,start:c.page*i||0}).then(function(t){if(0===t.errno){var i=!1,s=c.page+1;t.has_more&&(i=!0),a("faceList/setListInfo",{hasMore:i,page:s,isLoading:!1}),t.list&&t.list.length>0?(f("faceList/modifyYearCluster",t),f("faceList/setCountForFileOp",{additionalList:r.additionalList}),f("faceList/triggerLayout")):i&&t.list&&0===t.list.length?f("faceList/getListData",e):e&&"function"==typeof e.emptyCb&&e.emptyCb()}else e&&e.errCb&&"function"==typeof e.errCb?e.errCb(t.errno):n.defaultErrCB(t.errno),a("faceList/setListInfo",{isLoading:!1})}).catch(function(){e&&"function"==typeof e.errCb?e.errCb():n.defaultErrCB(),a("faceList/setListInfo",{isLoading:!1})}))},"faceList/modifyYearCluster":function(t,e){for(var i=e.list,a=i.length,s=(t.commit,t.state),n=t.dispatch,l=(t.rootState,o.getState(s,"yearCluster")),f=(o.getState(s,"packUpInfo"),o.getState(s,"timeLineDataList")),c=o.getState(s,"timeLineList"),L=o.getState(s,"groupChooseAll"),d={},u=0;a>u;u++){var g=i[u].year,p=i[u].month,m=i[u].day;l.push(i[u].year);var h=g+p+m;d[h]=d[h]?d[h]:[],d[h].push(i[u]),c[g]=c[g]||{},c[g][p]=c[g][p]||[],c[g][p].indexOf(h)<0&&c[g][p].push(h)}r.additionalList={};for(var S in d)r.additionalList[S]=d[S];for(var y in r.additionalList)f[y]&&L[y]&&n("timelline/setChoose",{lists:r.additionalList[y],date:y}),n("timeline/setTimeLineDataList",{timelineData:r.additionalList[y],startNum:f[y]?f[y].length:0})},"faceList/triggerLayout":function(t,e){var i=t.state,a=t.dispatch,s=t.commit,n=t.rootState,r=o.getState(i,"listInfo"),l=o.getState(i,"timeLineDataList");a("timeline/triggerLayout",{data:l,resize:e&&e.resize||!0,dataInfo:r,afterLayoutFunc:function(){s("setListStatus",{listStatus:2===n.list.listStatus?2:1})}})},"faceList/setCountForFileOp":function(t,e){var i=(t.state,t.commit),a=e.additionalList;for(var s in a){var n={time:s,isTrusted:!0,count:a[s].length};e.op&&"delete"===e.op&&(n.op=e.op),i("timeline/setCountList",n)}},"faceList/cancelAllChoose":function(t,e){var i=(t.state,t.dispatch);i("timeline/cancelAllChoose",e)},"faceList/updateBackedDatadata":function(t,e){var i=(t.state,t.dispatch);i("timeline/updateBackedDatadata",e)}};i.exports={state:l,getters:f,actions:L,mutations:c}});
;define("pan-timeline:widget/store/componentsStore/recentUpload/recentUpload-list.js",function(e,t,s){"use strict";var o=e("base:thirdParty/vue/vue.js"),a=e("pan-timeline:widget/system/fileService/fileOperate/fileOperate.js"),i=e("pan-timeline:widget/api/timeline/getlist.js"),l=e("pan-timeline:widget/components/system/list/listInit/listUtil.js"),n=e("pan-timeline:widget/system/vueExtend/vueExtend.js"),r=e("system-core:context/context.js").instanceForSystem,c=e("pan-timeline:widget/system/util/util.js"),d={fixListData:function(e,t,s){for(var i=e.length,l=0;i>l;l++)e[l].index=s+l,e[l].moreInfo=a.getInfo(e[l].path,e[l].isdir,!0),o.set(e[l],"choose",t);return e}},h={curType:"recentUpload",recentUpload:{listInfo:{isLoading:!1,page:1,hasMore:!0}}},p={},m={"recentUpload/setStateInit":function(e){e=o.util.extend(e,JSON.parse(JSON.stringify(h)))},"recentUpload/setCurType":function(e,t){null!=t.curType&&(e.curType=t.curType)},"recentUpload/setListInfo":function(e,t){var s=n.getState(e,"listInfo")||{};null!=t.hasMore&&(s.hasMore=t.hasMore),null!=t.page&&(s.page=t.page),null!=t.isLoading&&(s.isLoading=t.isLoading)},"recentUpload/setLoadingData":function(e,t){e.loadingData=t.loadingData}},f={"recentUpload/getListData":function(e,t){var s=100,a=e.commit,h=e.state,p=e.dispatch,m=e.rootState,f=m.list.lists,g=m.list.allChoose,u=n.getState(h,"listInfo")||{},I=function(e){if(e)if(0===e.errno)if(e.info&&e.info.length>0){var s=!1,i=u.page+1;e.info.length>=100&&(s=!0),a("recentUpload/setListInfo",{hasMore:s,page:i,isLoading:!1});var n=d.fixListData(e.info,g,f.length);g&&p("recentUpload/setMoreDataChoose",{list:n});var h=f.concat(n);a("setListsData",{lists:h});var I="已加载"+h.length+"个";s||(I="已全部加载，共"+h.length+"个"),a("setListHeaderOpDesc",{listHeaderOpDesc:I}),p("triggerLayout",{data:h,params:{recycleListConf:m.list.recycleListConf,resize:!0}}),2>=i&&o.nextTick(function(){var e=c.timeEnd("listRender-recentupload");r.log.send({url:"//update.pan.baidu.com/statistics",op:"first_screen_load_time",type:"ignore",other0:e,other1:"webtimeline_recentupload"})})}else t.emptyCb();else a("recentUpload/setListInfo",{isLoading:!1}),l.defaultErrCB(e.errno);else l.defaultErrCB()};u.hasMore&&!u.isLoading&&(a("recentUpload/setListInfo",{isLoading:!0}),a("setListHeaderOpDesc",{listHeaderOpDesc:"获取更多数据···"}),i.getRecentUpload({num:s,page:u.page}).then(function(e){I.call(this,e)}).catch(function(){l.defaultErrCB()}))},"recentUpload/toggleAllChoose":function(e){var t=e.commit,s=(e.state,e.rootState),a=s.list.choosedItemArr,i=s.list.chooesedItemMap;t("setAllChoose",{allChoose:!s.list.allChoose});var l=s.list.allChoose,n=s.list.lists,r=n.length;if(l)for(var c=0;r>c;c++){var d=n[c];d.choose||(o.set(d,"choose",l),a.push(d),i[c]=a.length-1)}else{for(var c=0;r>c;c++)o.set(n[c],"choose",!1);i={},a.splice(0,a.length)}t("setListsData",{lists:n}),t("setChooesedItemMap",{chooesedItemMap:i}),t("setChoosedItemArr",{choosedItemArr:a})},"recentUpload/setChoosedItem":function(e,t){{var s=e.commit,a=(e.state,e.rootState),i=t.index,l=a.list.lists,n=a.list.choosedItemArr,r=a.list.chooesedItemMap;a.list.listStatus}if(l[i].choose){o.set(l[i],"choose",!1);var c=r[i],d=n.indexOf(l[i]);n.splice(c,1),delete r[i];for(var h in r)r[h]>d&&(r[h]=r[h]-1)}else o.set(l[i],"choose",!0),n.push(l[i]),r[i]=n.length-1;var p=!1;n.length===l.length&&(p=!0),s("setChooesedItemMap",{chooesedItemMap:r}),s("setChoosedItemArr",{choosedItemArr:n}),s("setAllChoose",{allChoose:p})},"recentUpload/setSomeChoose":function(e,t){if(null!=t.start&&null!=t.end){for(var s=e.commit,a=(e.state,e.rootState),i=a.list.lists,l=a.list.choosedItemArr,n=a.list.chooesedItemMap,r=(a.list.listStatus,Math.min(t.start,t.end)),c=Math.max(t.start,t.end),d=r;c>=d;d++)i[d].choose||(o.set(i[d],"choose",!0),l.push(i[d]),n[d]=l.length-1);s("setChooesedItemMap",{chooesedItemMap:n}),s("setChoosedItemArr",{choosedItemArr:l})}},"recentUpload/updateBackedDatadata":function(e,t){var s=e.commit,a=e.dispatch,i=(e.state,e.rootState),l=i.list.choosedItemArr,n=i.list.chooesedItemMap,r=l.length,c=i.list.lists,d=(c.length,t.dayData);if(d){for(var h=d.length,p=0;h>p;p++){var m=d[p];o.util.remove(c,m),l.indexOf(m)>-1&&o.util.remove(l,m)}a("recentUpload/setIndex",{emptyCb:t.emptyCb});var f=l.length;n={};for(var g=0;f>g;g++)n[l[g].index]=g}else{for(var u=0;r>u;u++){var I=l[u];o.util.remove(c,I)}n={},l.splice(0,l.length),a("recentUpload/setIndex",{emptyCb:t.emptyCb})}s("setChooesedItemMap",{chooesedItemMap:n}),s("setChoosedItemArr",{choosedItemArr:l}),a("triggerLayout",{data:c,params:{recycleListConf:i.list.recycleListConf,resize:!0}})},"recentUpload/setIndex":function(e,t){for(var s=e.state,o=e.rootState,a=e.commit,i=o.list.lists,l=n.getState(s,"listInfo")||{},r=i.length,c=0;r>c;c++){var d=i[c];d.index=c}a("setListsData",{lists:i,listInfo:l,emptyCb:t.emptyCb})},"recentUpload/cancelAllChoose":function(e){var t=e.commit,s=(e.state,e.rootState),a=s.list.choosedItemArr,i=s.list.chooesedItemMap;t("setAllChoose",{allChoose:!1});for(var l=(s.list.allChoose,s.list.lists),n=l.length,r=0;n>r;r++)l[r].choose&&o.set(l[r],"choose",!1);i={},a.splice(0,a.length),t("setListsData",{lists:l}),t("setChooesedItemMap",{chooesedItemMap:i}),t("setChoosedItemArr",{choosedItemArr:a})},"recentUpload/setMoreDataChoose":function(e,t){for(var s=e.commit,o=(e.state,e.rootState),a=o.list.lists,i=a.length,l=o.list.choosedItemArr,n=o.list.chooesedItemMap,r=t.list,c=r.length,d=0;c>d;d++)l.push(r[d]),n[d+i]=l.length-1;s("setChooesedItemMap",{chooesedItemMap:n}),s("setChoosedItemArr",{choosedItemArr:l})}};s.exports={actions:f,mutations:m,state:h,getters:p}});
;define("pan-timeline:widget/store/componentsStore/recentUpload/search-list.js",function(e,t,s){var a=e("base:thirdParty/vue/vue.js"),i=e("pan-timeline:widget/api/timeline/getlist.js"),o=e("pan-timeline:widget/components/system/list/listInit/listUtil.js"),r=e("pan-timeline:widget/system/fileService/fileOperate/fileOperate.js"),n=e("pan-timeline:widget/system/vueExtend/vueExtend.js"),c=e("system-core:context/context.js").instanceForSystem,l={fixListData:function(e,t,s){for(var i=e.length,o=0;i>o;o++)e[o].index=s+o,e[o].moreInfo=r.getInfo(e[o].path,e[o].isdir,!0),a.set(e[o],"choose",t);return e}},h={searchList:{searchType:2,keyword:"",listInfo:{isLoading:!1,start:0,hasMore:!0}}},d={"searchList/setStateInit":function(e){e=a.util.extend(e,JSON.parse(JSON.stringify(h)))},"searchList/setCurType":function(e,t){null!=t.curType&&(e.curType=t.curType)},"searchList/setSearchParam":function(e,t){null!=t.searchType&&null!=t.keyword&&(n.setState(e,"searchType",t.searchType),n.setState(e,"keyword",t.keyword))},"searchList/setListInfo":function(e,t){var s=n.getState(e,"listInfo")||{};null!=t.hasMore&&(t.hasMore&&null!=t.start&&a.set(s,"start",t.start+(t.len||100)),a.set(s,"hasMore",t.hasMore)),null!=t.isLoading&&a.set(s,"isLoading",t.isLoading)}},p={"searchList/getListData":function(e,t){var s=e.commit,a=e.state,r=e.dispatch,h=e.rootState,d=h.list.lists,p=h.list.allChoose,f=n.getState(a,"listInfo")||{},u=f.start||0,L=n.getState(a,"searchType"),g=n.getState(a,"keyword");if(null==g||0===g.length)return void(t&&"function"==typeof t.emptyCb&&t.emptyCb());var y=function(e){if(e)if(0===e.errno){if(e.list&&e.list.length>0){var a=l.fixListData(e.list,p,d.length);p&&r("recentUpload/setMoreDataChoose",{list:a});var i=d.concat(a);s("setListsData",{lists:i});var n="已加载"+i.length+"个";e.has_more||(n="已全部加载，共"+i.length+"个"),s("setListHeaderOpDesc",{listHeaderOpDesc:n}),r("triggerLayout",{data:i,params:{recycleListConf:h.list.recycleListConf,resize:!0}}),"function"==typeof t.successCb&&t.successCb(),c.log.send({type:"web_album_search_has_result"})}else{if(e.list&&0===e.list.length&&e.has_more)return s("searchList/setListInfo",{hasMore:e.has_more,start:u,isLoading:!1}),void r("searchList/getListData",t);"function"==typeof t.emptyCb&&t.emptyCb()}s("searchList/setListInfo",{hasMore:e.has_more,start:u,isLoading:!1})}else s("recentUpload/setListInfo",{isLoading:!1}),o.defaultErrCB(e.errno);else o.defaultErrCB()};f.hasMore&&!f.isLoading&&(s("recentUpload/setListInfo",{isLoading:!0}),s("setListHeaderOpDesc",{listHeaderOpDesc:"获取更多数据···"}),i.doSearch({start:f.start,search_type:L,keyword:g}).then(function(e){y.call(this,e)}).catch(function(){o.defaultErrCB()}))},"searchList/toggleAllChoose":function(e,t){var s=e.dispatch;s("recentUpload/toggleAllChoose",t)},"searchList/setChoosedItem":function(e,t){var s=e.dispatch;s("recentUpload/setChoosedItem",t)},"searchList/setSomeChoose":function(e,t){var s=e.dispatch;s("recentUpload/setSomeChoose",t)},"searchList/updateBackedDatadata":function(e,t){var s=e.dispatch;s("recentUpload/updateBackedDatadata",t)},"searchList/setIndex":function(e,t){var s=e.dispatch;s("recentUpload/setIndex",t)},"searchList/cancelAllChoose":function(e,t){var s=e.dispatch;s("recentUpload/cancelAllChoose",t)},"searchList/setMoreDataChoose":function(e,t){var s=e.dispatch;s("recentUpload/setMoreDataChoose",t)}};s.exports={state:h,mutations:d,actions:p}});
;define("pan-timeline:widget/pageModule/timeline/timeline.js",function(e){"use strict";var t=e("base:thirdParty/vue/vue.js"),i=e("base:thirdParty/vue/vuex.js"),n=e("pan-timeline:widget/store/index.js"),s=e("base:thirdParty/vue/vue-router.js"),o=e("pan-timeline:widget/system/vueExtend/vueExtend.js"),a=e("pan-timeline:widget/store/componentsStore/timeline/timeline-list.js"),r=e("pan-timeline:widget/store/componentsStore/timeline/classify-list.js"),c=e("pan-timeline:widget/store/componentsStore/timeline/group-list.js"),l=e("pan-timeline:widget/store/componentsStore/timeline/face-list.js"),m=[a,r,c,l],p=o.extendStore(m);n.registerModule("timeline",p);var d=e("pan-timeline:widget/store/componentsStore/recentUpload/recentUpload-list.js"),u=e("pan-timeline:widget/store/componentsStore/recentUpload/search-list.js"),g=[d,u],w=o.extendStore(g);n.registerModule("recentUpload",w);var f=e("pan-timeline:widget/store/modules/classify/index.js");n.registerModule("classify",f);var h=e("pan-timeline:widget/components/timeline/timeline.js"),v=e("pan-timeline:widget/components/recentUpload/recentUpload.js"),y=e("pan-timeline:widget/components/searchList/searchList.js"),j=e("pan-timeline:widget/components/faceList/faceList.js"),L=e("pan-timeline:widget/components/classify/classify.js"),S=e("pan-timeline:widget/components/classifyList/classifyList.js"),T=e("pan-timeline:widget/components/system/Tip/Tip.js"),x=e("pan-timeline:widget/components/tipLine/tipLine.js"),A=e("pan-timeline:widget/components/guideAuto/util/guideDialog/guideDialog.js"),V=e("pan-timeline:widget/directives/index.js"),U=e("pan-timeline:widget/filters/index.js"),k=e("pan-timeline:widget/api/timeline/getlist.js"),R=e("pan-timeline:widget/system/util/timeLog.js"),$=e("pan-timeline:widget/system/util/util.js");e("pan-timeline:widget/components/guideAuto/guideAuto.js");var b=null,D=i.mapActions,F=i.mapGetters,M=window.yunData,C=[{path:"/timeline",name:"timeline",component:h},{path:"/recentupload",name:"recentUpload",component:v},{path:"/",redirect:"/timeline"},{path:"",redirect:"/timeline"},{path:"/classify",name:"classify",component:L,meta:{keepAlive:!0}},{path:"/classify/faceAll",name:"connectionList",component:L,meta:{keepAlive:!0}},{path:"/classify/positionAll",name:"positionList",component:L,meta:{keepAlive:!0}},{path:"/classifyList/:classifyType/:clusterType",name:"classifyList",component:S},{path:"/search/:vmode/:searchType/:keyword",name:"searchList",component:y},{path:"/faceList/:tagId",name:"faceList",component:j}],I={router:null,isNewVersion:!1,privateSwitch:1,init:function(){I.checkUserAndInitVue(),b=new R({op:"webtimeline",type:"timelineRemainTimeTotal"}),b.begin()},checkUserAndInitVue:function(){var e=(+new Date,I.isNewVersion),t=I.privateSwitch,i=("api_version_"+M.MYUK,function(e,t){I.isNewVersion=e,I.privateSwitch=t,I.initRootVue()}),n=function(){k.getApiVersion().then(function(n){if(e=!1,0===n.errno){null!=n.newversion&&(e=n.newversion);var s=n.advancedfuncstatus;(0===+s||1===+s)&&(t=+s)}i(e,t)}).catch(function(){i(!1,1)})};n()},initVueRouter:function(){t.use(s),I.router=new s({routes:C})},registerStore:function(){},initDirective:function(){for(var e=["dynamic-class","transclude"],i=0;i<e.length;i++)t.directive(e[i],V[e[i]])},initFilter:function(){for(var e=["imageFormat312","imageFormat344","positionFix344","positionFix312","formatTime","imageSrcFormat"],i=0;i<e.length;i++)t.filter(e[i],U[e[i]])},initRootVue:function(){I.initVueRouter(),I.registerStore(),I.initFilter(),I.initDirective(),$.time("listRender-timeline");new t({el:"#module-picture",router:I.router,store:n,methods:t.util.extend({areaClick:function(){this.$store.commit("setContextMenu",{show:!1})}},D({panTipClick:"panTipClick"})),components:{"pan-tip":T,"tip-line":x,"pan-guide":A},computed:t.util.extend({},F({tip:"getTip",dialog:"getDialog",guide:"getGuide",containerHeight:"getContainerHeight",routeType:"getRouteType",tipLine:"getTipLineObj"})),watch:{$route:function(){var e=this.$route,t=e.name;this.$store.commit("setStateInit"),"classify"!==t&&"connectionList"!==t&&"positionList"!==t&&this.$store.commit(t+"/setStateInit"),this.$store.commit("setRouteType",{routeType:t})}},created:function(){this.$store.commit("setApiVersion",{isNewVersion:I.isNewVersion}),this.$store.commit("setPrivateSwitch",{privateSwitch:I.privateSwitch})}})}};I.init(),t.config.devtools=!0,t.config.debug=!0});
;define("pan-timeline:widget/system/uiRender/header/header.js",function(e){var n=e("base:widget/libs/jquerypacket.js"),t=e("system-core:context/context.js"),d=t.instanceForSystem;n.loadScript("https://pannss.bdstatic.com/m-static/disk-header/disk.header.js",function(){t.prototype.addIconFont=window.yunHeader.fontIe.api.addIconFont,d.message.listen("addIcon",function(e){d.addIconFont&&window.yunHeader.emit("addicon",e)})})});
;define("pan-timeline:widget/system/uiService/fileTree/fileTree.js",function(e,t,i){var n=e("base:widget/libs/jquerypacket.js"),r=e("system-core:context/context.js").instanceForSystem,a=r.ui.cacheManage,s=function(){this._mHandleListener=disk.obtainId(),this._vHost=null,this._vTreeViewCache={},this.selectedCallback=null,this._vInit=!1,this._vUlContent="",this._vInnerHtml="",this._vSelectPath="/",this._vSelectDom="",this._vError=!0,this.vInitPath="/",this.historyConfig={maxLength:40,overlength:!1,minAveragelength:5,averageLength:5},this.folderCache=new a("tree",this.folderCacheConfig)};s.ROOT=0,s.NORMAL=1,s.PARTICULAR_DIR_MAP={"/":"/全部文件","/apps":"/我的应用数据","/百度云收藏":"/百度云收藏","/来自PC的备份文件":"/来自PC的备份文件","/我的分享":"/我的分享","/我的作品":"/我的作品"},s.prototype.getParentPath=function(e){var t=e.slice(0,e.lastIndexOf("/"));return t=t.length?t:t="/"},s.prototype.folderCacheConfig={api:"/api/list",params:{folder:1,order:"name",desc:0,showempty:0,web:1},limit:500,currentPage:0,listKey:"list",getParamsBykey:function(e){return{dir:e}},getPageParams:function(e,t){return{page:e,num:t}},getKeyByParams:function(e){return e.dir},failCallBack:function(e,t,i){i=i.params,i.fileTreeView._errorToast(e),i.host.parent().find(".minus").removeClass("treeview-leaf-loading")}},s.prototype.parseNameFromPath=function(e){return e.substring(e.lastIndexOf("/")+1,e.length)},s.prototype.changePath=function(e){return this.parseNameFromPath(s.PARTICULAR_DIR_MAP[e]?s.PARTICULAR_DIR_MAP[e]:e)},s.prototype.build=function(e){var t=(new Date).getTime();this._vHost=e&&e.host,this.selectedCallback=e&&e.selectedCallback,e&&e.path&&(this.vInitPath=e.path),this._vInit?this._vError&&(this._vHost.innerHTML="",this._init()):this._init();var i=(new Date).getTime()-t;r.log.send({name:"fileTreeRender",value:i})},s.prototype._init=function(){var e=this,t=document.createElement("ul"),i=0;return"/"!==e.vInitPath?(i=1,e.showFileHistory(e.vInitPath)):n(".filetree-history").length&&n(".filetree-history").remove(),t.className="treeview treeview-content "+this._mHandleListener,this._vHost.appendChild(t),t.innerHTML=this._tpl({nodeRoot:!0,minus:!0,pdleft:i,nodeOn:!0,path:e.vInitPath}),this._vInit=!0,this._buildTreeView({dir:e.vInitPath,pl:15}),{pane:t}},s.prototype.getSelectPath=function(){return this._getPath(n(".treeview-node-on"))},s.prototype.showFileHistory=function(e){var t=this,i=t.historyConfig,r=new Array;if(r=e.split("/"),"/"===e)return void(n(".filetree-history").length&&n(".filetree-history").remove());if(e.length>i.maxLength){t.historyConfig.overlength=!0;var a=parseInt(i.maxLength/r.length);t.historyConfig.averageLength=a>i.minAveragelength+3?a:5}else t.historyConfig.overlength=!1;t.buildHistory(r),t.handleEvent()},s.prototype.buildHistory=function(e){var t=this,i=t.historyConfig,r="",a="",s="";i.maxDeep=parseInt(i.maxLength/(i.minAveragelength+3)),s=i.averageLength===i.minAveragelength&&e.length>i.maxDeep+1?'<span class="filetree-history-item" node-type="filetree-history-item" path="/">全部文件</span><span class="filetree-separator-gt">></span><span class="dot">...</span>':'<span class="filetree-history-item" node-type="filetree-history-item" path="/">全部文件</span>';for(var o=1;o<e.length;o++)r=r+"/"+e[o],a=t.historyConfig.overlength&&e[o].length>i.maxDeep+1?e[o].substring(0,t.historyConfig.averageLength)+"...":e[o],i.averageLength===i.minAveragelength&&e.length>i.maxDeep+1?o>e.length-(i.maxDeep+1)&&(s=s+'<span class="filetree-separator-gt">></span><span class="filetree-history-item" node-type="filetree-history-item" path="'+r+'">'+a+"</span>"):s=s+'<span class="filetree-separator-gt">></span><span class="filetree-history-item" node-type="filetree-history-item" path="'+r+'">'+a+"</span>";n(".filetree-history").length?n(".filetree-history").html(s):n(t._vHost).before('<div class="filetree-history">'+s+"</div>")},s.prototype._buildTreeView=function(e){var t=this,i="",r=e.dir||"/",a=e.host||n(".treeview-root-content"),s=e.pl;a.parent().find(".minus").addClass("treeview-leaf-loading"),this.folderCache.updateKey(r),this.folderCache.getCacheData(-1,function(e){t._vError=!0,t._vTreeViewCache=e;for(var n=0;n<t._vTreeViewCache.length;n++)i+=t._tpl({dirEmpty:t._vTreeViewCache[n].dir_empty,pdleft:s,path:t._vTreeViewCache[n].path});a.html(i).attr("_pl",s),t.handleEvent(),a.parent().find(".minus").removeClass("treeview-leaf-loading")},{host:a,fileTreeView:t})},s.prototype._tpl=function(e){var t="",i=e.pdleft,n=e.path,r=e.dirEmpty?"treenode-empty":"",a=e.nodeOn?"treeview-node-on":"",s=e.nodeRoot?"treeview-root":"",o=e.nodeRoot?"treeview-root-content":"",l=e.minus?"minus":"",h=e.minus?"_minus":"",p=e.minus?"":"treeview-collapse",d=["<li>",'<div class="treeview-node %dirEmpty% %node-on% %node-root% %_minus%" _pl="%pl%" style="padding-left:%pl%">','<span class="treeview-node-handler">','<em class="b-in-blk plus icon-operate %minus%" ></em>','<dfn class="b-in-blk treeview-ic"></dfn>','<span class="treeview-txt" node-path="%nodePath%">%fileName%</span>',"</span>","</div>",'<ul class="treeview %node-root-cont% treeview-content %collapse%" _pl="%pl2%"></ul>',"</li>"];return t=d.join("").replace(/%fileName%/g,this.changePath(n)).replace(/%nodePath%/g,n).replace(/%node-on%/g,a).replace(/%collapse%/g,p).replace(/%pl%/g,i+"px").replace(/%pl2%/g,i+15+"px").replace(/%node-root%/g,s).replace(/%minus%/g,l).replace(/%_minus%/g,h).replace(/%node-root-cont%/g,o).replace(/%dirEmpty%/g,r)},s.prototype.handleEvent=function(){var e=this;n(".treeview-node").off().on({mouseenter:function(){n(this).addClass("treeview-node-hover")},mouseleave:function(){n(this).removeClass("treeview-node-hover")},click:function(){var t=n(this).hasClass("_minus"),i=n(this).hasClass("treeview-node-on"),r=n(this).hasClass("treenode-empty"),a=n(this).attr("_pl"),s=(n(this).hasClass("waitHandle"),e._getPath(n(this))),o=n(this).next("ul");i||(n(".treeview-node-on").removeClass("treeview-node-on"),n(this).addClass("treeview-node-on")),i&&t||r?(n(this).removeClass("_minus").find(".plus").removeClass("minus"),o.addClass("treeview-collapse")):(n(this).addClass("_minus").find(".plus").addClass("minus"),o.removeClass("treeview-collapse")),"function"==typeof e.selectedCallback&&e.selectedCallback.call(e.selectedCallback),0!==n(this).next("ul").children().length||r||e._buildTreeView({dir:s,host:o,pl:parseInt(a)+15}),"/"!==e.vInitPath&&e.showFileHistory(s)}}),n(".filetree-history-item").off().on({click:function(){var t=n(this).attr("path");"function"==typeof e.selectedCallback&&e.selectedCallback.call(e.selectedCallback),e.build({host:e._vHost,path:t||"/"}),e.showFileHistory(t)}})},s.prototype._getPath=function(e){var t=this,i=e,n=parseInt(i.attr("_pl"))/15-1,r=[];return-1==n?r="/":void 0!=i.find(".treeview-txt").attr("node-path")?r=i.find(".treeview-txt").attr("node-path"):void 0==i.find(".treeview-txt").attr("node-path")?(i=i.parent().parent(),r=i.prev().find(".treeview-txt").attr("node-path")):r="/",t._vSelectPath=r,t._vSelectPath},s.prototype._errorToast=function(e){var t=r.errorMsg(e.errno)||"列表加载失败，请稍后重试&hellip;";this._vError=!1;r.ui.tip({mode:"failure",msg:t});return!1},s.obtain=new s,i.exports=s.obtain});
;define("pan-timeline:widget/system/uiService/fileTree/createFolder.js",function(e,t,n){function s(){this.myConfirmById=window.disk.obtainId(),this.myCancleById=window.disk.obtainId(),this.myInputById=window.disk.obtainId(),this.myInsertDom="",this.myEmpty=!1}var i=e("base:widget/libs/jquerypacket.js"),r=e("system-core:context/context.js").instanceForSystem,a=e("pan-timeline:widget/system/fileService/fileManagerApi/fileManagerApi.js"),o=e("pan-timeline:widget/system/uiService/fileTree/fileTree.js");s.ILLEGAL_CHARS=/[\\\/:*?'<>|]/gi,s.obtain="",s.prototype={reBuild:function(e){if(!e||!e.insertDom)throw Error("you need to specify 'insertDom'");if(this.myInsertDom=e.insertDom,!e||!e.container)throw new Error("you need to specify 'container'");this._mContainer=e.container,this._createDom()},_restNewFolder:function(){var e=this,t=i("."+e.myInputById).val(),n=e.path+"/"+t;i("#plus-CreateFolder").find(".sprite-ic2").addClass("treeview-leaf-loading"),a.createNewDir(n,function(n,s,a){return 0!==n?(r.ui.tip({mode:"caution",msg:s}),!1):(t=a.name||a.path,t=t.substring(t.lastIndexOf("/")+1),i("#plus-CreateFolder").remove(),i(".treeview-node-on").removeClass("treeview-node-on"),e.myInsertDom.append(e._listTpl(a.path)),o.handleEvent(),void 0)},t)},_createDom:function(){var e=this;document.getElementById("plus-CreateFolder")&&i("#plus-CreateFolder").remove(),e.myInsertDom.prev().hasClass("treenode-empty")?(e.myInsertDom.append(e._folderTpl()).removeClass("treeview-collapse").prev().removeClass("treenode-empty").addClass("_minus").find("em").addClass("minus"),e.myEmpty=!0):(e.myInsertDom.prev().addClass("_minus").find(".plus").addClass("minus"),e.myInsertDom.removeClass("treeview-collapse"),e.myInsertDom.append(e._folderTpl()),e.myEmpty=!1),e._setOffset(),e._handleInit(),e.path=o.getSelectPath(),o.handleEvent()},_setOffset:function(){var e=i("#plus-CreateFolder").position().top;e=this._mContainer.scrollTop()+e-211,this._mContainer.scrollTop(e)},_cancleDom:function(){var e=this,t=i("#plus-CreateFolder");e.myEmpty?(t.parent().prev().addClass("treeview-node-on"),t.remove(),e.myInsertDom.addClass("treeview-collapse").prev().addClass("treenode-empty").removeClass("_minus").find("em").removeClass("minus")):(t.parent().prev().addClass("treeview-node-on"),t.remove())},_folderTpl:function(){var e=parseInt(this.myInsertDom.attr("_pl"));return'<li id="plus-CreateFolder"><div class="treeview-node treenode-empty" _pl="'+e+'" style="padding-left:'+e+'px"><span class="treeview-node-handler"><em class="b-in-blk plus sprite-ic2 "></em><dfn class="b-in-blk treeview-ic"></dfn><span class="plus-create-folder"><input class="input '+this.myInputById+'" type="text" value="新建文件夹"><span class="sure '+this.myConfirmById+'"></span><span class="cancel '+this.myCancleById+'"></span></span></span></div><ul class="treeview treeview-content treeview-collapse"  _pl="'+(e+15)+'"></ul></li>'},_listTpl:function(e){var t=parseInt(this.myInsertDom.attr("_pl"));return'<li><div class="treeview-node treenode-empty treeview-node-on" _pl="'+t+'" style="padding-left:'+t+'px"><span class="treeview-node-handler"><em class="b-in-blk plus sprite-ic2 "></em><dfn class="b-in-blk treeview-ic"></dfn><span class="treeview-txt" node-path="'+e+'">'+r.tools.baseService.toEntity(e.substring(e.lastIndexOf("/")+1))+'</span></span></div><ul class="treeview treeview-content treeview-collapse" _pl="'+(t+15)+'"></ul></li>'},_handleInit:function(){var e=this;i("."+e.myInputById).select().focus().on({blur:function(){},keyup:function(t){13==t.keyCode&&e._restNewFolder()}}),i("."+e.myConfirmById).click(function(){e._restNewFolder()}),i("."+e.myCancleById).click(function(){e._cancleDom()})}},s.obtain=s.obtain||new s,n.exports=s.obtain});
;define("pan-timeline:widget/system/uiService/fileTreeDialog/fileTreeDialog.js",function(e,i,t){var a=e("base:widget/libs/jquerypacket.js"),n=e("base:widget/libs/underscore.js"),o=e("pan-timeline:widget/system/uiService/fileTree/fileTree.js"),s=e("system-core:context/context.js").instanceForSystem,l=function(){this.config={},this.dialog=null,this.zipPath="/"};l.singleton=null,l.obtain=function(){return null===l.singleton&&(l.singleton=new l),l.singleton},l.DIALOG_ID="fileTreeDialog",l.prototype.getFileTree=function(e){var i=this,t={host:this.dialog.$dialog.find(".file-tree-container")[0],path:e||"/"};e&&"/"!==e&&a.extend(!0,t,{selectedCallback:i.selectedCallback}),o.build(t)},l.prototype.setOptions=function(e){if(!e)throw new Error("[fileTreeDialog] must set options for FileTreeDialog");if(!e.title)throw new Error('[fileTreeDialog] title "'+e.title+'" should be set');if(this.config.title=e.title,!n.isFunction(e.confirm))throw new Error("[fileTreeDialog] confirm should be set");this.confirm=e.confirm,e.zipPath&&(this.zipPath=e.zipPath),n.isFunction(e.afterHide)&&(this.afterHide=e.afterHide),this.cancel=e.cancel},l.prototype.buildDialog=function(){var i=this;this.dialog=s.ui.window({id:l.DIALOG_ID,title:this.config.title,body:'<div class="file-tree-container"></div>',draggable:!0,position:{xy:"center"},buttons:[{name:"cancel",title:"取消",type:"big",padding:["50px","50px"],position:"right",click:function(){i.dialog.hide(),"function"==typeof i.cancel&&i.cancel()}},{name:"confirm",title:"确定",type:"big",color:"blue",padding:["50px","50px"],position:"right",click:function(){var e=o.getSelectPath()||{};a(".save-zip-path").length&&a(".save-zip-path").hasClass("check")&&(e=i.getSavePath()),i.confirm(e)}},{title:"新建文件夹",icon:"icon-newfolder",type:"big",position:"left",click:function(){var t=i.dialog.$dialog,a=i.dialog.$dialog.find(".treeview-node-on");e.async("pan-timeline:widget/system/uiService/fileTree/createFolder.js",function(e){e.reBuild({insertDom:a.next(".treeview-content"),container:t.find(".file-tree-container")})})}}],afterHide:function(){"function"==typeof i.afterHide&&i.afterHide()}}),this.bindSavePathEvent()},l.prototype.changeTitle=function(){this.config.title&&this.dialog.title(this.config.title)},l.prototype.show=function(e){var i=(new Date).getTime();this.setOptions(e),this.dialog||this.buildDialog(),this.changeTitle(),this.dialog.show(),e.zipPath?this.showZipPath(e.zipPath):a(".save-zip-path").length&&a(".save-zip-path").remove(),this.getFileTree();var t=(new Date).getTime()-i;return s.log.send({name:"dialogShow-file",value:t}),this},l.prototype.hide=function(){return this.dialog.hide(),this},l.prototype.showZipPath=function(e){var i=this;a(".save-zip-path").length?(a(".save-zip-path").html('<span class="save-chk-io"></span>解压到压缩包所在目录：'+e),a(".save-zip-path").attr("title",e),a(".save-zip-path").removeClass("check")):i.dialog.$dialog.find(".dialog-body").after('<div class="save-zip-path" title="'+e+'"><span class="save-chk-io"></span>解压到压缩包所在目录：'+e+"</div>")},l.prototype.getSavePath=function(){var e=null;return a(".save-zip-path").length&&a(".save-zip-path").hasClass("check")&&(e=this.zipPath),e},l.prototype.bindSavePathEvent=function(){var e=this,i=e.dialog.$dialog;i.on("click",".save-zip-path",function(){var i=a(this).attr("class");i.indexOf("check")>=0?(a(this).removeClass("check"),e.getFileTree("/")):(a(this).addClass("check"),e.getFileTree(e.zipPath))})},l.prototype.selectedCallback=function(){a(".save-zip-path").length&&a(".save-zip-path").hasClass("check")&&a(".save-zip-path").removeClass("check")},t.exports=l.obtain()});
;define("pan-timeline:widget/system/util/contextExtend.js",function(e){var n=e("system-core:context/context.js").instanceForSystem,t=e("pan-timeline:widget/system/fileService/fileManagerApi/fileManagerApi.js"),i=e("pan-timeline:widget/system/fileService/fileOperate/fileOperate.js"),r=n.ui.list,o=n.ui.window,a=n.ui.button;e("pan-timeline:widget/system/errorMsg/errorMsg.js");var u={buttonType:"big",buttonPadding:["50px","50px"],buttonColor:"blue"},s={paddingLeft:10,paddingRight:10,height:34};n.extend({pageInfo:{currentProduct:"pan",currentPage:"timeline"},file:{getIconAndPlugin:function(e,n,t,r){return i.getInfo(e,n,!1,t,r)},isOpenedFile:function(e,n){return i.isOpenedFile(e,n)},getFileInfo:function(e,n,t,r,o){return i.getInfo(e,n,t,r,o)},createAndMoveTo:function(e,n,i,r){t.sendCreateNewFileApi(e,"",1,null,function(){setTimeout(function(){t.sendFileMoveCopyApi(t.COPY+i,n,e,r)},1e3)})}},data:{quota:{get:function(){return[100,1e10]},update:function(e){e(100,1e10)},hasEnoughSpacing:function(){return window.yunData&&window.yunData.QUOTAINFOS?window.yunData.QUOTAINFOS.used<window.yunData.QUOTAINFOS.total:!0}}},ui:{treeDialog:function(t){e.async("pan-timeline:widget/system/uiService/fileTreeDialog/fileTreeDialog.js",function(e){t===!1?e.hide():e.show(t)}),n.message.trigger("addIcon")},list:function(e,n){var t=new r(e,n);return t.extend({resizeScrollBar:function(e){var n=this.$container;if("number"==typeof e||"string"==typeof e?n.height(e):e=n.height(),0===e)throw"[Error] list container's height is 0, need to set";n.height(e);var t=this.listHeader.hasInit===!1?0:52,i=n.find(".module-list-view"),r=n.find(".module-grid-view"),o=i.add(r);"none"===n.find(".module-history-list").css("display")?o.height(e-t).find(".scrollbar-tracker").height(e-t-2):o.height(e-73).find(".scrollbar-tracker").height(e-73)}}),t},window:function(e){var t=new o(e);return n.message.trigger("addIcon"),t},confirm:function(e,t,i,r,a){var s=o.confirm(e,t,i,r,a,u);return n.message.trigger("addIcon"),s},alert:function(e,t){var i=o.alert(e,t,u);return n.message.trigger("addIcon"),i},verify:function(e,t,i,r,a){var s=o.verify(e,t,i,r,a,u);return n.message.trigger("addIcon"),s},button:function(e){return e.buttonDefaultConfig=s,new a(e)}}})});
;!function(){var t=window,e=require("base:thirdParty/vue/axios.js"),n=require("system-core:context/context.js"),r=n.instanceForSystem,o=r.libs.JQuery,i=r.libs.underscore,a=r.tools.baseService,c=a.base64Encode(a.getCookie("BAIDUID"));!function(e){void 0===e&&(e=t.disk={}),e.DEBUG=function(){var e=t.location.host;return t.console?"pan.baidu.com"===e||"lab.pan.baidu.com"===e?!1:!0:!1}(),e.uniqueId=0,e.obtainId=function(){return"_disk_id_"+ ++e.uniqueId},e.common={}}(t.disk),function(){var t=/yunguanjia/gi.test(window.navigator.userAgent);e.interceptors.request.use(function(e){return e.url+=/\?/.test(e.url)?"&channel=chunlei&web=1&app_id=250528":"?channel=chunlei&web=1&app_id=250528",("script"!==e.dataType||e.cache!==!0)&&(e.url+="&bdstoken="+window.yunData.MYBDSTOKEN+"&logid="+c),e.url+="/disk/plugin"===location.pathname&&t?"&clienttype=8&version=4.9.9.9":/msg=132|devuid/.test(location.search)?"&clienttype=8":"&clienttype=0",e},function(t){return Promise.reject(t)}),e.interceptors.response.use(function(t){return 200===t.status&&t.data?t.data:(r.ui.tip({mode:"caution",msg:r.errorMsg(1),autoClose:!0}),Promise.reject(1))},function(t){return Promise.reject(t)}),o(document).ajaxSend(function(e,n,r){r.url+=/\?/.test(r.url)?"&channel=chunlei&web=1&app_id=250528":"?channel=chunlei&web=1&app_id=250528",("script"!==r.dataType||r.cache!==!0)&&(r.url+="&bdstoken="+window.yunData.MYBDSTOKEN+"&logid="+c),r.url+="/disk/plugin"===location.pathname&&t?"&clienttype=8&version=4.9.9.9":/msg=132|devuid/.test(location.search)?"&clienttype=8":"&clienttype=0"})}(),function(t){t.trim||(t.trim=function(){return this.replace(/^\s+|\s+$/g,"")})}(String.prototype),function(t){t.indexOf||(t.indexOf=function(t){return i.indexOf(this,t)},t.forEach||(t.forEach=function(t){return i.each(this,t)}))}(Array.prototype),function(){if(Object.defineProperty)try{Object.defineProperty(window,"navigator",{configurable:!1,writable:!1,value:window.navigator}),Object.defineProperty(window.navigator,"platform",{configurable:!1,writable:!1,value:window.navigator.platform}),Object.defineProperty(window.navigator,"userAgent",{configurable:!1,writable:!1,value:window.navigator.userAgent})}catch(t){r.log.send({name:"defineProperty_navigator_fail",sendServerLog:!0,value:"navigator配置失败"})}}(),window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),function(){for(var t=["Hm_lvt_773fea2ac036979ebb5fcc768d8beb67","Hm_lvt_b181fb73f90936ebd334d457c848c8b5","Hm_lvt_adf736c22cd6bcc36a1d27e5af30949e"],e="."+location.hostname,n=0;n<t.length;n++)a.setCookie(t[n],"",-1,"/",e)}();var s=a.client();if(s&&s.browser&&(s.browser.safari>0||s.browser.ie>0||"edge"===s.browser.ie)){var u=Array.prototype.sort;Array.prototype.sort=function(t){if(t&&"function"==typeof t){if(this.length<2)return this;for(var e,n=this.length,r=!1,o=0,i=0;n>i;i++)for(var a=i+1;n>a;a++)o=t.call(this,this[i],this[a]),r=("number"==typeof o?o:o?1:0)>0,r&&(e=this[i],this[i]=this[a],this[a]=e);return this}return u.call(this)}}Array.prototype.countingSort=function(){for(var t=[],e=[],n=0;n<this.length;n++){var r=+this[n];isNaN(r)&&e.push(this[n]);var o=r%100;t[o]=t[o]||[],t[o].push(r)}for(var i=[],n=t.length-1;n>0;n--)null!=t[n]&&(i=i.concat(t[n]));for(var a=[],n=0;n<i.length;n++){var o=parseInt(i[n]/100,10)%100;a[o]=a[o]||[],a[o].push(i[n])}for(var c=[],n=a.length-1;n>0;n--)null!=a[n]&&(c=c.concat(a[n]));for(var s=[],n=0;n<c.length;n++){var o=parseInt(c[n]/1e4,10);s[o]=s[o]||[],s[o].push(c[n]+"")}for(var u=[],n=s.length-1;n>0;n--)null!=s[n]&&(u=u.concat(s[n]));return u.concat(e)}}();